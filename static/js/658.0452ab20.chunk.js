"use strict";(self.webpackChunkfield_sustainability_helper=self.webpackChunkfield_sustainability_helper||[]).push([[658],{2429:function(e,t,r){r.d(t,{Z:function(){return d}});var n=r(43144),a=r(15671),i=r(60136),o=r(54062),s=r(27366),l=r(43404),u=r(46784),c=r(49861),p=(r(63780),r(93169),r(25243),r(69912)),f=new l.X({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"}),y=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).description=null,n.type=null,n}return(0,n.Z)(r)}(u.wq);(0,s._)([(0,c.Cb)({type:String,json:{write:!0}})],y.prototype,"description",void 0),(0,s._)([(0,c.Cb)({type:String,json:{read:f.read,write:f.write}})],y.prototype,"type",void 0);var d=y=(0,s._)([(0,p.j)("esri.rest.support.GPMessage")],y)},50658:function(e,t,r){r.r(t),r.d(t,{default:function(){return qt}});var n=r(74165),a=r(15861),i=r(1413),o=r(15671),s=r(43144),l=r(60136),u=r(54062),c=r(27366),p=r(43404),f=r(49861),y=(r(63780),r(93169),r(25243)),d=r(69912),b=r(93433),m=r(37762),v=r(42265),h=r(19545),g=r(76200),x=r(10064),w=r(92026),S=r(17842),k=r(35995),Z=r(80885),P=r(80031),D=r(56011),I=r(85015),M=r(53866),G=r(78952),L=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments)).outSpatialReference=null,e.processExtent=null,e.processSpatialReference=null,e.returnFeatureCollection=!1,e.returnM=!1,e.returnZ=!1,e}return(0,s.Z)(r)}(I.Z);(0,c._)([(0,f.Cb)({type:G.Z})],L.prototype,"outSpatialReference",void 0),(0,c._)([(0,f.Cb)({type:M.Z})],L.prototype,"processExtent",void 0),(0,c._)([(0,f.Cb)({type:G.Z})],L.prototype,"processSpatialReference",void 0),(0,c._)([(0,f.Cb)({nonNullable:!0})],L.prototype,"returnFeatureCollection",void 0),(0,c._)([(0,f.Cb)({nonNullable:!0})],L.prototype,"returnM",void 0),(0,c._)([(0,f.Cb)({nonNullable:!0})],L.prototype,"returnZ",void 0),(L=(0,c._)([(0,d.j)("esri.rest.geoprocessor.GPOptions")],L)).from=(0,y.se)(L);var T=L,O=r(50689),V=r(83040),_=r(46784),C=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments)).extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return(0,s.Z)(r)}(_.wq);(0,c._)([(0,f.Cb)({type:M.Z})],C.prototype,"extent",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"height",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"href",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"opacity",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"rotation",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"scale",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"visible",void 0),(0,c._)([(0,f.Cb)()],C.prototype,"width",void 0);var J=C=(0,c._)([(0,d.j)("esri.layer.support.MapImage")],C),j=r(23084),F=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).itemId=null,n.url=null,n}return(0,s.Z)(r)}(_.wq);(0,c._)([(0,f.Cb)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],F.prototype,"itemId",void 0),(0,c._)([(0,f.Cb)({type:String,json:{write:!0}})],F.prototype,"url",void 0);var N=F=(0,c._)([(0,d.j)("esri.rest.support.DataFile")],F),E=r(49818),R=new p.X({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1}),A=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).distance=0,n.units=null,n}return(0,s.Z)(r)}(_.wq);(0,c._)([(0,f.Cb)({json:{write:!0}})],A.prototype,"distance",void 0),(0,c._)([(0,f.Cb)({json:{read:R.read,write:R.write}})],A.prototype,"units",void 0);var U=A=(0,c._)([(0,d.j)("esri.rest.support.LinearUnit")],A),q=new p.X({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"}),z=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).dataType=null,n.value=null,n}return(0,s.Z)(r)}(_.wq);(0,c._)([(0,f.Cb)({json:{read:q.read,write:q.write}})],z.prototype,"dataType",void 0),(0,c._)([(0,f.Cb)()],z.prototype,"value",void 0);var W=z=(0,c._)([(0,d.j)("esri.rest.support.ParameterValue")],z),B=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).format=null,n.itemId=null,n.url=null,n}return(0,s.Z)(r)}(_.wq);(0,c._)([(0,f.Cb)()],B.prototype,"format",void 0),(0,c._)([(0,f.Cb)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],B.prototype,"itemId",void 0),(0,c._)([(0,f.Cb)()],B.prototype,"url",void 0);var K=B=(0,c._)([(0,d.j)("esri.rest.support.RasterData")],B);function X(e,t,r,n,a){return Q.apply(this,arguments)}function Q(){return Q=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,o,s){var l,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={},u={},c=[],e.abrupt("return",(H(o,c,l),(0,O.aX)(c).then((function(e){var n=a.outSpatialReference,c=a.processExtent,p=a.processSpatialReference,f=a.returnFeatureCollection,y=a.returnM,d=a.returnZ,b=(0,j.en)(t).path;for(var m in l){var v=l[m];u[m]=e.slice(v[0],v[1])}var h=n?n.wkid||n:null,x=p?p.wkid||p:null,w="execute"===r?{returnFeatureCollection:f||void 0,returnM:y||void 0,returnZ:d||void 0}:null,S=$((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},c?{context:{extent:c,outSR:h,processSR:x}}:{"env:outSR":h,"env:processSR":x}),o),w),{},{f:"json"}),null,u),k=(0,i.Z)((0,i.Z)({},s),{},{query:S});return(0,g.default)("".concat(b,"/").concat(r),k)}))));case 2:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function H(e,t,r){for(var n in e){var a=e[n];if(a&&"object"==typeof a&&a instanceof E.default){var i=a.features;r[n]=[t.length,t.length+i.length],i.forEach((function(e){t.push(e.geometry)}))}}}function Y(e){var t=e.dataType,r=W.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return r;case"GPDate":r.value=new Date(r.value);break;case"GPDataFile":r.value=N.fromJSON(r.value);break;case"GPLinearUnit":r.value=U.fromJSON(r.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":var n=e.value.url;r.value=n?N.fromJSON(r.value):E.default.fromJSON(r.value);break;case"GPRasterData":case"GPRasterDataLayer":var a=e.value.mapImage;r.value=a?J.fromJSON(a):K.fromJSON(r.value);break;case"GPField":r.value=V.Z.fromJSON(r.value);break;case"GPMultiValue:GPDate":var i=r.value;r.value=i.map((function(e){return new Date(e)}));break;case"GPMultiValue:GPDataFile":r.value=r.value.map((function(e){return N.fromJSON(e)}));break;case"GPMultiValue:GPLinearUnit":r.value=r.value.map((function(e){return U.fromJSON(e)}));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":r.value=r.value.map((function(e){return E.default.fromJSON(e)}));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":r.value=r.value.map((function(e){return e?J.fromJSON(e):K.fromJSON(r.value)}));break;case"GPMultiValue:GPField":r.value=r.value.map((function(e){return V.Z.fromJSON(e)}))}return r}function $(e,t,r){for(var n in e){var a=e[n];Array.isArray(a)?e[n]=JSON.stringify(a.map((function(e){return $({item:e},!0).item}))):a instanceof Date&&(e[n]=a.getTime())}return(0,j.cv)(e,t,r)}var ee=r(2429);function te(e,t,r,n){return re.apply(this,arguments)}function re(){return re=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(a=T.from(a||{}),X(t,"execute",a,r,i).then((function(e){var t=e.data.results||[],r=e.data.messages||[];return{results:t.map(Y),messages:r.map((function(e){return ee.Z.fromJSON(e)}))}}))));case 1:case"end":return e.stop()}}),e)}))),re.apply(this,arguments)}var ne,ae=r(66978),ie=new p.X({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"}),oe=ne=function(e){(0,l.Z)(c,e);var t=(0,u.Z)(c);function c(e){var r;return(0,o.Z)(this,c),(r=t.call(this,e)).jobId=null,r.jobStatus=null,r.messages=null,r.requestOptions=null,r.sourceUrl=null,r._timer=null,r}return(0,s.Z)(c,[{key:"cancelJob",value:function(e){var t=this,r=this.jobId,n=this.sourceUrl,a=(0,j.en)(n).path,o=(0,i.Z)((0,i.Z)((0,i.Z)({},this.requestOptions),e),{},{query:{f:"json"}});return this._clearTimer(),(0,g.default)("".concat(a,"/jobs/").concat(r,"/cancel"),o).then((function(e){var r=ne.fromJSON(e.data);return t.messages=r.messages,t.jobStatus=r.jobStatus,t}))}},{key:"destroy",value:function(){clearInterval(this._timer)}},{key:"checkJobStatus",value:function(e){var t=this,r=(0,j.en)(this.sourceUrl).path,n=(0,i.Z)((0,i.Z)((0,i.Z)({},this.requestOptions),e),{},{query:{f:"json"}}),a="".concat(r,"/jobs/").concat(this.jobId);return(0,g.default)(a,n).then((function(e){var r=e.data,n=ne.fromJSON(r);return t.messages=n.messages,t.jobStatus=n.jobStatus,t}))}},{key:"fetchResultData",value:function(e,t,r){var n=t=T.from(t||{}),a=n.returnFeatureCollection,o=n.returnM,s=n.returnZ,l=n.outSpatialReference,u=(0,j.en)(this.sourceUrl).path,c=$({returnFeatureCollection:a,returnM:o,returnZ:s,outSR:l,returnType:"data",f:"json"},null),p=(0,i.Z)((0,i.Z)((0,i.Z)({},this.requestOptions),r),{},{query:c}),f="".concat(u,"/jobs/").concat(this.jobId,"/results/").concat(e);return(0,g.default)(f,p).then((function(e){return Y(e.data)}))}},{key:"fetchResultImage",value:function(e,t,r){var n=(0,j.en)(this.sourceUrl).path,a=$((0,i.Z)((0,i.Z)({},t.toJSON()),{},{f:"json"})),o=(0,i.Z)((0,i.Z)((0,i.Z)({},this.requestOptions),r),{},{query:a}),s="".concat(n,"/jobs/").concat(this.jobId,"/results/").concat(e);return(0,g.default)(s,o).then((function(e){return Y(e.data)}))}},{key:"fetchResultMapImageLayer",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,a,i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,j.en)(this.sourceUrl),a=t.path,i=a.indexOf("/GPServer/"),o="".concat(a.substring(0,i),"/MapServer/jobs/").concat(this.jobId),e.next=4,Promise.all([r.e(9668),r.e(9764)]).then(r.bind(r,19583));case 4:return e.t0=e.sent.default,e.t1={url:o},e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"waitForJobCompletion",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i,o,s=this,l=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=t.interval,a=void 0===r?1e3:r,i=t.signal,o=t.statusCallback,e.abrupt("return",new Promise((function(e,t){(0,ae.fu)(i,(function(){s._clearTimer(),t((0,ae.zE)())})),s._clearTimer();var r=setInterval((function(){s._timer||t((0,ae.zE)()),s.checkJobStatus(s.requestOptions).then((function(r){var n=r.jobStatus;switch(s.jobStatus=n,n){case"job-succeeded":s._clearTimer(),e(s);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":o&&o(s);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":s._clearTimer(),t(s)}}))}),a);s._timer=r})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}}]),c}(_.wq);(0,c._)([(0,f.Cb)()],oe.prototype,"jobId",void 0),(0,c._)([(0,f.Cb)({json:{read:ie.read}})],oe.prototype,"jobStatus",void 0),(0,c._)([(0,f.Cb)({type:[ee.Z]})],oe.prototype,"messages",void 0),(0,c._)([(0,f.Cb)()],oe.prototype,"requestOptions",void 0),(0,c._)([(0,f.Cb)({json:{write:!0}})],oe.prototype,"sourceUrl",void 0);var se=oe=ne=(0,c._)([(0,d.j)("esri.rest.support.JobInfo")],oe);function le(e,t,r,n){return ue.apply(this,arguments)}function ue(){return ue=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(a=T.from(a||{}),X(t,"submitJob",a,r,i).then((function(e){var r=se.fromJSON(e.data);return r.sourceUrl=t,r}))));case 1:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}var ce=new p.X({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),pe=(ce.fromJSON.bind(ce),ce.toJSON.bind(ce)),fe=new p.X({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),ye=(fe.fromJSON.bind(fe),fe.toJSON.bind(fe)),de="simple-marker",be="simple-line";function me(e,t){var r=t.graphic,n=t.renderer,a=t.symbol,i=a.type;if("text"!==i&&"shield-label-symbol"!==i&&"visualVariables"in n&&n.visualVariables){var o=n.getVisualVariablesForType("size"),s=n.getVisualVariablesForType("color"),l=n.getVisualVariablesForType("opacity"),u=n.getVisualVariablesForType("rotation"),c=o[0],p=s[0],f=l[0],y=u[0];if(c){var d=i===de?a.style:null,b=(0,D.getSize)(c,r,{shape:d});null!=b&&(i===de?e.size=(0,S.Wz)(b):"picture-marker"===i?(e.width=(0,S.Wz)(b),e.height=(0,S.Wz)(b)):i===be?e.width=(0,S.Wz)(b):e.outline&&(e.outline.width=(0,S.Wz)(b)))}if(p){var m=(0,D.getColor)(p,r);(m&&i===de||i===be||"simple-fill"===i)&&(e.color=m?m.toJSON():void 0)}if(f){var v=(0,D.getOpacity)(f,r);null!=v&&e.color&&(e.color[3]=Math.round(255*v))}y&&(e.angle=-(0,D.getRotationAngle)(n,r))}}function ve(e){var t,r,n,a,i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,l=e.canvas.width,u=e.canvas.height,c=e.getImageData(0,0,l,u).data;e:for(r=u;r--;)for(t=l;t--;)if(c[4*(l*r+t)+3]>s){o=r;break e}if(!o)return null;e:for(t=l;t--;)for(r=o+1;r--;)if(c[4*(l*r+t)+3]>s){i=t;break e}e:for(t=0;t<=i;++t)for(r=o+1;r--;)if(c[4*(l*r+t)+3]>s){n=t;break e}e:for(r=0;r<=o;++r)for(t=n;t<=i;++t)if(c[4*(l*r+t)+3]>s){a=r;break e}return{x:n,y:a,width:i-n,height:o-a}}function he(e,t){var r=e.allLayerViews.items;if(t===e.scale)return r.filter((function(e){return!e.suspended}));var n,a=new Array,i=(0,m.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;De(o.parent)&&!a.includes(o.parent)||!o.visible||t&&"isVisibleAtScale"in o&&!o.isVisibleAtScale(t)||a.push(o)}}catch(s){i.e(s)}finally{i.f()}return a}function ge(e){return e&&"bing-maps"===e.type}function xe(e){return e&&"blendMode"in e&&"effect"in e}function we(e){return e&&"csv"===e.type}function Se(e){return e&&"feature"===e.type}function ke(e){return e&&"geojson"===e.type}function Ze(e){return e&&"graphics"===e.type}function Pe(e){return e&&"group"===e.type}function De(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function Ie(e){return e&&"imagery"===e.type}function Me(e){return e&&"imagery-tile"===e.type}function Ge(e){return e&&"kml"===e.type}function Le(e){return e&&"map-image"===e.type}function Te(e){return e&&"map-notes"===e.type}function Oe(e){return e&&"open-street-map"===e.type}function Ve(e){var t=e.layer;if(xe(t)){var r=t.blendMode;if((!r||"normal"===r)&&(t.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}function _e(e){return e&&"stream"===e.type}function Ce(e){return e&&"tile"===e.type}function Je(e){return e&&"vector-tile"===e.type}function je(e){return e&&"web-tile"===e.type}function Fe(e){return e&&"wms"===e.type}function Ne(e){return e&&"wmts"===e.type}var Ee=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).attributionVisible=!0,n.exportOptions={width:800,height:1100,dpi:96},n.forceFeatureAttributes=!1,n.format="png32",n.label=null,n.layout="map-only",n.layoutOptions=null,n.outScale=0,n.scalePreserved=!0,n.showLabels=!0,n}return(0,s.Z)(r)}(I.Z);(0,c._)([(0,f.Cb)()],Ee.prototype,"attributionVisible",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"exportOptions",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"forceFeatureAttributes",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"format",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"label",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"layout",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"layoutOptions",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"outScale",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"scalePreserved",void 0),(0,c._)([(0,f.Cb)()],Ee.prototype,"showLabels",void 0);var Re=Ee=(0,c._)([(0,d.j)("esri.rest.support.PrintTemplate")],Ee),Ae=r(66660),Ue=r(10141),qe={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},ze=new p.X({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),We=new p.X({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),Be=new Map;function Ke(){return Ke=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$e(t),o=Be.get(i),e.abrupt("return",Promise.resolve().then((function(){return o?{data:o.gpMetadata}:(o={gpServerUrl:i,is11xService:!1,legendLayerNameMap:{},legendLayers:[]},(0,g.default)(i,{query:{f:"json"}}))})).then((function(e){return o.gpMetadata=e.data,o.cimVersion=o.gpMetadata.cimVersion,o.is11xService=!!o.cimVersion,Be.set(i,o),Xe(r,o)})).then((function(e){var n,i=Nt(o),s=function(e){return"sync"===i?e.results&&e.results[0]&&e.results[0].value:n.fetchResultData("Output_File",null,a).then((function(e){return e.value}))};return"async"===i?le(t,e,null,a).then((function(e){return n=e,e.waitForJobCompletion({interval:r.updateDelay}).then(s)})):te(t,e,null,a).then(s)})));case 3:case"end":return e.stop()}}),e)}))),Ke.apply(this,arguments)}function Xe(e,t){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s,l,u,c,p,f,y,d,b,m,v,h,g,w;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]},null==(a=t.template||new Re).showLabels&&(a.showLabels=!0),i=a.exportOptions,s=ye(a.layout),i&&(o={dpi:i.dpi},("map_only"===s.toLowerCase()||""===s)&&(l=i.width,u=i.height,o.outputSize=[l,u])),(c=a.layoutOptions)&&("Miles"===c.scalebarUnit||"Kilometers"===c.scalebarUnit?(f="Kilometers",y="Miles"):"Meters"!==c.scalebarUnit&&"Feet"!==c.scalebarUnit||(f="Meters",y="Feet"),p={titleText:c.titleText,authorText:c.authorText,copyrightText:c.copyrightText,customTextElements:c.customTextElements,scaleBarOptions:{metricUnit:ze.toJSON(f),metricLabel:qe[f],nonMetricUnit:ze.toJSON(y),nonMetricLabel:qe[y]}}),d=null,null!=c&&c.legendLayers&&(d=c.legendLayers.map((function(e){r.legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}))),e.next=12,He(t,a,r);case 12:return(b=e.sent).operationalLayers&&(m=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),v=/[\u0600-\u06FF]/,h=function(e){var t=e.text,r=e.font,n=r&&r.family&&r.family.toLowerCase();t&&r&&("arial"===n||"arial unicode ms"===n)&&(r.family=m.test(t)?"Arial Unicode MS":"Arial","normal"!==r.style&&v.test(t)&&(r.family="Arial Unicode MS"))},g=function(){throw new x.Z("print:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")},b.operationalLayers.forEach((function(e){var t,n,a;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((function(e){var t,n,a,i;if(null!=(t=e.layerDefinition)&&null!=(n=t.drawingInfo)&&null!=(a=n.renderer)&&a.symbol){var o=e.layerDefinition.drawingInfo.renderer;"esriTS"===o.symbol.type?h(o.symbol):"CIMSymbolReference"!==o.symbol.type||r.is11xService||g()}null!=(i=e.featureSet)&&i.features&&e.featureSet.features.forEach((function(e){e.symbol&&("esriTS"===e.symbol.type?h(e.symbol):"CIMSymbolReference"!==e.symbol.type||r.is11xService||g())}))})):!r.is11xService&&null!=(n=e.layerDefinition)&&null!=(a=n.drawingInfo)&&a.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&g()}))),t.outSpatialReference&&(b.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(b,{exportOptions:o,layoutOptions:p||{}}),Object.assign(b.layoutOptions,{legendOptions:{operationalLayers:null!=d?d:r.legendLayers.slice()}}),r.legendLayers.length=0,Be.set(r.gpServerUrl,r),w={Web_Map_as_JSON:JSON.stringify(b),Format:pe(a.format),Layout_Template:s},e.abrupt("return",(t.extraParameters&&Object.assign(w,t.extraParameters),w));case 17:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}function He(e,t,r){return Ye.apply(this,arguments)}function Ye(){return Ye=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s,l,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.view,o=i.spatialReference,e.next=4,et(i,r,a);case 4:return e.t0=e.sent,s={operationalLayers:e.t0},l=a.ssExtent||t.extent||i.extent,o&&o.isWrappable&&(l=l.clone()._normalize(!0),o=l.spatialReference),s.mapOptions={extent:l&&l.toJSON(),spatialReference:o&&o.toJSON(),showAttribution:r.attributionVisible},a.ssExtent=null,i.background&&(s.background=i.background.toJSON()),i.rotation&&(s.mapOptions.rotation=-i.rotation),r.scalePreserved&&(s.mapOptions.scale=r.outScale||i.scale),(0,w.pC)(i.timeExtent)&&(u=(0,w.pC)(i.timeExtent.start)?i.timeExtent.start.getTime():null,c=(0,w.pC)(i.timeExtent.end)?i.timeExtent.end.getTime():null,s.mapOptions.time=[u,c]),e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)}))),Ye.apply(this,arguments)}function $e(e){var t=e,r=t.lastIndexOf("/GPServer/");return r>0&&(t=t.slice(0,r+9)),t}function et(e,t,r){return tt.apply(this,arguments)}function tt(){return tt=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s,l,u,c,p,f,y,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],o={layerView:null,printTemplate:r,view:t},s=0,r.scalePreserved&&(s=r.outScale||t.scale),l=he(t,s),u=(0,m.Z)(l),e.prev=5,u.s();case 7:if((c=u.n()).done){e.next=130;break}if(p=c.value,(f=p.layer).loaded&&!Pe(f)){e.next=12;break}return e.abrupt("continue",128);case 12:if(y=void 0,o.layerView=p,!Ve(p)){e.next=20;break}return e.next=17,wt(f,o,a);case 17:e.t0=e.sent,e.next=126;break;case 20:if(!ge(f)){e.next=24;break}e.t1=rt(f),e.next=125;break;case 24:if(!we(f)){e.next=30;break}return e.next=27,nt(f,o,a);case 27:e.t2=e.sent,e.next=124;break;case 30:if(!Se(f)){e.next=36;break}return e.next=33,st(f,o,a);case 33:e.t3=e.sent,e.next=123;break;case 36:if(!ke(f)){e.next=42;break}return e.next=39,ut(f,o,a);case 39:e.t4=e.sent,e.next=122;break;case 42:if(!Ze(f)){e.next=48;break}return e.next=45,pt(f,o,a);case 45:e.t5=e.sent,e.next=121;break;case 48:if(!Ie(f)){e.next=52;break}e.t6=yt(f,a),e.next=120;break;case 52:if(!Me(f)){e.next=58;break}return e.next=55,dt(f,o,a);case 55:e.t7=e.sent,e.next=119;break;case 58:if(!Ge(f)){e.next=64;break}return e.next=61,mt(f,o,a);case 61:e.t8=e.sent,e.next=118;break;case 64:if(!Le(f)){e.next=68;break}e.t9=ht(f,o,a),e.next=117;break;case 68:if(!Te(f)){e.next=74;break}return e.next=71,gt(o,a);case 71:e.t10=e.sent,e.next=116;break;case 74:if(!Oe(f)){e.next=78;break}e.t11={type:"OpenStreetMap"},e.next=115;break;case 78:if(!_e(f)){e.next=84;break}return e.next=81,kt(f,o,a);case 81:e.t12=e.sent,e.next=114;break;case 84:if(!Ce(f)){e.next=88;break}e.t13=Pt(f,a),e.next=113;break;case 88:if(!Je(f)){e.next=94;break}return e.next=91,Dt(f,o,a);case 91:e.t14=e.sent,e.next=112;break;case 94:if(!je(f)){e.next=98;break}e.t15=Mt(f),e.next=111;break;case 98:if(!Fe(f)){e.next=102;break}e.t16=Gt(f),e.next=110;break;case 102:if(!Ne(f)){e.next=106;break}e.t17=Lt(f),e.next=109;break;case 106:return e.next=108,wt(f,o,a);case 108:e.t17=e.sent;case 109:e.t16=e.t17;case 110:e.t15=e.t16;case 111:e.t14=e.t15;case 112:e.t13=e.t14;case 113:e.t12=e.t13;case 114:e.t11=e.t12;case 115:e.t10=e.t11;case 116:e.t9=e.t10;case 117:e.t8=e.t9;case 118:e.t7=e.t8;case 119:e.t6=e.t7;case 120:e.t5=e.t6;case 121:e.t4=e.t5;case 122:e.t3=e.t4;case 123:e.t2=e.t3;case 124:e.t1=e.t2;case 125:e.t0=e.t1;case 126:(y=e.t0)&&(Array.isArray(y)?i.push.apply(i,(0,b.Z)(y)):(y.id=f.id,y.title=a.legendLayerNameMap[f.id]||f.title,y.opacity=f.opacity,y.minScale=f.minScale||0,y.maxScale=f.maxScale||0,xe(f)&&f.blendMode&&"normal"!==f.blendMode&&(y.blendMode=f.blendMode),i.push(y)));case 128:e.next=7;break;case 130:e.next=135;break;case 132:e.prev=132,e.t18=e.catch(5),u.e(e.t18);case 135:return e.prev=135,u.f(),e.finish(135);case 138:if(s&&i.forEach((function(e){e.minScale=0,e.maxScale=0})),!t.graphics||!t.graphics.length){e.next=143;break}return e.next=141,it(null,t.graphics,r,a);case 141:(d=e.sent)&&i.push(d);case 143:return e.abrupt("return",i);case 144:case"end":return e.stop()}}),e,null,[[5,132,135,138]])}))),tt.apply(this,arguments)}function rt(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}function nt(e,t,r){return at.apply(this,arguments)}function at(){return at=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.legendEnabled&&a.legendLayers.push({id:t.id}),i=r.layerView,o=r.printTemplate,a.is11xService&&!i.filter){e.next=11;break}return e.t0=it,e.t1=t,e.next=7,jt(i);case 7:return e.t2=e.sent,e.t3=o,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 11:return e.abrupt("return",(s={type:"CSV"},t.write(s,{origin:"web-map"}),delete s.popupInfo,delete s.layerType,s.showLabels=o.showLabels&&t.labelsVisible,s));case 12:case"end":return e.stop()}}),e)}))),at.apply(this,arguments)}function it(e,t,r,n){return ot.apply(this,arguments)}function ot(){return ot=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i){var o,s,l,u,c,p,f,y,d,b,v,h,g,x,w,S,k,D,I,M,G,L,T,O,V,_,C,J;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},l={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},u={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},c={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},(p={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}).layerDefinition.name="textLayer",delete p.layerDefinition.drawingInfo,t&&("esri.layers.FeatureLayer"===t.declaredClass||"esri.layers.StreamLayer"===t.declaredClass?s.layerDefinition.name=l.layerDefinition.name=u.layerDefinition.name=c.layerDefinition.name=i.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:"esri.layers.GraphicsLayer"===t.declaredClass&&(r=t.graphics.items),t.renderer&&(f=t.renderer.toJSON(),s.layerDefinition.drawingInfo.renderer=f,l.layerDefinition.drawingInfo.renderer=f,u.layerDefinition.drawingInfo.renderer=f,c.layerDefinition.drawingInfo.renderer=f),a.showLabels&&t.labelsVisible&&"function"==typeof t.write&&(b=null==(y=t.write({},{origin:"web-map"}).layerDefinition)||null==(d=y.drawingInfo)?void 0:d.labelingInfo)&&(o=!0,s.layerDefinition.drawingInfo.labelingInfo=b,l.layerDefinition.drawingInfo.labelingInfo=b,u.layerDefinition.drawingInfo.labelingInfo=b,c.layerDefinition.drawingInfo.labelingInfo=b)),null!=t&&t.renderer||o||(delete s.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete c.layerDefinition.drawingInfo),h=null==t?void 0:t.fieldsIndex,g=null==t?void 0:t.renderer,!h){e.next=17;break}if(x=new Set,e.t0=o,!e.t0){e.next=10;break}return e.next=10,(0,P.Mu)(x,t);case 10:if(e.t1=g&&"function"==typeof g.collectRequiredFields,!e.t1){e.next=14;break}return e.next=14,g.collectRequiredFields(x,h);case 14:v=Array.from(x),w=h.fields.map((function(e){return e.toJSON()})),s.layerDefinition.fields=w,l.layerDefinition.fields=w,u.layerDefinition.fields=w,c.layerDefinition.fields=w;case 17:S=r&&r.length,D=0;case 19:if(!(D<S)){e.next=51;break}if(!1!==(M=r[D]||r.getItemAt(D)).visible&&M.geometry){e.next=23;break}return e.abrupt("continue",48);case 23:if((k=M.toJSON()).hasOwnProperty("popupTemplate")&&delete k.popupTemplate,k.geometry&&k.geometry.z&&delete k.geometry.z,!k.symbol||!k.symbol.outline||"esriCLS"!==k.symbol.outline.type||i.is11xService){e.next=25;break}return e.abrupt("continue",48);case 25:if(!i.is11xService&&k.symbol&&k.symbol.outline&&k.symbol.outline.color&&k.symbol.outline.color[3]&&(k.symbol.outline.color[3]=255),G=t&&t.renderer&&("valueExpression"in t.renderer&&t.renderer.valueExpression||"hasVisualVariables"in t.renderer&&t.renderer.hasVisualVariables()),k.symbol||!t||!t.renderer||!G||i.is11xService){e.next=35;break}return L=t.renderer,e.next=31,L.getSymbolAsync(M);case 31:if(T=e.sent){e.next=34;break}return e.abrupt("continue",48);case 34:k.symbol=T.toJSON(),"hasVisualVariables"in L&&L.hasVisualVariables()&&me(k.symbol,{renderer:L,graphic:M,symbol:T});case 35:if(e.t2=k.symbol,!e.t2){e.next=45;break}if(k.symbol.angle||delete k.symbol.angle,!Et(k.symbol)){e.next=44;break}return e.next=41,Vt(k.symbol,i);case 41:k.symbol=e.sent,e.next=45;break;case 44:k.symbol.text&&delete k.attributes;case 45:if(a&&a.forceFeatureAttributes||null==(I=v)||!I.length){e.next=47;break}!function(){var e={};v.forEach((function(t){k.attributes&&k.attributes.hasOwnProperty(t)&&(e[t]=k.attributes[t])})),k.attributes=e}();case 47:"polygon"===M.geometry.type?s.featureSet.features.push(k):"polyline"===M.geometry.type?l.featureSet.features.push(k):"point"===M.geometry.type?k.symbol&&k.symbol.text?p.featureSet.features.push(k):u.featureSet.features.push(k):"multipoint"===M.geometry.type?c.featureSet.features.push(k):"extent"===M.geometry.type&&(k.geometry=Z.Z.fromExtent(M.geometry).toJSON(),s.featureSet.features.push(k));case 48:D++,e.next=19;break;case 51:O=[s,l,c,u,p].filter((function(e){return e.featureSet.features.length>0})),V=(0,m.Z)(O),e.prev=53,V.s();case 55:if((_=V.n()).done){e.next=66;break}if(C=_.value,J=C.featureSet.features.every((function(e){return e.symbol})),!J||a&&a.forceFeatureAttributes||C.featureSet.features.forEach((function(e){delete e.attributes})),J&&delete C.layerDefinition.drawingInfo,e.t3=C.layerDefinition.drawingInfo&&C.layerDefinition.drawingInfo.renderer,!e.t3){e.next=64;break}return e.next=64,Ct(C.layerDefinition.drawingInfo.renderer,i);case 64:e.next=55;break;case 66:e.next=71;break;case 68:e.prev=68,e.t4=e.catch(53),V.e(e.t4);case 71:return e.prev=71,V.f(),e.finish(71);case 74:return e.abrupt("return",O.length?{featureCollection:{layers:O},showLabels:o}:null);case 75:case"end":return e.stop()}}),e,null,[[53,68,71,74]])}))),ot.apply(this,arguments)}function st(e,t,r){return lt.apply(this,arguments)}function lt(){return lt=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s,l,u,c,p,f,y,d,b,m,v,h,g,x,w;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t.renderer,u=parseFloat(a.cimVersion),!(t.featureReduction&&(!a.is11xService||u<2.9)||"dot-density"===(null==l?void 0:l.type)&&(!a.is11xService||u<2.6))){e.next=3;break}return e.abrupt("return",wt(t,r,a));case 3:if(t.legendEnabled&&a.legendLayers.push({id:t.id}),c=r.layerView,p=r.printTemplate,f=r.view,y=l&&("valueExpression"in l&&l.valueExpression||"hasVisualVariables"in l&&l.hasVisualVariables()),d="feature-layer"!==(null==(i=t.source)?void 0:i.type)&&"ogc-feature"!==(null==(o=t.source)?void 0:o.type),!(!a.is11xService&&y||c.filter||d)&&l&&(!("field"in l)||null==l.field||"string"==typeof l.field&&t.getField(l.field))){e.next=14;break}return e.next=8,jt(c);case 8:return b=e.sent,e.next=11,it(t,b,p,a);case 11:s=e.sent,e.next=29;break;case 14:if((s={id:(w=t.write()).id,title:w.title,opacity:w.opacity,minScale:w.minScale,maxScale:w.maxScale,url:w.url,layerType:w.layerType,customParameters:w.customParameters,layerDefinition:w.layerDefinition}).showLabels=p.showLabels&&t.labelsVisible,Tt(s,t),e.t0=null!=(m=s.layerDefinition)&&null!=(v=m.drawingInfo)&&v.renderer,!e.t0){e.next=24;break}return delete s.layerDefinition.minScale,delete s.layerDefinition.maxScale,e.next=23,Ct(s.layerDefinition.drawingInfo.renderer,a);case 23:e.t0="visualVariables"in l&&l.visualVariables&&l.visualVariables[0];case 24:if(!e.t0){e.next=27;break}"size"===(h=l.visualVariables[0]).type&&h.maxSize&&"number"!=typeof h.maxSize&&h.minSize&&"number"!=typeof h.minSize&&(g=(0,D.getSizeRangeAtScale)(h,f.scale),s.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=g.minSize,s.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=g.maxSize);case 27:(x=(0,Ue.cx)(c))&&(s.layerDefinition||(s.layerDefinition={}),s.layerDefinition.definitionExpression=s.layerDefinition.definitionExpression?"(".concat(s.layerDefinition.definitionExpression,") AND (").concat(x,")"):x);case 29:return e.abrupt("return",s);case 30:case"end":return e.stop()}}),e)}))),lt.apply(this,arguments)}function ut(e,t,r){return ct.apply(this,arguments)}function ct(){return ct=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.layerView,o=r.printTemplate,t.legendEnabled&&a.legendLayers.push({id:t.id}),e.t0=it,e.t1=t,e.next=6,jt(i);case 6:return e.t2=e.sent,e.t3=o,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)}))),ct.apply(this,arguments)}function pt(e,t,r){return ft.apply(this,arguments)}function ft(){return ft=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.printTemplate,e.abrupt("return",it(t,null,i,a));case 2:case"end":return e.stop()}}),e)}))),ft.apply(this,arguments)}function yt(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});var r,n={layerType:(r=e.write()).layerType,customParameters:r.customParameters};if(n.bandIds=e.bandIds,n.compressionQuality=e.compressionQuality,n.format=e.format,n.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(n.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(n.renderingRule=e.renderingRule.toJSON()),e.renderer&&(n.layerDefinition=n.layerDefinition||{},n.layerDefinition.drawingInfo=n.layerDefinition.drawingInfo||{},n.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var a=e.exportImageServiceParameters.combineRendererWithRenderingRule();a&&(n.renderingRule=a.toJSON())}return Tt(n,e),n}function dt(e,t,r){return bt.apply(this,arguments)}function bt(){return bt=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("flow"!==(null==(i=t.renderer)?void 0:i.type)){e.next=2;break}return e.abrupt("return",wt(t,r,a));case 2:return t.legendEnabled&&a.legendLayers.push({id:t.id}),o={bandIds:(s=t.write()||{}).bandIds,customParameters:s.customParameters,interpolation:s.interpolation,layerDefinition:s.layerDefinition},e.abrupt("return",(o.layerType="ArcGISImageServiceLayer",Tt(o,t),o));case 5:case"end":return e.stop()}}),e)}))),bt.apply(this,arguments)}function mt(e,t,r){return vt.apply(this,arguments)}function vt(){return vt=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var o,s,l,u,c,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.printTemplate,!a.is11xService){e.next=4;break}return s={type:"kml"},e.abrupt("return",(t.write(s,{origin:"web-map"}),delete s.layerType,s.url=(0,k.Fv)(t.url),s));case 4:return l=[],(u=r.layerView).allVisibleMapImages.forEach((function(e,r){var n={id:"".concat(t.id,"_image").concat(r),type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:t.opacity,extent:e.extent};"data:image/png;base64,"===e.href.substr(0,22)?n.imageData=e.href.substr(22):n.url=e.href,l.push(n)})),c=[].concat((0,b.Z)(u.allVisiblePoints.items),(0,b.Z)(u.allVisiblePolylines.items),(0,b.Z)(u.allVisiblePolygons.items)),e.t0=i.Z,e.t1={id:t.id},e.next=11,it(null,c,o,a);case 11:return e.t2=e.sent,p=(0,e.t0)(e.t1,e.t2),e.abrupt("return",(l.push(p),l));case 14:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}function ht(e,t,r){var n,a,i=t.view,o={id:e.id,subLayerIds:[]},s=[],l=i.scale;return e.sublayers&&e.sublayers.forEach((function e(t){var r=0===l,n=0===t.minScale||l<=t.minScale,a=0===t.maxScale||l>=t.maxScale;if(t.visible&&(r||n&&a))if(t.sublayers)t.sublayers.forEach(e);else{var i=t.toExportImageJSON(),u={id:t.id,name:t.title,layerDefinition:{drawingInfo:i.drawingInfo,definitionExpression:i.definitionExpression,source:i.source}};s.unshift(u),o.subLayerIds.push(t.id)}})),s.length&&(s=s.map((function(e){return{id:e.id,name:e.name,layerDefinition:e.layerDefinition}})),(n={layerType:(a=e.write()).layerType,customParameters:a.customParameters}).layers=s,n.visibleLayers=e.capabilities.exportMap.supportsDynamicLayers?void 0:o.subLayerIds,Tt(n,e),e.legendEnabled&&r.legendLayers.push(o)),n}function gt(e,t){return xt.apply(this,arguments)}function xt(){return xt=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s,l,u,c,p,f,y,d,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layerView,i=t.printTemplate,o=[],s=a.layer,!(0,w.pC)(s.featureCollections)){e.next=24;break}l=(0,m.Z)(s.featureCollections),e.prev=4,l.s();case 6:if((u=l.n()).done){e.next=14;break}return c=u.value,e.next=10,it(c,c.source,i,r);case 10:(p=e.sent)&&o.push.apply(o,(0,b.Z)(p.featureCollection.layers));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),l.e(e.t0);case 19:return e.prev=19,l.f(),e.finish(19);case 22:e.next=44;break;case 24:if(!(0,w.pC)(s.sublayers)){e.next=44;break}f=(0,m.Z)(s.sublayers),e.prev=26,f.s();case 28:if((y=f.n()).done){e.next=36;break}return d=y.value,e.next=32,it(null,d.graphics,i,r);case 32:(v=e.sent)&&o.push.apply(o,(0,b.Z)(v.featureCollection.layers));case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(26),f.e(e.t1);case 41:return e.prev=41,f.f(),e.finish(41);case 44:return e.abrupt("return",{featureCollection:{layers:o}});case 45:case"end":return e.stop()}}),e,null,[[4,16,19,22],[26,38,41,44]])}))),xt.apply(this,arguments)}function wt(e,t,r){return St.apply(this,arguments)}function St(){return St=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s,l,u,c,p,f,y,d,b,m,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.printTemplate,o=r.view,s={type:"image"},l={format:"png",ignoreBackground:!0,layers:[t],rotation:0},u=a.ssExtent||o.extent.clone(),c=96,p=!0,f=!0,i.exportOptions&&((y=i.exportOptions).dpi>0&&(c=y.dpi),y.width>0&&(p=y.width%2==o.width%2),y.height>0&&(f=y.height%2==o.height%2)),"map-only"!==i.layout||!i.scalePreserved||i.outScale&&i.outScale!==o.scale||96!==c||p&&f||(l.area={x:0,y:0,width:o.width,height:o.height},p||(l.area.width-=1),f||(l.area.height-=1),a.ssExtent)||(d=o.toMap((0,S.vW)(l.area.width,l.area.height)),u.ymin=d.y,u.xmax=d.x,a.ssExtent=u),s.extent=u.clone()._normalize(!0).toJSON(),e.next=8,o.takeScreenshot(l);case 8:return b=e.sent,m=(0,k.sJ)(b.dataUrl),v=m.data,e.abrupt("return",(s.imageData=v,s));case 12:case"end":return e.stop()}}),e)}))),St.apply(this,arguments)}function kt(e,t,r){return Zt.apply(this,arguments)}function Zt(){return Zt=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.layerView,o=r.printTemplate,t.legendEnabled&&a.legendLayers.push({id:t.id}),e.t0=it,e.t1=t,e.next=6,jt(i);case 6:return e.t2=e.sent,e.t3=o,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)}))),Zt.apply(this,arguments)}function Pt(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});var r,n={layerType:(r=e.write()).layerType,customParameters:r.customParameters};return Tt(n,e),n}function Dt(e,t,r){return It.apply(this,arguments)}function It(){return It=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.is11xService&&t.serviceUrl&&t.styleUrl)){e.next=5;break}if(i=Ot(t.styleUrl,t.apiKey),o=Ot(t.serviceUrl,t.apiKey),(i||o)&&"2.1.0"===a.cimVersion){e.next=5;break}return s={type:"VectorTileLayer"},e.abrupt("return",(s.styleUrl=(0,k.Fv)(t.styleUrl),s.token=i,o!==i&&(s.additionalTokens=[{url:t.serviceUrl,token:o}]),s));case 5:return e.abrupt("return",wt(t,r,a));case 6:case"end":return e.stop()}}),e)}))),It.apply(this,arguments)}function Mt(e){var t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function Gt(e){var t,r=[];return e.sublayers&&e.sublayers.forEach((function e(t){t.visible&&(t.sublayers?t.sublayers.forEach(e):t.name&&r.unshift(t.name))})),r.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:(0,k.Fv)(e.url),version:e.version}),t}function Lt(e){var t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:(0,k.Fv)(e.url)}}function Tt(e,t){t.url&&(e.url=(0,k.Fv)(e.url||t.url),e.token=Ot(e.url,t.apiKey))}function Ot(e,t){var r,n;return(0,Ae.r)(e)&&(t||v.Z.apiKey)?t||v.Z.apiKey:null==(r=h.id)||null==(n=r.findCredential(e))?void 0:n.token}function Vt(e,t){return _t.apply(this,arguments)}function _t(){return _t=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s,l,u,c,p,f,y,d,b,m,v,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.canvas||(r.canvas=document.createElement("canvas")),a=1024,r.canvas.width=a,r.canvas.height=a,i=r.canvas.getContext("2d"),!t.path){e.next=20;break}if((u=new Path2D(t.path)).closePath(),i.fillStyle=Array.isArray(t.color)?"rgba(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],",").concat(t.color[3]/255,")"):"rgb(0,0,0)",i.fill(u),c=ve(i)){e.next=10;break}return e.abrupt("return",null);case 10:i.clearRect(0,0,a,a),p=(0,S.F2)(t.size)/Math.max(c.width,c.height),i.scale(p,p),y=(f=a/p)/2-c.width/2-c.x,d=f/2-c.height/2-c.y,i.translate(y,d),Array.isArray(t.color)&&i.fill(u),null!=(l=t.outline)&&l.width&&Array.isArray(t.outline.color)&&(b=t.outline,i.lineWidth=(0,S.F2)(b.width)/p,i.lineJoin="round",i.strokeStyle="rgba(".concat(b.color[0],",").concat(b.color[1],",").concat(b.color[2],",").concat(b.color[3]/255,")"),i.stroke(u),c.width+=i.lineWidth,c.height+=i.lineWidth),c.width*=p,c.height*=p,m=i.getImageData(a/2-c.width/2,a/2-c.height/2,Math.ceil(c.width),Math.ceil(c.height)),o=m.width,s=m.height,i.canvas.width=o,i.canvas.height=s,i.putImageData(m,0,0),e.next=25;break;case 20:return v="image/svg+xml"===t.contentType?"data:image/svg+xml;base64,"+t.imageData:t.url,e.next=23,(0,g.default)(v,{responseType:"image"});case 23:h=e.sent.data,o=(0,S.F2)(t.width),s=(0,S.F2)(t.height),i.canvas.width=o,i.canvas.height=s,i.drawImage(h,0,0,i.canvas.width,i.canvas.height);case 25:return e.abrupt("return",{type:"esriPMS",imageData:i.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:p(s),width:p(o),xoffset:t.xoffset,yoffset:t.yoffset});case 26:case"end":return e.stop()}}),e)}))),_t.apply(this,arguments)}function Ct(e,t){return Jt.apply(this,arguments)}function Jt(){return Jt=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("simple"!==(a=t.type)||!Et(t.symbol)){e.next=7;break}return e.next=4,Vt(t.symbol,r);case 4:t.symbol=e.sent,e.next=35;break;case 7:if("uniqueValue"!==a&&"classBreaks"!==a){e.next=35;break}if(e.t0=Et(t.defaultSymbol),!e.t0){e.next=13;break}return e.next=12,Vt(t.defaultSymbol,r);case 12:t.defaultSymbol=e.sent;case 13:if(!(i=t["uniqueValue"===a?"uniqueValueInfos":"classBreakInfos"])){e.next=35;break}o=(0,m.Z)(i),e.prev=16,o.s();case 18:if((s=o.n()).done){e.next=27;break}if(l=s.value,e.t1=Et(l.symbol),!e.t1){e.next=25;break}return e.next=24,Vt(l.symbol,r);case 24:l.symbol=e.sent;case 25:e.next=18;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(16),o.e(e.t2);case 32:return e.prev=32,o.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[16,29,32,35]])}))),Jt.apply(this,arguments)}function jt(e){return Ft.apply(this,arguments)}function Ft(){return Ft=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.queryFeatures(t.createQuery()).then((function(e){return e.features})));case 1:case"end":return e.stop()}}),e)}))),Ft.apply(this,arguments)}function Nt(e){return e.gpMetadata&&e.gpMetadata.executionType?We.fromJSON(e.gpMetadata.executionType):"sync"}function Et(e){return e&&(e.path||"image/svg+xml"===e.contentType||e.url&&e.url.endsWith(".svg"))}var Rt=r(4338),At=new p.X({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),Ut=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;(0,o.Z)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a)))._gpMetadata=null,e.updateDelay=1e3,e}return(0,s.Z)(r,[{key:"mode",get:function(){return this._gpMetadata&&this._gpMetadata.executionType?At.fromJSON(this._gpMetadata.executionType):"sync"}},{key:"execute",value:function(e,t){return e&&(e.updateDelay=this.updateDelay),function(e,t,r){return Ke.apply(this,arguments)}(this.url,e,(0,i.Z)((0,i.Z)({},this.requestOptions),t))}},{key:"_getGpPrintParams",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=$e(this.url),a=Be.get(r),e.abrupt("return",Xe(t,a));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Rt.Z);(0,c._)([(0,f.Cb)()],Ut.prototype,"_gpMetadata",void 0),(0,c._)([(0,f.Cb)({readOnly:!0})],Ut.prototype,"mode",null),(0,c._)([(0,f.Cb)()],Ut.prototype,"updateDelay",void 0);var qt=Ut=(0,c._)([(0,d.j)("esri.tasks.PrintTask")],Ut)},10141:function(e,t,r){function n(e){var t,r=e.layer;return"floorInfo"in r&&null!=(t=r.floorInfo)&&t.floorField&&"floors"in e.view?o(e.view.floors,r.floorInfo.floorField):null}function a(e,t){var r;return"floorInfo"in t&&null!=(r=t.floorInfo)&&r.floorField?o(e,t.floorInfo.floorField):null}function i(e,t){var r=t.definitionExpression;return e?r?"(".concat(r,") AND (").concat(e,")"):e:r}function o(e,t){if(null==e||!e.length)return null;var r=e.filter((function(e){return""!==e})).map((function(e){return"'".concat(e,"'")}));return r.push("''"),"".concat(t," IN (").concat(r.join(","),") OR ").concat(t," IS NULL")}r.d(t,{Hp:function(){return i},cx:function(){return n},ff:function(){return a}})}}]);
//# sourceMappingURL=658.0452ab20.chunk.js.map