"use strict";(self.webpackChunkfield_sustainability_helper=self.webpackChunkfield_sustainability_helper||[]).push([[8476],{82218:function(e,t,n){n.d(t,{a:function(){return _},c:function(){return w},g:function(){return W},h:function(){return Z},u:function(){return M}});var r=n(37762),i=n(43144),o=n(15671),a=(n(93169),n(32718)),u=n(16889),s=n(21530),c=n(14226),l=n(81949),f=n(11186),d=n(71353),h=n(85981),v=n(55652),g=n(40885),p=n(40927),y=n(11185),b=a.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane"),m=(0,i.Z)((function e(){(0,o.Z)(this,e),this.plane=(0,v.Ue)(),this.origin=(0,d.c)(),this.basis1=(0,d.c)(),this.basis2=(0,d.c)()}));function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R;return{plane:(0,v.Ue)(e.plane),origin:(0,d.a)(e.origin),basis1:(0,d.a)(e.basis1),basis2:(0,d.a)(e.basis2)}}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w();return k(e.origin,e.basis1,e.basis2,t)}function k(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w();return(0,f.g)(r.origin,e),(0,f.g)(r.basis1,t),(0,f.g)(r.basis2,n),M(r),N(r,"fromValues()"),r}function M(e){(0,v.my)(e.basis2,e.basis1,e.origin,e.plane)}function I(e,t,n){e!==n&&_(e,n);var r=(0,f.a)(y.WM.get(),z(e),t);return(0,f.b)(n.origin,n.origin,r),n.plane[3]-=t,n}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w(),n=(e[2]-e[0])/2,r=(e[3]-e[1])/2;return(0,f.s)(t.origin,e[0]+n,e[1]+r,0),(0,f.s)(t.basis1,n,0,0),(0,f.s)(t.basis2,0,r,0),(0,v.al)(0,0,1,0,t.plane),t}function S(e,t,n){return!!(0,v.BR)(e.plane,t,n)&&A(e,n)}function C(e,t,n){var i=V.get();j(e,t,i,V.get());var o,a=Number.POSITIVE_INFINITY,s=(0,r.Z)(L);try{for(s.s();!(o=s.n()).done;){var c=F(e,o.value,U.get()),l=y.WM.get();if((0,v.rx)(i,c,l)){var d=(0,f.r)(y.WM.get(),t.origin,l),h=Math.abs((0,u.ZF)((0,f.d)(t.direction,d)));h<a&&(a=h,(0,f.g)(n,l))}}}catch(g){s.e(g)}finally{s.f()}return a===Number.POSITIVE_INFINITY?P(e,t,n):n}function P(e,t,n){if(S(e,t,n))return n;var i=V.get(),o=V.get();j(e,t,i,o);var a,u=Number.POSITIVE_INFINITY,s=(0,r.Z)(L);try{for(s.s();!(a=s.n()).done;){var c=F(e,a.value,U.get()),l=y.WM.get();if((0,v.dZ)(i,c,l)){var d=(0,g.Jk)(t,l);if(!(0,v.Ac)(o,l))continue;d<u&&(u=d,(0,f.g)(n,l))}}}catch(h){s.e(h)}finally{s.f()}return T(e,t.origin)<u&&O(e,t.origin,n),n}function O(e,t,n){var r=(0,v.nF)(e.plane,t,y.WM.get()),i=(0,h.ct)(E(e,e.basis1),r,-1,1,y.WM.get()),o=(0,h.ct)(E(e,e.basis2),r,-1,1,y.WM.get());return(0,f.f)(n,(0,f.b)(y.WM.get(),i,o),e.origin),n}function H(e,t,n){var r=e.origin,i=e.basis1,o=e.basis2,a=(0,f.f)(y.WM.get(),t,r),u=(0,p.SR)(i,a),s=(0,p.SR)(o,a),c=(0,p.SR)(z(e),a);return(0,f.s)(n,u,s,c)}function T(e,t){var n=H(e,t,y.WM.get()),r=e.basis1,i=e.basis2,o=(0,f.l)(r),a=(0,f.l)(i),u=Math.max(Math.abs(n[0])-o,0),s=Math.max(Math.abs(n[1])-a,0),c=n[2];return u*u+s*s+c*c}function W(e,t){return Math.sqrt(T(e,t))}function x(e,t){var n=-e.plane[3];return(0,p.SR)(z(e),t)-n}function z(e){return(0,v.mJ)(e.plane)}function A(e,t){var n=(0,f.f)(y.WM.get(),t,e.origin),r=(0,f.p)(e.basis1),i=(0,f.p)(e.basis2),o=(0,f.d)(e.basis1,n),a=(0,f.d)(e.basis2,n);return-o-r<0&&o-r<0&&-a-i<0&&a-i<0}function E(e,t){var n=U.get();return(0,f.g)(n.origin,e.origin),(0,f.g)(n.vector,t),n}function F(e,t,n){var r=e.basis1,i=e.basis2,o=e.origin,a=(0,f.a)(y.WM.get(),r,t.origin[0]),u=(0,f.a)(y.WM.get(),i,t.origin[1]);(0,f.b)(n.origin,a,u),(0,f.b)(n.origin,n.origin,o);var s=(0,f.a)(y.WM.get(),r,t.direction[0]),c=(0,f.a)(y.WM.get(),i,t.direction[1]);return(0,f.a)(n.vector,(0,f.b)(s,s,c),2),n}function N(e,t){Math.abs((0,f.d)(e.basis1,e.basis2)/((0,f.l)(e.basis1)*(0,f.l)(e.basis2)))>1e-6&&b.warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,f.d)(e.basis1,z(e)))>1e-6&&b.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,f.d)(z(e),e.origin)-e.plane[3])>1e-6&&b.warn(t,"Plane offset is not consistent with plane origin")}function j(e,t,n,r){var i=z(e);(0,v.my)(i,t.direction,t.origin,n),(0,v.my)((0,v.mJ)(n),i,t.origin,r)}var R={plane:(0,v.Ue)(),origin:(0,d.f)(0,0,0),basis1:(0,d.f)(1,0,0),basis2:(0,d.f)(0,1,0)},V=new s.x(v.Ue),U=new s.x(h.Ue),J=(0,d.c)(),B=new s.x((function(){return{origin:null,basis1:null,basis2:null,plane:null}})),L=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],D=(0,l.c)(),q=(0,l.c)();Object.freeze({__proto__:null,BoundedPlaneClass:m,create:w,wrap:function(e,t,n){var r=B.get();return r.origin=e,r.basis1=t,r.basis2=n,r.plane=(0,v.re)(0,0,0,0),M(r),r},copy:_,copyWithoutVerify:function(e,t){(0,f.g)(t.origin,e.origin),(0,f.g)(t.basis1,e.basis1),(0,f.g)(t.basis2,e.basis2),(0,v.JG)(e.plane,t.plane)},fromValues:k,updateUnboundedPlane:M,elevate:I,setExtent:function(e,t,n){return Z(t,n),I(n,x(e,e.origin),n),n},fromAABoundingRect:Z,intersectRay:S,intersectRayClosestSilhouette:function(e,t,n){if(S(e,t,n))return n;var r=C(e,t,y.WM.get());return(0,f.b)(n,t.origin,(0,f.a)(y.WM.get(),t.direction,(0,f.i)(t.origin,r)/(0,f.l)(t.direction))),n},closestPointOnSilhouette:C,closestPoint:P,projectPoint:O,projectPointLocal:H,distance2:T,distance:W,distanceToSilhouette:function(e,t){var n,i=Number.NEGATIVE_INFINITY,o=(0,r.Z)(L);try{for(o.s();!(n=o.n()).done;){var a=F(e,n.value,U.get()),u=(0,h.Jk)(a,t);u>i&&(i=u)}}catch(s){o.e(s)}finally{o.f()}return Math.sqrt(i)},extrusionContainsPoint:function(e,t){return(0,v.Ac)(e.plane,t)&&A(e,t)},axisAt:function(e,t,n,r){return function(e,t,n){switch(t){case 0:(0,f.g)(n,e.basis1),(0,f.n)(n,n);break;case 1:(0,f.g)(n,e.basis2),(0,f.n)(n,n);break;case 2:(0,f.g)(n,z(e))}return n}(e,n,r)},altitudeAt:x,setAltitudeAt:function(e,t,n,r){var i=x(e,t),o=(0,f.a)(J,z(e),n-i);return(0,f.b)(r,t,o),r},equals:function(e,t){return(0,f.k)(e.basis1,t.basis1)&&(0,f.k)(e.basis2,t.basis2)&&(0,f.k)(e.origin,t.origin)},transform:function(e,t,n){return e!==n&&_(e,n),(0,c.b)(D,t),(0,c.t)(D,D),(0,f.m)(n.basis1,e.basis1,D),(0,f.m)(n.basis2,e.basis2,D),(0,f.m)((0,v.mJ)(n.plane),(0,v.mJ)(e.plane),D),(0,f.m)(n.origin,e.origin,t),(0,v.T5)(n.plane,n.origin,n.plane),n},rotate:function(e,t,n,r){return e!==r&&_(e,r),(0,c.e)(q,(0,c.i)(q),t,n),(0,f.m)(r.basis1,e.basis1,q),(0,f.m)(r.basis2,e.basis2,q),M(r),r},normal:z,UP:R})},11873:function(e,t,n){function r(){return[1,0,0,0,1,0,0,0,1]}function i(e,t){return new Float64Array(e,t,9)}n.d(t,{a:function(){return i},c:function(){return r}});Object.freeze({__proto__:null,create:r,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,n,r,i,o,a,u,s){return[e,t,n,r,i,o,a,u,s]},createView:i})},81949:function(e,t,n){function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function o(e,t,n,r,i,o,a,u,s,c,l,f,d,h,v,g){return[e,t,n,r,i,o,a,u,s,c,l,f,d,h,v,g]}function a(e,t){return new Float64Array(e,t,16)}n.d(t,{I:function(){return u},a:function(){return a},b:function(){return i},c:function(){return r},f:function(){return o}});var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:r,clone:i,fromValues:o,createView:a,IDENTITY:u})},98131:function(e,t,n){function r(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function o(e,t){return new Float64Array(e,t,4)}n.d(t,{I:function(){return a},a:function(){return r},b:function(){return i},c:function(){return o}});var a=[0,0,0,1];Object.freeze({__proto__:null,create:r,clone:i,fromValues:function(e,t,n,r){return[e,t,n,r]},createView:o,IDENTITY:a})},23470:function(e,t,n){n.d(t,{a:function(){return b},b:function(){return p},c:function(){return g},g:function(){return w},i:function(){return M},w:function(){return y}});n(93169);var r=n(32718),i=n(16889),o=n(92026),a=n(14226),u=n(11186),s=n(71353),c=n(90045),l=n(67077),f=n(40885),d=n(40927),h=n(11185),v=r.Z.getLogger("esri.geometry.support.sphere");function g(){return(0,l.c)()}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g();return(0,c.c)(t,e)}function y(e){return e}function b(e){e[0]=e[1]=e[2]=e[3]=0}function m(e){return Array.isArray(e)?e[3]:e}function w(e){return Array.isArray(e)?e:H}function _(e,t,n){if((0,o.Wi)(t))return!1;var r=t.origin,i=t.direction,a=k;a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2];var u=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],s=2*(i[0]*a[0]+i[1]*a[1]+i[2]*a[2]),c=s*s-4*u*(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]-e[3]*e[3]);if(c<0)return!1;var l=Math.sqrt(c),f=(-s-l)/(2*u),d=(-s+l)/(2*u);return(f<0||d<f&&d>0)&&(f=d),!(f<0)&&(n&&(n[0]=r[0]+i[0]*f,n[1]=r[1]+i[1]*f,n[2]=r[2]+i[2]*f),!0)}var k=(0,s.c)();function M(e,t){return _(e,t,null)}function I(e,t,n){var r=h.WM.get(),i=h.MP.get();(0,u.c)(r,t.origin,t.direction);var o=m(e);(0,u.c)(n,r,t.origin),(0,u.a)(n,n,1/(0,u.l)(n)*o);var s=S(e,t.origin),c=(0,d.EU)(t.origin,n);return(0,a.i)(i),(0,a.e)(i,i,c+s,r),(0,u.m)(n,n,i),n}function Z(e,t,n){var r=(0,u.f)(h.WM.get(),t,w(e)),i=(0,u.a)(h.WM.get(),r,e[3]/(0,u.l)(r));return(0,u.b)(n,i,w(e))}function S(e,t){var n=(0,u.f)(h.WM.get(),t,w(e)),r=(0,u.l)(n),o=m(e),a=o+Math.abs(o-r);return(0,i.ZF)(o/a)}var C=(0,s.c)();function P(e,t,n,r){var o=(0,u.f)(C,t,w(e));switch(n){case 0:var a=(0,i.jE)(o,C)[2];return(0,u.s)(r,-Math.sin(a),Math.cos(a),0);case 1:var s=(0,i.jE)(o,C),c=s[1],l=s[2],f=Math.sin(c);return(0,u.s)(r,-f*Math.cos(l),-f*Math.sin(l),Math.cos(c));case 2:return(0,u.n)(r,o);default:return}}function O(e,t){var n=(0,u.f)(T,t,w(e));return(0,u.l)(n)-e[3]}var H=(0,s.c)(),T=(0,s.c)();Object.freeze({__proto__:null,create:g,copy:p,fromCenterAndRadius:function(e,t){return(0,l.f)(e[0],e[1],e[2],t)},wrap:y,clear:b,fromRadius:function(e){return e},getRadius:m,getCenter:w,fromValues:function(e,t,n,r){return(0,l.f)(e,t,n,r)},elevate:function(e,t,n){return e!==n&&(0,u.g)(n,e),n[3]=e[3]+t,n},setExtent:function(e,t,n){return v.error("sphere.setExtent is not yet supported"),e===n?n:p(e,n)},intersectRay:_,intersectsRay:M,intersectRayClosestSilhouette:function(e,t,n){if(_(e,t,n))return n;var r=I(e,t,h.WM.get());return(0,u.b)(n,t.origin,(0,u.a)(h.WM.get(),t.direction,(0,u.i)(t.origin,r)/(0,u.l)(t.direction))),n},closestPointOnSilhouette:I,closestPoint:function(e,t,n){return _(e,t,n)?n:((0,f.JI)(t,w(e),n),Z(e,n,n))},projectPoint:Z,distanceToSilhouette:function(e,t){var n=(0,u.f)(h.WM.get(),t,w(e)),r=(0,u.p)(n),i=e[3]*e[3];return Math.sqrt(Math.abs(r-i))},angleToSilhouette:S,axisAt:P,altitudeAt:O,setAltitudeAt:function(e,t,n,r){var i=O(e,t),o=P(e,t,2,T),a=(0,u.a)(T,o,n-i);return(0,u.b)(r,t,a)}})},21530:function(e,t,n){n.d(t,{x:function(){return a}});var r=n(15671),i=n(43144),o=n(70758),a=function(){function e(t){(0,r.Z)(this,e),this.allocator=t,this._items=[],this._itemsPtr=0,this.grow()}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;return 0===this._itemsPtr&&(0,o.Y)((function(){return e.reset()})),this._itemsPtr===this._items.length&&this.grow(),this._items[this._itemsPtr++]}},{key:"reset",value:function(){var e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*u);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}},{key:"grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this._items.length,u));e++)this._items.push(this.allocator())}}]),e}(),u=1024},46798:function(e,t,n){n.d(t,{q:function(){return v}});var r=n(37762),i=n(1413),o=n(15671),a=n(43144),u=n(63780),s=n(42537),c=n(32718),l=n(92026),f=n(66978),d=n(31009),h=c.Z.getLogger("esri.core.workers.WorkerHandle"),v=function(){function e(t,n,a){var u=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,o.Z)(this,e),this._mainMethod=n,this._listeners=[],this._promise=(0,d.bA)(t,(0,i.Z)((0,i.Z)({},s),{},{schedule:a})).then((function(e){if(void 0===u._thread){u._thread=e,u._promise=null,s.hasInitialize&&u.broadcast({},"initialize");var t,n=(0,r.Z)(u._listeners);try{for(n.s();!(t=n.n()).done;){var i=t.value;u._connectListener(i)}}catch(o){n.e(o)}finally{n.f()}}else e.close()})),this._promise.catch((function(e){return h.error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return(0,a.Z)(e,[{key:"on",value:function(e,t){var n=this,r={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(r),this._connectListener(r),(0,s.kB)((function(){r.removed=!0,(0,u.Od)(n._listeners,r),n._thread&&(0,l.pC)(r.threadHandle)&&r.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,n){var r=this;if(this._thread){var i=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:i,signal:n})}return this._promise?this._promise.then((function(){return(0,f.k_)(n),r.invokeMethod(e,t,n)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var n=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return n.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}()},85981:function(e,t,n){n.d(t,{AR:function(){return p},Gr:function(){return g},JG:function(){return c},Ue:function(){return s},Jk:function(){return d},zk:function(){return f},al:function(){return l},KU:function(){return h},ct:function(){return v}});var r=n(16889),i=n(21530),o=n(11186),a=n(71353),u=n(11185);function s(e){return e?{origin:(0,a.a)(e.origin),vector:(0,a.a)(e.vector)}:{origin:(0,a.c)(),vector:(0,a.c)()}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s();return l(e.origin,e.vector,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return(0,o.g)(n.origin,e),(0,o.g)(n.vector,t),n}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return(0,o.g)(n.origin,e),(0,o.f)(n.vector,t,e),n}function d(e,t){var n=(0,o.f)(u.WM.get(),t,e.origin),i=(0,o.d)(e.vector,n),a=(0,o.d)(e.vector,e.vector),s=(0,r.uZ)(i/a,0,1),c=(0,o.f)(u.WM.get(),(0,o.a)(u.WM.get(),e.vector,s),n);return(0,o.d)(c,c)}function h(e,t,n){return(0,o.b)(n,e.origin,(0,o.a)(n,e.vector,t))}function v(e,t,n,i,a){var s=e.vector,c=e.origin,l=(0,o.f)(u.WM.get(),t,c),f=(0,o.d)(s,l)/(0,o.p)(s);return(0,o.a)(a,s,(0,r.uZ)(f,n,i)),(0,o.b)(a,a,e.origin)}function g(e,t){if(y(e,function(e,t){var n=m.get();return n.origin=e,n.vector=t,n}(t.origin,t.direction),!1,b)){var n=b.tA,r=b.pB,i=b.distance2;if(n>=0&&n<=1)return i;if(n<0)return(0,o.h)(e.origin,r);if(n>1)return(0,o.h)((0,o.b)(u.WM.get(),e.origin,e.vector),r)}return null}function p(e,t,n){return!!y(e,t,!0,b)&&((0,o.g)(n,b.pA),!0)}function y(e,t,n,i){var a=1e-6,s=e.origin,c=(0,o.b)(u.WM.get(),s,e.vector),l=t.origin,f=(0,o.b)(u.WM.get(),l,t.vector),d=u.WM.get(),h=u.WM.get();if(d[0]=s[0]-l[0],d[1]=s[1]-l[1],d[2]=s[2]-l[2],h[0]=f[0]-l[0],h[1]=f[1]-l[1],h[2]=f[2]-l[2],Math.abs(h[0])<a&&Math.abs(h[1])<a&&Math.abs(h[2])<a)return!1;var v=u.WM.get();if(v[0]=c[0]-s[0],v[1]=c[1]-s[1],v[2]=c[2]-s[2],Math.abs(v[0])<a&&Math.abs(v[1])<a&&Math.abs(v[2])<a)return!1;var g=d[0]*h[0]+d[1]*h[1]+d[2]*h[2],p=h[0]*v[0]+h[1]*v[1]+h[2]*v[2],y=d[0]*v[0]+d[1]*v[1]+d[2]*v[2],b=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],m=(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])*b-p*p;if(Math.abs(m)<a)return!1;var w=(g*p-y*b)/m,_=(g+p*w)/b;n&&(w=(0,r.uZ)(w,0,1),_=(0,r.uZ)(_,0,1));var k=u.WM.get(),M=u.WM.get();return k[0]=s[0]+w*v[0],k[1]=s[1]+w*v[1],k[2]=s[2]+w*v[2],M[0]=l[0]+_*h[0],M[1]=l[1]+_*h[1],M[2]=l[2]+_*h[2],i.tA=w,i.tB=_,i.pA=k,i.pB=M,i.distance2=(0,o.h)(k,M),!0}var b={tA:0,tB:0,pA:(0,a.c)(),pB:(0,a.c)(),distance2:0},m=new i.x((function(){return{origin:null,vector:null}}))},55652:function(e,t,n){n.d(t,{Er:function(){return O},JG:function(){return l},Ue:function(){return s},$I:function(){return v},zk:function(){return h},Yq:function(){return d},al:function(){return f},my:function(){return M},fn:function(){return I},rx:function(){return S},dZ:function(){return C},BR:function(){return Z},Ac:function(){return P},tk:function(){return k},mJ:function(){return x},nF:function(){return H},T5:function(){return _},jH:function(){return T},re:function(){return c}});var r=n(16889),i=n(92026),o=n(11186),a=n(71353),u=(n(23470),n(11185));function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z;return[e[0],e[1],e[2],e[3]]}function c(e,t,n,r){return f(e,t,n,r,u.o6.get())}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s();return f(e[0],e[1],e[2],e[3],t)}function f(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s();return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function d(e,t,n){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s(),i=n[0]-t[0],o=n[1]-t[1],a=n[2]-t[2],u=e[0]-t[0],c=e[1]-t[1],l=e[2]-t[2],f=o*l-a*c,d=a*u-i*l,h=i*c-o*u,v=f*f+d*d+h*h,g=Math.abs(v-1)>1e-5&&v>1e-12?1/Math.sqrt(v):1;r[0]=f*g,r[1]=d*g,r[2]=h*g,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2])}function v(e,t,n,r,i){if(e.count<3)return!1;e.getVec(n,p);for(var a=r,u=!1;a<e.count-1&&!u;)e.getVec(a,y),a++,u=!(0,o.k)(p,y);if(!u)return!1;for(a=Math.max(a,i),u=!1;a<e.count&&!u;)e.getVec(a,b),a++,(0,o.f)(m,p,y),(0,o.n)(m,m),(0,o.f)(w,y,b),(0,o.n)(w,w),u=!(0,o.k)(p,b)&&!(0,o.k)(y,b)&&Math.abs((0,o.d)(m,w))<g;return u?(h(p,y,b,t),!0):(0!==n||1!==r||2!==i)&&v(e,t,0,1,2)}var g=.99619469809,p=(0,a.c)(),y=(0,a.c)(),b=(0,a.c)(),m=(0,a.c)(),w=(0,a.c)();function _(e,t,n){return e!==n&&l(e,n),n[3]=-(0,o.d)(n,t),n}function k(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function M(e,t,n,r){return(0,o.c)(b,t,e),d(n,b,r)}function I(e,t,n,r){return W(e,t,(0,o.f)(u.WM.get(),n,t),A,r)}function Z(e,t,n){return!!(0,i.pC)(t)&&W(e,t.origin,t.direction,E,n)}function S(e,t,n){return W(e,t.origin,t.vector,0,n)}function C(e,t,n){return W(e,t.origin,t.vector,1,n)}function P(e,t){return T(e,t)>=0}function O(e,t){var n=(0,o.d)(e,t.ray.direction),r=-T(e,t.ray.origin);if(n>-1e-6&&n<1e-6)return r>0;var i=r/n;return n>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function H(e,t,n){var r=(0,o.a)(u.WM.get(),e,-e[3]),i=function(e,t,n){var r=(0,o.a)(u.WM.get(),e,(0,o.d)(e,t));return(0,o.f)(n,t,r),n}(e,(0,o.f)(u.WM.get(),t,r),u.WM.get());return(0,o.b)(n,i,r),n}function T(e,t){return(0,o.d)(e,t)+e[3]}function W(e,t,n,i,a){var u=(0,o.d)(e,n);if(0===u)return!1;var s=-((0,o.d)(e,t)+e[3])/u;return 1&i&&(s=(0,r.uZ)(s,0,1)),!(!(4&i)&&s<0||!(8&i)&&s>1)&&((0,o.b)(a,t,(0,o.a)(a,n,s)),!0)}function x(e){return e}var z=[0,0,1,0],A=12,E=8},40885:function(e,t,n){n.d(t,{JI:function(){return h},JG:function(){return c},Ue:function(){return u},Jk:function(){return d},zk:function(){return l},re:function(){return s}});n(63780);var r=n(21530),i=n(11186),o=n(71353),a=n(11185);function u(e){return e?{origin:(0,o.a)(e.origin),direction:(0,o.a)(e.direction)}:{origin:(0,o.c)(),direction:(0,o.c)()}}function s(e,t){var n=v.get();return n.origin=e,n.direction=t,n}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u();return f(e.origin,e.direction,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u();return(0,i.g)(n.origin,e),(0,i.f)(n.direction,t,e),n}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u();return(0,i.g)(n.origin,e),(0,i.g)(n.direction,t),n}function d(e,t){var n=(0,i.c)(a.WM.get(),(0,i.n)(a.WM.get(),e.direction),(0,i.f)(a.WM.get(),t,e.origin));return(0,i.d)(n,n)}function h(e,t,n){var r=(0,i.d)(e.direction,(0,i.f)(n,t,e.origin));return(0,i.b)(n,e.origin,(0,i.a)(n,e.direction,r)),n}var v=new r.x((function(){return{origin:null,direction:null}}))},40927:function(e,t,n){n.d(t,{EU:function(){return s},cp:function(){return c},nF:function(){return a},SR:function(){return u}});var r=n(16889),i=n(11186),o=n(71353);function a(e,t,n){var r=(0,i.d)(e,t)/(0,i.d)(e,e);return(0,i.a)(n,e,r)}function u(e,t){return(0,i.d)(e,t)/(0,i.l)(e)}function s(e,t){var n=(0,i.d)(e,t)/((0,i.l)(e)*(0,i.l)(t));return-(0,r.ZF)(n)}function c(e,t,n){(0,i.n)(l,e),(0,i.n)(f,t);var o=(0,i.d)(l,f),a=(0,r.ZF)(o),u=(0,i.c)(l,l,f);return(0,i.d)(u,n)<0?2*Math.PI-a:a}var l=(0,o.c)(),f=(0,o.c)()},11185:function(e,t,n){n.d(t,{MP:function(){return y},vD:function(){return b},qW:function(){return v},WM:function(){return g},o6:function(){return p}});var r=n(15671),i=n(43144),o=n(70758),a=n(11873),u=n(81949),s=n(98131),c=n(6394),l=n(71353),f=n(67077),d=function(){function e(t,n,i){(0,r.Z)(this,e),this.itemByteSize=t,this.itemCreate=n,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(i/this.itemByteSize)}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;0===this._itemsPtr&&(0,o.Y)((function(){return e.reset()}));for(var t=Math.floor(this._itemsPtr/this._itemsPerBuffer);this._buffers.length<=t;){for(var n=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize),r=0;r<this._itemsPerBuffer;++r)this._items.push(this.itemCreate(n,r*this.itemByteSize));this._buffers.push(n)}return this._items[this._itemsPtr++]}},{key:"reset",value:function(){for(var e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}},{key:"test",get:function(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(16,c.c,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(24,l.b,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(32,f.a,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(72,a.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(128,u.a,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(32,s.c,t)}}]),e}(),h=4096,v=d.createVec2f64(),g=d.createVec3f64(),p=d.createVec4f64(),y=(d.createMat3f64(),d.createMat4f64()),b=d.createQuatf64()},38476:function(e,t,n){n.r(t),n.d(t,{FeatureServiceSnappingSource:function(){return re}});var r=n(1413),i=n(15861),o=n(15671),a=n(43144),u=n(60136),s=n(29388),c=n(87757),l=n(27366),f=n(85015),d=n(41691),h=n(42537),v=n(92026),g=n(94172),p=n(49861),y=(n(63780),n(93169),n(25243),n(69912)),b=n(37762),m=n(11186),w=n(67077),_=n(82218);function k(e,t){return(0,_.h)(t.extent,M),(0,_.g)(M,(0,m.s)(I,e.x,e.y,0))}var M=(0,_.c)(),I=(0,w.c)(),Z=n(69787),S=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).pointOfInterest=null,r}return(0,a.Z)(n,[{key:"tiles",get:function(){var e=this.tilesCoveringView,t=(0,v.pC)(this.pointOfInterest)?this.pointOfInterest:this.view.center;return e.sort((function(e,n){return k(t,e)-k(t,n)})),e}},{key:"scaleEnabled",value:function(){return(0,Z.rs)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}},{key:"tilesCoveringView",get:function(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||(0,v.Wi)(this.tileInfo))return[];if(!this.scaleEnabled)return[];var e,t=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),n=t.spans,r=t.lodInfo,i=r.level,o=[],a=(0,b.Z)(n);try{for(a.s();!(e=a.n()).done;)for(var u=e.value,s=u.row,c=u.colFrom,l=u.colTo,f=c;f<=l;f++){var d={id:null,level:i,row:s,col:r.normalizeCol(f)};this.tileInfo.updateTileInfo(d),o.push(d)}}catch(h){a.e(h)}finally{a.f()}return o}},{key:"tileInfo",get:function(){var e,t;return null!=(e=null==(t=this.view.featuresTilingScheme)?void 0:t.tileInfo)?e:null}},{key:"tileSize",get:function(){return(0,v.pC)(this.tileInfo)?this.tileInfo.size[0]:256}},{key:"initialize",value:function(){var e=this;this.handles.add(this.watch("view.state.viewpoint",(function(){return e.notifyChange("tilesCoveringView")}),!0))}}]),n}((0,d.p)(f.Z));(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tiles",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"scaleEnabled",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tilesCoveringView",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tileInfo",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tileSize",null),(0,l._)([(0,p.Cb)({constructOnly:!0})],S.prototype,"view",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],S.prototype,"layer",void 0),(0,l._)([(0,p.Cb)()],S.prototype,"pointOfInterest",void 0),S=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],S);var C=n(29439),P=n(8537),O=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).pointOfInterest=null,r}return(0,a.Z)(n,[{key:"tiles",get:function(){var e=this.tilesCoveringView,t=this.effectivePointOfInterest;if((0,v.pC)(t))for(var n=e.map((function(e){return k(t,e)})),r=1;r<n.length;r++)if(n[r-1]>n[r])return e.sort((function(e,n){return k(t,e)-k(t,n)})),e.slice();return e}},{key:"tilesCoveringView",get:function(){var e,t;return this.filterTiles(null==(e=this.view.featureTiles)||null==(t=e.tiles)?void 0:t.toArray()).map(H)}},{key:"tileInfo",get:function(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tilingScheme.toTileInfo())?e:null}},{key:"tileSize",get:function(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tileSize)?e:256}},{key:"effectivePointOfInterest",get:function(){var e,t=this.pointOfInterest;return(0,v.pC)(t)?t:null==(e=this.view.pointsOfInterest)?void 0:e.focus.location}},{key:"initialize",value:function(){var e=this;this.handles.add((0,P.S1)(this.view,"featureTiles",(function(t){e.handles.remove(W),t&&e.handles.add(t.addClient(),W)})))}},{key:"filterTiles",value:function(e){return(0,v.Wi)(e)?[]:e.filter((function(e){return Math.abs(e.measures.screenRect[3]-e.measures.screenRect[1])>T&&2===e.measures.visibility}))}}]),n}(d.r);function H(e){var t=(0,C.Z)(e.lij,3),n=t[0],r=t[1],i=t[2],o=e.extent;return{id:"".concat(n,"/").concat(r,"/").concat(i),level:n,row:r,col:i,extent:o}}(0,l._)([(0,p.Cb)({readOnly:!0})],O.prototype,"tiles",null),(0,l._)([(0,p.Cb)({readOnly:!0})],O.prototype,"tilesCoveringView",null),(0,l._)([(0,p.Cb)({readOnly:!0})],O.prototype,"tileInfo",null),(0,l._)([(0,p.Cb)({readOnly:!0})],O.prototype,"tileSize",null),(0,l._)([(0,p.Cb)({constructOnly:!0})],O.prototype,"view",void 0),(0,l._)([(0,p.Cb)()],O.prototype,"pointOfInterest",void 0),(0,l._)([(0,p.Cb)()],O.prototype,"effectivePointOfInterest",null),O=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],O);var T=50,W="feature-tiles",x=n(69117),z=n(100),A=n(80885),E=n(65156),F=n(51995),N=n(52639),j=n(16889),R=n(62554),V=n(61459),U=n(58009),J=n(35874),B=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]],L=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).updating=!1,r.enablePolygons=!0,r.enableLabels=!0,r._polygons=new Map,r._labels=new Map,r._enabled=!0,r}return(0,a.Z)(n,[{key:"initialize",value:function(){this._symbols=B.map((function(e){return new V.Z({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}})})),this.update()}},{key:"destroy",value:function(){this._enabled=!1,this.clear()}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this.update())}},{key:"update",value:function(){var e=this;if(this._enabled){var t=this.getTiles(),n=new Array,r=new Set((this._labels.size,this._labels.keys()));t.forEach((function(i,o){var a=i.lij.toString();r.delete(a);var u=i.lij[0],s=i.geometry;if(e.enablePolygons&&!e._polygons.has(a)){var c=new N.Z({geometry:s,symbol:e._symbols[u%e._symbols.length]});e._polygons.set(a,c),n.push(c)}if(e.enableLabels){var l=function(e){if((0,v.pC)(e.label))return e.label;var t=e.lij.toString();return(0,v.pC)(e.loadPriority)&&(t+=" (".concat(e.loadPriority,")")),t}(i),f=o/(t.length-1),d=(0,j.t7)(0,200,f),h=(0,j.t7)(20,6,f)/.75,g=(0,v.pC)(i.loadPriority)&&i.loadPriority>=t.length,p=new F.Z([d,g?0:d,g?0:d]),y="3d"===e.view.type?function(){return new R.Z({verticalOffset:{screenLength:40/.75},callout:{type:"line",color:"white",border:{color:"black"}},symbolLayers:[new J.Z({text:l,halo:{color:"white",size:1/.75},material:{color:p},size:h})]})}:function(){return new U.Z({text:l,haloColor:"white",haloSize:1/.75,color:p,size:h})};if(e._labels.has(a)){var b=e._labels.get(a),m=y();((0,v.Wi)(b.symbol)||JSON.stringify(m)!==JSON.stringify(b.symbol))&&(b.symbol=m)}else{var w=new N.Z({geometry:s.extent.center,symbol:y()});e._labels.set(a,w),n.push(w)}}}));var i=new Array;r.forEach((function(t){e._polygons.has(t)&&(i.push(e._polygons.get(t)),e._polygons.delete(t)),e._labels.has(t)&&(i.push(e._labels.get(t)),e._labels.delete(t))})),this.view.graphics.removeMany(i),this.view.graphics.addMany(n)}else this.clear()}},{key:"clear",value:function(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}}]),n}(f.Z);(0,l._)([(0,p.Cb)({constructOnly:!0})],L.prototype,"view",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],L.prototype,"updating",void 0),(0,l._)([(0,p.Cb)()],L.prototype,"enabled",null);var D=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).handles=new z.Z,r}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this,t=setInterval((function(){return e.fetchDebugInfo()}),2e3);this.handles.add((0,h.kB)((function(){return clearInterval(t)})))}},{key:"destroy",value:function(){this.handles.destroy()}},{key:"getTiles",value:function(){var e=this;if(!this.debugInfo)return[];var t=new Map,n=new Map;this.debugInfo.storedTiles.forEach((function(e){t.set(e.data.id,e.featureCount)})),this.debugInfo.pendingTiles.forEach((function(e){t.set(e.data.id,e.featureCount),n.set(e.data.id,e.state)}));var r=function(e){var r,i=n.get(e),o=null!=(r=t.get(e))?r:"?";return i?"".concat(i,":").concat(o,"\n").concat(e):"store:".concat(o,"\n").concat(e)},i=new Map;return this.debugInfo.storedTiles.forEach((function(e){i.set(e.data.id,e.data)})),this.debugInfo.pendingTiles.forEach((function(e){i.set(e.data.id,e.data)})),Array.from(i.values()).map((function(t){return{lij:[t.level,t.row,t.col],geometry:A.Z.fromExtent((0,E.HH)(t.extent,e.view.spatialReference)),label:r(t.id)}}))}},{key:"fetchDebugInfo",value:function(){var e=this;this.handle.getDebugInfo(null).then((function(t){e.debugInfo=t,e.update()}))}}]),n}(L=(0,l._)([(0,y.j)("esri.views.support.TileTreeDebugger")],L));(0,l._)([(0,p.Cb)({constructOnly:!0})],D.prototype,"handle",void 0),D=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],D);var q=n(66978),Y=n(46798),G=n(27823),Q=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).availability=0,r.workerHandleUpdating=!0,r.editId=0,r}return(0,a.Z)(n,[{key:"updating",get:function(){return this.updatingHandles.updating||this.workerHandleUpdating}},{key:"destroy",value:function(){this.workerHandle.destroy()}},{key:"initialize",value:function(){var e=this;this.workerHandle=new X(this.schedule),this.handles.add([this.workerHandle.on("notify-updating",(function(t){var n=t.updating;return e.workerHandleUpdating=n})),this.workerHandle.on("notify-availability",(function(t){var n=t.availability;return e._set("availability",n)}))])}},{key:"setup",value:function(){var e=(0,i.Z)(c.mark((function e(t,n){var r,i;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.serviceInfoFromLayer(t.layer),!(0,v.Wi)(r)){e.next=3;break}return e.abrupt("return");case 3:return i={configuration:this.convertConfiguration(t.configuration),serviceInfo:r,spatialReference:t.spatialReference.toJSON()},e.next=6,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("setup",i,n));case 6:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=(0,i.Z)(c.mark((function e(t,n){var r;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.convertConfiguration(t),e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("configure",r,n));case 3:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=(0,i.Z)(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("refresh",{},t));case 2:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=(0,i.Z)(c.mark((function e(t,n){var r;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={distance:t.distance,point:t.coordinateHelper.vectorToPoint(t.point).toJSON(),types:t.types,filter:(0,v.pC)(t.filter)?t.filter.createQuery().toJSON():null},e.abrupt("return",this.workerHandle.invoke(r,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTiles",value:function(){var e=(0,i.Z)(c.mark((function e(t,n){var r;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={tiles:t.tiles,tileInfo:(0,v.pC)(t.tileInfo)?t.tileInfo.toJSON():null,tileSize:t.tileSize},e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("updateTiles",r,n));case 3:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=(0,i.Z)(c.mark((function e(t,n){var r,i,o,a,u,s,l,f,d,h;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.editId++,f={id:l},e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("beginApplyEdits",f,n));case 3:return this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n)),e.next=6,this.updatingHandles.addPromise((0,q.Hl)(t.result,n));case 6:return d=e.sent,h={id:l,edits:{addedFeatures:null!=(r=null==(i=d.addedFeatures)?void 0:i.map((function(e){return e.objectId})))?r:[],deletedFeatures:null!=(o=null==(a=d.deletedFeatures)?void 0:a.map((function(e){return{objectId:e.objectId,globalId:e.globalId}})))?o:[],updatedFeatures:null!=(u=null==(s=d.updatedFeatures)?void 0:s.map((function(e){return e.objectId})))?u:[]}},e.next=10,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("endApplyEdits",h,n));case 10:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(e){return this.workerHandle.invokeMethod("getDebugInfo",{},e)}},{key:"convertConfiguration",value:function(e){return{filter:(0,v.pC)(e.filter)?e.filter.toJSON():null,customParameters:e.customParameters}}},{key:"serviceInfoFromLayer",value:function(e){var t;return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl.path,fields:e.fields.map((function(e){return e.toJSON()})),geometryType:G.Mk.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:null==(t=e.timeInfo)?void 0:t.toJSON()}}}]),n}(d.r);(0,l._)([(0,p.Cb)({constructOnly:!0})],Q.prototype,"schedule",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],Q.prototype,"updating",null),(0,l._)([(0,p.Cb)({readOnly:!0})],Q.prototype,"availability",void 0),(0,l._)([(0,p.Cb)()],Q.prototype,"workerHandleUpdating",void 0),Q=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],Q);var X=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,"FeatureServiceSnappingSourceWorker","fetchCandidates",e,{strategy:"dedicated"})}return(0,a.Z)(n,[{key:"getTransferList",value:function(){return[]}}]),n}(Y.q),K=n(7882),$=n(59068),ee=n(22824),te=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).pointOfInterest=null,r}return(0,a.Z)(n,[{key:"tiles",get:function(){return[{id:"0/0/0",level:0,row:0,col:0,extent:(0,E.al)(-1e8,-1e8,1e8,1e8)}]}},{key:"tileInfo",get:function(){return new ee.Z({origin:new K.Z({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new $.Z({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}},{key:"tileSize",get:function(){return this.tileInfo.size[0]}}]),n}(f.Z);(0,l._)([(0,p.Cb)({readOnly:!0})],te.prototype,"tiles",null),(0,l._)([(0,p.Cb)({readOnly:!0})],te.prototype,"tileInfo",null),(0,l._)([(0,p.Cb)({readOnly:!0})],te.prototype,"tileSize",null),(0,l._)([(0,p.Cb)({constructOnly:!0})],te.prototype,"layer",void 0),(0,l._)([(0,p.Cb)()],te.prototype,"pointOfInterest",void 0),te=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],te);var ne=n(32609),re=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,a.Z)(n,[{key:"updateTilesParameters",get:function(){return{tiles:this.tilesOfInterest.tiles,tileInfo:this.tilesOfInterest.tileInfo,tileSize:this.tilesOfInterest.tileSize}}},{key:"updating",get:function(){return this.workerHandle.updating||this.updatingHandles.updating}},{key:"configuration",get:function(){return{filter:this.layer.createQuery(),customParameters:this.layer.customParameters}}},{key:"availability",get:function(){return this.workerHandle.availability}},{key:"layer",get:function(){return this.layerSource.layer}},{key:"initialize",value:function(){var e=this,t=this.view;if((0,v.pC)(t))switch(t.type){case"2d":this.tilesOfInterest=new S({view:t,layer:this.layer}),this.workerHandle=new Q;break;case"3d":var n=t.resourceController;this.tilesOfInterest=new O({view:t}),this.workerHandle=new Q({schedule:function(e){return n.schedule(e)}})}else this.tilesOfInterest=new te({layer:this.layer}),this.workerHandle=new Q;this.handles.add([(0,h.ed)(this.workerHandle)]),this.workerHandle.setup({layer:this.layer,spatialReference:this.spatialReference,configuration:this.configuration},null),this.updatingHandles.add(this,"updateTilesParameters",(function(){return e.workerHandle.updateTiles(e.updateTilesParameters,null)}),2),this.handles.add([(0,g.Ym)((function(){return e.configuration}),(function(t){return e.workerHandle.configure(t,null)}),g.Z_)]),(0,v.pC)(t)&&this.handles.add((0,g.Ym)((function(){return ne.Z.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES}),(function(n){n&&!e.debug?(e.debug=new D({view:t,handle:e.workerHandle}),e.handles.add((0,h.ed)(e.debug),"debug")):!n&&e.debug&&e.handles.remove("debug")}),g.nn)),this.handles.add(this.layerSource.layer.on("apply-edits",(function(t){e.workerHandle.applyEdits(t,null)})))}},{key:"refresh",value:function(){this.workerHandle.refresh(null)}},{key:"fetchCandidates",value:function(){var e=(0,i.Z)(c.mark((function e(t,n){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tilesOfInterest.pointOfInterest=t.coordinateHelper.vectorToPoint(t.point),e.next=3,this.workerHandle.fetchCandidates((0,r.Z)((0,r.Z)({},t),{},{filter:null}),n);case 3:return e.abrupt("return",e.sent.candidates.map((function(e){return(0,x.X)(e,t.coordinateHelper)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(e){return this.workerHandle.getDebugInfo(e)}}]),n}((0,d.p)(f.Z));(0,l._)([(0,p.Cb)({constructOnly:!0})],re.prototype,"spatialReference",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],re.prototype,"layerSource",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],re.prototype,"view",void 0),(0,l._)([(0,p.Cb)()],re.prototype,"tilesOfInterest",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],re.prototype,"updateTilesParameters",null),(0,l._)([(0,p.Cb)({readOnly:!0})],re.prototype,"updating",null),(0,l._)([(0,p.Cb)({readOnly:!0})],re.prototype,"configuration",null),(0,l._)([(0,p.Cb)({readOnly:!0})],re.prototype,"availability",null),re=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],re)},69117:function(e,t,n){n.d(t,{X:function(){return h}});var r=n(95905),i=n(1413),o=n(15671),a=n(43144),u=n(60136),s=n(29388),c=n(95122),l=n(75691),f=n(61309),d=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,(0,i.Z)((0,i.Z)({},e),{},{constraint:new c.Hk(e.coordinateHelper,e.targetPoint)}))}return(0,a.Z)(n,[{key:"hints",get:function(){return[new f.n(this.targetPoint)]}}]),n}(l.a);function h(e,t){switch(e.type){case"edge":return new r.L({coordinateHelper:t,edgeStart:t.pointToVector(e.start),edgeEnd:t.pointToVector(e.end),targetPoint:t.pointToVector(e.target),objectId:e.objectId});case"vertex":return new d({coordinateHelper:t,targetPoint:t.pointToVector(e.target),objectId:e.objectId})}}},61309:function(e,t,n){n.d(t,{n:function(){return s}});var r=n(15671),i=n(43144),o=n(60136),a=n(29388),u=n(64674),s=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this)).point=e,i}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,u.Xv)(this.point,e.point)}}]),n}(n(55054).r)}}]);
//# sourceMappingURL=8476.511b7e64.chunk.js.map