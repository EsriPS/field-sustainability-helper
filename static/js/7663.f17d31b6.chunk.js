"use strict";(self.webpackChunkfield_sustainability_helper=self.webpackChunkfield_sustainability_helper||[]).push([[7663],{57663:function(n,e,a){a.r(e),a.d(e,{classBreaks:function(){return d},histogram:function(){return b},summaryStatistics:function(){return c},uniqueValues:function(){return v}});var r=a(15861),t=a(87757),i=(a(10064),a(78952)),l=(a(80031),a(15903)),u=a(819),o=null;function s(n,e){return f.apply(this,arguments)}function f(){return f=(0,r.Z)(t.mark((function n(e,a){var r,s,f,c,m,v,p,d,h,b,V;return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a){n.next=2;break}return n.abrupt("return",[]);case 2:if(r=e.field,s=e.valueExpression,f=e.normalizationType,c=e.normalizationField,m=e.normalizationTotal,v=[],p=e.viewInfoParams,d=null,h=null,!s){n.next=12;break}if(o){n.next=11;break}return n.next=8,(0,u.LC)();case 8:b=n.sent,V=b.arcadeUtils,o=V;case 11:d=o.createFunction(s),h=p&&o.getViewInfo({viewingMode:p.viewingMode,scale:p.scale,spatialReference:new i.Z(p.spatialReference)});case 12:return n.abrupt("return",(a.forEach((function(n){var e,a=n.attributes;if(s){var t=o.createExecContext(n,h);e=o.executeFunction(d,t)}else a&&(e=a[r]);if(f&&isFinite(e)){var i=a&&parseFloat(a[c]);e=(0,l.fk)(e,f,i,m)}v.push(e)})),v));case 13:case"end":return n.stop()}}),n)}))),f.apply(this,arguments)}function c(n){return m.apply(this,arguments)}function m(){return m=(0,r.Z)(t.mark((function n(e){var a,r,i,u,o,f,c,m,v,p,d;return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.attribute,r=e.features,i=a.normalizationType,u=a.normalizationField,o=a.minValue,f=a.maxValue,c=a.fieldType,n.next=9,s({field:a.field,valueExpression:a.valueExpression,normalizationType:i,normalizationField:u,normalizationTotal:a.normalizationTotal,viewInfoParams:a.viewInfoParams},r);case 9:return m=n.sent,v=(0,l.S5)({normalizationType:i,normalizationField:u,minValue:o,maxValue:f}),p={value:.5,fieldType:c},d="esriFieldTypeString"===c?(0,l.H0)({values:m,supportsNullCount:v,percentileParams:p}):(0,l.i5)({values:m,minValue:o,maxValue:f,useSampleStdDev:!i,supportsNullCount:v,percentileParams:p}),n.abrupt("return",(0,l.F_)(d,"esriFieldTypeDate"===c));case 14:case"end":return n.stop()}}),n)}))),m.apply(this,arguments)}function v(n){return p.apply(this,arguments)}function p(){return(p=(0,r.Z)(t.mark((function n(e){var a,r,i,u;return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.attribute,r=e.features,n.next=4,s({field:a.field,valueExpression:a.valueExpression,viewInfoParams:a.viewInfoParams},r);case 4:return i=n.sent,u=(0,l.eT)(i),n.abrupt("return",(0,l.Qm)(u,a.domain,a.returnAllCodedValues));case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function d(n){return h.apply(this,arguments)}function h(){return h=(0,r.Z)(t.mark((function n(e){var a,r,i,u,o,f,c,m,v;return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.attribute,r=e.features,i=a.field,u=a.normalizationType,o=a.normalizationField,f=a.normalizationTotal,c=a.classificationMethod,n.next=9,s({field:i,valueExpression:a.valueExpression,normalizationType:u,normalizationField:o,normalizationTotal:f,viewInfoParams:a.viewInfoParams},r);case 9:return m=n.sent,v=(0,l.G2)(m,{field:i,normalizationType:u,normalizationField:o,normalizationTotal:f,classificationMethod:c,standardDeviationInterval:a.standardDeviationInterval,numClasses:a.numClasses,minValue:a.minValue,maxValue:a.maxValue}),n.abrupt("return",(0,l.DL)(v,c));case 12:case"end":return n.stop()}}),n)}))),h.apply(this,arguments)}function b(n){return V.apply(this,arguments)}function V(){return V=(0,r.Z)(t.mark((function n(e){var a,r,i,u,o,f,c,m;return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.attribute,r=e.features,i=a.field,u=a.normalizationType,o=a.normalizationField,f=a.normalizationTotal,c=a.classificationMethod,n.next=9,s({field:i,valueExpression:a.valueExpression,normalizationType:u,normalizationField:o,normalizationTotal:f,viewInfoParams:a.viewInfoParams},r);case 9:return m=n.sent,n.abrupt("return",(0,l.oF)(m,{field:i,normalizationType:u,normalizationField:o,normalizationTotal:f,classificationMethod:c,standardDeviationInterval:a.standardDeviationInterval,numBins:a.numBins,minValue:a.minValue,maxValue:a.maxValue}));case 11:case"end":return n.stop()}}),n)}))),V.apply(this,arguments)}},15903:function(n,e,a){a.d(e,{G2:function(){return w},oF:function(){return S},XL:function(){return x},i5:function(){return V},H0:function(){return b},eT:function(){return F},Qm:function(){return M},Lq:function(){return y},fk:function(){return I},S5:function(){return h},F_:function(){return z},DL:function(){return D}});var r=a(37762),t=a(93433),i=a(76551);function l(n,e){return Number(n.toFixed(e))}function u(n){var e=n.definition,a=e.classificationMethod,r=e.breakCount,t=e.normalizationType,i=e.definedInterval,u=[],c=n.values;if(0===c.length)return[];c=c.sort((function(n,e){return n-e}));var m=c[0],v=c[c.length-1];if("equal-interval"===a)if(c.length>=r){for(var p=(v-m)/r,d=m,h=1;h<r;h++){var b=l(m+h*p,6);u.push({minValue:d,maxValue:b,label:o(d,b,t)}),d=b}u.push({minValue:d,maxValue:v,label:o(d,v,t)})}else c.forEach((function(n){u.push({minValue:n,maxValue:n,label:o(n,n,t)})}));else if("natural-breaks"===a){for(var V=s(c),x=n.valueFrequency||V.valueFrequency,y=f(V.uniqueValues,x,r),T=m,g=1;g<r;g++)if(V.uniqueValues.length>g){var z=l(V.uniqueValues[y[g]],6);u.push({minValue:T,maxValue:z,label:o(T,z,t)}),T=z}u.push({minValue:T,maxValue:v,label:o(T,v,t)})}else if("quantile"===a)if(c.length>=r&&m!==v){for(var F=m,M=Math.ceil(c.length/r),I=0,w=1;w<r;w++){var k=M+I-1;k>c.length&&(k=c.length-1),k<0&&(k=0),u.push({minValue:F,maxValue:c[k],label:o(F,c[k],t)}),F=c[k],I+=M,M=Math.ceil((c.length-I)/(r-w))}u.push({minValue:F,maxValue:v,label:o(F,v,t)})}else for(var D=-1,S=0;S<c.length;S++){var N=c[S];N!==D&&(D=N,u.push({minValue:D,maxValue:N,label:o(D,N,t)}),D=N)}else if("standard-deviation"===a){var C=function(n){for(var e=0,a=0;a<n.length;a++)e+=n[a];return e/n.length}(c),E=function(n,e){for(var a=0,r=0;r<n.length;r++){var t=n[r];a+=(t-e)*(t-e)}return a/=n.length,Math.sqrt(a)}(c,C);if(0===E)u.push({minValue:c[0],maxValue:c[0],label:o(c[0],c[0],t)});else{for(var q=function(n,e,a,r,t){var i=Math.max(r-n,e-r)/t/a;return i>=1?1:i>=.5?.5:.25}(m,v,r,C,E)*E,P=0,Z=m,B=r;B>=1;B--){var _=l(C-(B-.5)*q,6);u.push({minValue:Z,maxValue:_,label:o(Z,_,t)}),Z=_,P++}var G=l(C+.5*q,6);u.push({minValue:Z,maxValue:G,label:o(Z,G,t)}),Z=G,P++;for(var L=1;L<=r;L++)G=P===2*r?v:l(C+(L+.5)*q,6),u.push({minValue:Z,maxValue:G,label:o(Z,G,t)}),Z=G,P++}}else if("defined-interval"===a){if(!i)return u;for(var U=c[0],A=c[c.length-1],O=Math.ceil((A-U)/i),Q=U,H=1;H<O;H++){var R=l(U+H*i,6);u.push({minValue:Q,maxValue:R,label:o(Q,R,t)}),Q=R}u.push({minValue:Q,maxValue:A,label:o(Q,A,t)})}return u}function o(n,e,a){return n===e?a&&"percent-of-total"===a?n+"%":n.toString():a&&"percent-of-total"===a?n+"% - "+e+"%":n+" - "+e}function s(n){for(var e=[],a=[],r=Number.MIN_VALUE,t=1,i=-1,l=0;l<n.length;l++){var u=n[l];u===r?(t++,a[i]=t):null!==u&&(e.push(u),r=u,t=1,a.push(t),i++)}return{uniqueValues:e,valueFrequency:a}}function f(n,e,a){var r=n.length,t=[];a>r&&(a=r);for(var i=0;i<a;i++)t.push(Math.round(i*r/a-1));t.push(r-1);var l=c(t,n,e,a);return function(n,e,a,r,t,i){for(var l=0,u=0,o=0,s=0,f=!0,c=0;c<2&&f;c++){0===c&&(f=!1);for(var v=0;v<i-1;v++)for(;a[v+1]+1!==a[v+2];){a[v+1]=a[v+1]+1;var p=m(v,a,r,t);o=p.sbMean,l=p.sbSdcm;var d=m(v+1,a,r,t);if(s=d.sbMean,!(l+(u=d.sbSdcm)<e[v]+e[v+1])){a[v+1]=a[v+1]-1;break}e[v]=l,e[v+1]=u,n[v]=o,n[v+1]=s,f=!0}for(var h=i-1;h>0;h--)for(;a[h]!==a[h-1]+1;){a[h]=a[h]-1;var b=m(h-1,a,r,t);o=b.sbMean,l=b.sbSdcm;var V=m(h,a,r,t);if(s=V.sbMean,!(l+(u=V.sbSdcm)<e[h-1]+e[h])){a[h]=a[h]+1;break}e[h-1]=l,e[h]=u,n[h-1]=o,n[h]=s,f=!0}}return f}(l.mean,l.sdcm,t,n,e,a)&&(l=c(t,n,e,a)),t}function c(n,e,a,r){for(var t=[],i=[],l=[],u=0,o=[],s=[],f=0;f<r;f++){var c=m(f,n,e,a);o.push(c.sbMean),s.push(c.sbSdcm),u+=s[f]}for(var v,p=u,d=!0;d||u<p;){d=!1,t=[];for(var h=0;h<r;h++)t.push(n[h]);for(var b=0;b<r;b++)for(var V=n[b]+1;V<=n[b+1];V++)if(v=e[V],b>0&&V!==n[b+1]&&Math.abs(v-o[b])>Math.abs(v-o[b-1]))n[b]=V;else if(b<r-1&&n[b]!==V-1&&Math.abs(v-o[b])>Math.abs(v-o[b+1])){n[b+1]=V-1;break}p=u,u=0,i=[],l=[];for(var x=0;x<r;x++){i.push(o[x]),l.push(s[x]);var y=m(x,n,e,a);o[x]=y.sbMean,s[x]=y.sbSdcm,u+=s[x]}}if(u>p){for(var T=0;T<r;T++)n[T]=t[T],o[T]=i[T],s[T]=l[T];u=p}return{mean:o,sdcm:s}}function m(n,e,a,r){for(var t=0,i=0,l=e[n]+1;l<=e[n+1];l++){var u=r[l];t+=a[l]*u,i+=u}i<=0&&console.log("Exception in Natural Breaks calculation");for(var o=t/i,s=0,f=e[n]+1;f<=e[n+1];f++)s+=r[f]*Math.pow(a[f]-o,2);return{sbMean:o,sbSdcm:s}}var v=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,p=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),d=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function h(n){var e=null!=n.normalizationField||null!=n.normalizationType,a=null!=n.minValue||null!=n.maxValue,r=!!n.sqlExpression&&n.supportsSQLExpression;return!e&&!a&&!r}function b(n){var e=n.returnDistinct?(0,t.Z)(new Set(n.values)):n.values,a=e.filter((function(n){return null!=n})).length,r={count:a};return n.supportsNullCount&&(r.nullcount=e.length-a),n.percentileParams&&(r.median=x(e,n.percentileParams)),r}function V(n){var e,a=n.values,t=n.useSampleStdDev,i=n.supportsNullCount,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,o=null,s=null,f=null,c=null,m=0,v=null==n.minValue?-1/0:n.minValue,p=null==n.maxValue?1/0:n.maxValue,d=(0,r.Z)(a);try{for(d.s();!(e=d.n()).done;){var h=e.value;Number.isFinite(h)?h>=v&&h<=p&&(o+=h,l=Math.min(l,h),u=Math.max(u,h),m++):"string"==typeof h&&m++}}catch(z){d.e(z)}finally{d.f()}if(m&&null!=o){s=o/m;var b,V=0,y=(0,r.Z)(a);try{for(y.s();!(b=y.n()).done;){var T=b.value;Number.isFinite(T)&&T>=v&&T<=p&&(V+=Math.pow(T-s,2))}}catch(z){y.e(z)}finally{y.f()}c=t?m>1?V/(m-1):0:m>0?V/m:0,f=Math.sqrt(c)}else l=null,u=null;var g={avg:s,count:m,max:u,min:l,stddev:f,sum:o,variance:c};return i&&(g.nullcount=a.length-m),n.percentileParams&&(g.median=x(a,n.percentileParams)),g}function x(n,e){var a=e.fieldType,r=e.value,i=e.orderBy,l=e.isDiscrete,u=y(a,"desc"===i);if(0===(n=(0,t.Z)(n).filter((function(n){return null!=n})).sort((function(n,e){return u(n,e)}))).length)return null;if(r<=0)return n[0];if(r>=1)return n[n.length-1];var o=(n.length-1)*r,s=Math.floor(o),f=s+1,c=o%1,m=n[s],v=n[f];return f>=n.length||l||"string"==typeof m||"string"==typeof v?m:m*(1-c)+v*c}function y(n,e){var a=e?1:-1,r=function(n){return n?function(n,e){return e-n}:function(n,e){return n-e}}(e),i=T(e);if(!n||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID"].concat((0,t.Z)(p)).includes(n))return function(n,e){return"number"==typeof n&&"number"==typeof e?r(n,e):"string"==typeof n&&"string"==typeof e?i(n,e):a};if("esriFieldTypeDate"===n)return function(n,e){var t=new Date(n).getTime(),i=new Date(e).getTime();return isNaN(t)||isNaN(i)?a:r(t,i)};if(p.has(n))return function(n,e){return r(n,e)};if("esriFieldTypeString"===n)return function(n,e){return i(n,e)};if("esriFieldTypeGUID"===n||"esriFieldTypeGlobalID"===n){var l=T(e);return function(n,e){return l(g(n),g(e))}}return e?function(n,e){return 1}:function(n,e){return-1}}function T(n){return n?function(n,e){return(n=n.toUpperCase())>(e=e.toUpperCase())?-1:n<e?1:0}:function(n,e){return(n=n.toUpperCase())<(e=e.toUpperCase())?-1:n>e?1:0}}function g(n){return n.substr(24,12)+n.substr(19,4)+n.substr(16,2)+n.substr(14,2)+n.substr(11,2)+n.substr(9,2)+n.substr(6,2)+n.substr(4,2)+n.substr(2,2)+n.substr(0,2)}function z(n,e){var a;for(a in n)d.indexOf(a)>-1&&(Number.isFinite(n[a])||(n[a]=null));return e?(["avg","stddev","variance"].forEach((function(e){null!=n[e]&&(n[e]=Math.ceil(n[e]))})),n):n}function F(n){var e,a={},t=(0,r.Z)(n);try{for(t.s();!(e=t.n()).done;){var i=e.value;(null==i||"string"==typeof i&&""===i.trim())&&(i=null),null==a[i]?a[i]={count:1,data:i}:a[i].count++}}catch(l){t.e(l)}finally{t.f()}return{count:a}}function M(n,e,a){var r=n.count,t=[];for(var i in a&&e&&"coded-value"===e.type&&e.codedValues.forEach((function(n){var e=n.code;r.hasOwnProperty(e)||(r[e]={data:e,count:0})})),r){var l=r[i];t.push({value:l.data,count:l.count,label:l.label})}return{uniqueValueInfos:t}}function I(n,e,a,r){var t=null;switch(e){case"log":0!==n&&(t=Math.log(n)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(r)&&0!==r&&(t=n/r*100);break;case"field":Number.isFinite(a)&&0!==a&&(t=n/a);break;case"natural-log":n>0&&(t=Math.log(n));break;case"square-root":n>0&&(t=Math.pow(n,.5))}return t}function w(n,e){var a=k({field:e.field,normalizationType:e.normalizationType,normalizationField:e.normalizationField,classificationMethod:e.classificationMethod,standardDeviationInterval:e.standardDeviationInterval,breakCount:e.numClasses||5});return n=function(n,e,a){return e=null==e?-1/0:e,a=null==a?1/0:a,n.filter((function(n){return Number.isFinite(n)&&n>=e&&n<=a}))}(n,e.minValue,e.maxValue),function(n){var e=n.normalizationTotal;return{classBreaks:u(n),normalizationTotal:e}}({definition:a,values:n,normalizationTotal:e.normalizationTotal})}function k(n){var e=n.field,a=n.classificationMethod||"equal-interval",r=n.normalizationType,t=n.normalizationField,l=new i.Z;return l.classificationField=e,l.breakCount=n.breakCount,l.classificationMethod=a,l.standardDeviationInterval="standard-deviation"===a?n.standardDeviationInterval||1:void 0,l.normalizationType=r,l.normalizationField="field"===r?t:void 0,l}function D(n,e){var a=n.classBreaks,r=a.length,t=a[0].minValue,i=a[r-1].maxValue,l="standard-deviation"===e,u=v;return a=a.map((function(n){var e=n.label,a={minValue:n.minValue,maxValue:n.maxValue,label:e};if(l&&e){var r=e.match(u).map((function(n){return+n.trim()}));2===r.length?(a.minStdDev=r[0],a.maxStdDev=r[1],r[0]<0&&r[1]>0&&(a.hasAvg=!0)):1===r.length&&(e.includes("<")?(a.minStdDev=null,a.maxStdDev=r[0]):e.includes(">")&&(a.minStdDev=r[0],a.maxStdDev=null))}return a})),{minValue:t,maxValue:i,classBreakInfos:a,normalizationTotal:n.normalizationTotal}}function S(n,e){var a,t=function(n,e){var a=e.field,r=e.classificationMethod,t=e.standardDeviationInterval,i=e.normalizationType,l=e.normalizationField,u=e.normalizationTotal,o=e.minValue,s=e.maxValue,f=e.numBins||10,c=null,m=null,v=null;if(r&&"equal-interval"!==r||i){var p=w(n,{field:a,normalizationType:i,normalizationField:l,normalizationTotal:u,classificationMethod:r,standardDeviationInterval:t,minValue:o,maxValue:s,numClasses:f}).classBreaks;c=p[0].minValue,m=p[p.length-1].maxValue,v=p.map((function(n){return[n.minValue,n.maxValue]}))}else{if(null!=o&&null!=s)c=o,m=s;else{var d=V({values:n,minValue:o,maxValue:s,useSampleStdDev:!i,supportsNullCount:h({normalizationType:i,normalizationField:l,minValue:o,maxValue:s})});c=d.min,m=d.max}v=function(n,e,a){for(var r,t=(e-n)/a,i=[],l=n,u=1;u<=a;u++)r=l+t,r=Number(r.toFixed(16)),i.push([l,u===a?e:r]),l=r;return i}(c,m,f)}return{min:c,max:m,intervals:v}}(n,e),i=t.min,l=t.max,u=t.intervals,o=u.map((function(n,e){return{minValue:u[e][0],maxValue:u[e][1],count:0}})),s=(0,r.Z)(n);try{for(s.s();!(a=s.n()).done;){var f=a.value;if(null!=f&&f>=i&&f<=l){var c=N(u,f);c>-1&&o[c].count++}}}catch(m){s.e(m)}finally{s.f()}return{bins:o,minValue:i,maxValue:l,normalizationTotal:e.normalizationTotal}}function N(n,e){for(var a=-1,r=n.length-1;r>=0;r--)if(e>=n[r][0]){a=r;break}return a}}}]);
//# sourceMappingURL=7663.f17d31b6.chunk.js.map