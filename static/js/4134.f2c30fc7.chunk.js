"use strict";(globalThis.webpackChunkfield_sustainability_helper=globalThis.webpackChunkfield_sustainability_helper||[]).push([[4134],{82218:(e,t,i)=>{i.d(t,{a:()=>_,c:()=>v,g:()=>T,h:()=>I,u:()=>m});i(93169);var n=i(32718),r=i(16889),s=i(21530),o=i(14226),a=i(81949),l=i(11186),c=i(71353),u=i(14320),d=i(85981),h=i(55652),f=i(40885),g=i(40927),p=i(11185);const b=n.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z;return{plane:(0,h.Ue)(e.plane),origin:(0,c.a)(e.origin),basis1:(0,c.a)(e.basis1),basis2:(0,c.a)(e.basis2)}}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v();return y(e.origin,e.basis1,e.basis2,t)}function y(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v();return(0,l.g)(n.origin,e),(0,l.g)(n.basis1,t),(0,l.g)(n.basis2,i),m(n),F(n,"fromValues()"),n}function m(e){(0,h.my)(e.basis2,e.basis1,e.origin,e.plane)}function w(e,t,i){e!==i&&_(e,i);const n=(0,l.a)(p.WM.get(),H(e),t);return(0,l.b)(i.origin,i.origin,n),i.plane[3]-=t,i}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v();const i=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return(0,l.s)(t.origin,e[0]+i,e[1]+n,0),(0,l.s)(t.basis1,i,0,0),(0,l.s)(t.basis2,0,n,0),(0,h.al)(0,0,1,0,t.plane),t}function M(e,t,i){return!!(0,h.BR)(e.plane,t,i)&&E(e,i)}function S(e,t,i){const n=x.get();R(e,t,n,x.get());let s=Number.POSITIVE_INFINITY;for(const o of B){const a=A(e,o,V.get()),c=p.WM.get();if((0,h.rx)(n,a,c)){const e=(0,l.r)(p.WM.get(),t.origin,c),n=Math.abs((0,r.ZF)((0,l.d)(t.direction,e)));n<s&&(s=n,(0,l.g)(i,c))}}return s===Number.POSITIVE_INFINITY?k(e,t,i):i}function k(e,t,i){if(M(e,t,i))return i;const n=x.get(),r=x.get();R(e,t,n,r);let s=Number.POSITIVE_INFINITY;for(const o of B){const a=A(e,o,V.get()),c=p.WM.get();if((0,h.dZ)(n,a,c)){const e=(0,f.Jk)(t,c);if(!(0,h.Ac)(r,c))continue;e<s&&(s=e,(0,l.g)(i,c))}}return O(e,t.origin)<s&&C(e,t.origin,i),i}function C(e,t,i){const n=(0,h.nF)(e.plane,t,p.WM.get()),r=(0,d.ct)(W(e,e.basis1),n,-1,1,p.WM.get()),s=(0,d.ct)(W(e,e.basis2),n,-1,1,p.WM.get());return(0,l.f)(i,(0,l.b)(p.WM.get(),r,s),e.origin),i}function P(e,t,i){const{origin:n,basis1:r,basis2:s}=e,o=(0,l.f)(p.WM.get(),t,n),a=(0,g.SR)(r,o),c=(0,g.SR)(s,o),u=(0,g.SR)(H(e),o);return(0,l.s)(i,a,c,u)}function O(e,t){const i=P(e,t,p.WM.get()),{basis1:n,basis2:r}=e,s=(0,l.l)(n),o=(0,l.l)(r),a=Math.max(Math.abs(i[0])-s,0),c=Math.max(Math.abs(i[1])-o,0),u=i[2];return a*a+c*c+u*u}function T(e,t){return Math.sqrt(O(e,t))}function N(e,t){const i=-e.plane[3];return(0,g.SR)(H(e),t)-i}function H(e){return(0,h.mJ)(e.plane)}function E(e,t){const i=(0,l.f)(p.WM.get(),t,e.origin),n=(0,l.p)(e.basis1),r=(0,l.p)(e.basis2),s=(0,l.d)(e.basis1,i),o=(0,l.d)(e.basis2,i);return-s-n<0&&s-n<0&&-o-r<0&&o-r<0}function W(e,t){const i=V.get();return(0,l.g)(i.origin,e.origin),(0,l.g)(i.vector,t),i}function A(e,t,i){const{basis1:n,basis2:r,origin:s}=e,o=(0,l.a)(p.WM.get(),n,t.origin[0]),a=(0,l.a)(p.WM.get(),r,t.origin[1]);(0,l.b)(i.origin,o,a),(0,l.b)(i.origin,i.origin,s);const c=(0,l.a)(p.WM.get(),n,t.direction[0]),u=(0,l.a)(p.WM.get(),r,t.direction[1]);return(0,l.a)(i.vector,(0,l.b)(c,c,u),2),i}function F(e,t){Math.abs((0,l.d)(e.basis1,e.basis2)/((0,l.l)(e.basis1)*(0,l.l)(e.basis2)))>1e-6&&b.warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,l.d)(e.basis1,H(e)))>1e-6&&b.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,l.d)(H(e),e.origin)-e.plane[3])>1e-6&&b.warn(t,"Plane offset is not consistent with plane origin")}function R(e,t,i,n){const r=H(e);(0,h.my)(r,t.direction,t.origin,i),(0,h.my)((0,h.mJ)(i),r,t.origin,n)}const z={plane:(0,h.Ue)(),origin:(0,c.f)(0,0,0),basis1:(0,c.f)(1,0,0),basis2:(0,c.f)(0,1,0)},x=new s.x(h.Ue),V=new s.x(d.Ue),Z=(0,c.c)(),j=new s.x((()=>({origin:null,basis1:null,basis2:null,plane:null}))),B=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],L=(0,a.c)(),U=(0,a.c)();Object.freeze({__proto__:null,BoundedPlaneClass:class{constructor(){this.plane=(0,h.Ue)(),this.origin=(0,c.c)(),this.basis1=(0,c.c)(),this.basis2=(0,c.c)()}},create:v,wrap:function(e,t,i){const n=j.get();return n.origin=e,n.basis1=t,n.basis2=i,n.plane=(0,h.re)(0,0,0,0),m(n),n},copy:_,copyWithoutVerify:function(e,t){(0,l.g)(t.origin,e.origin),(0,l.g)(t.basis1,e.basis1),(0,l.g)(t.basis2,e.basis2),(0,h.JG)(t.plane,e.plane)},fromValues:y,updateUnboundedPlane:m,elevate:w,setExtent:function(e,t,i){return I(t,i),w(i,N(e,e.origin),i),i},fromAABoundingRect:I,intersectRay:M,intersectRayClosestSilhouette:function(e,t,i){if(M(e,t,i))return i;const n=S(e,t,p.WM.get());return(0,l.b)(i,t.origin,(0,l.a)(p.WM.get(),t.direction,(0,l.i)(t.origin,n)/(0,l.l)(t.direction))),i},closestPointOnSilhouette:S,closestPoint:k,projectPoint:C,projectPointLocal:P,distance2:O,distance:T,distanceToSilhouette:function(e,t){let i=Number.NEGATIVE_INFINITY;for(const n of B){const r=A(e,n,V.get()),s=(0,d.Jk)(r,t);s>i&&(i=s)}return Math.sqrt(i)},extrusionContainsPoint:function(e,t){return(0,h.Ac)(e.plane,t)&&E(e,t)},axisAt:function(e,t,i,n){return function(e,t,i){switch(t){case u.R.X:(0,l.g)(i,e.basis1),(0,l.n)(i,i);break;case u.R.Y:(0,l.g)(i,e.basis2),(0,l.n)(i,i);break;case u.R.Z:(0,l.g)(i,H(e))}return i}(e,i,n)},altitudeAt:N,setAltitudeAt:function(e,t,i,n){const r=N(e,t),s=(0,l.a)(Z,H(e),i-r);return(0,l.b)(n,t,s),n},equals:function(e,t){return(0,l.k)(e.basis1,t.basis1)&&(0,l.k)(e.basis2,t.basis2)&&(0,l.k)(e.origin,t.origin)},transform:function(e,t,i){return e!==i&&_(e,i),(0,o.a)(L,t),(0,o.t)(L,L),(0,l.m)(i.basis1,e.basis1,L),(0,l.m)(i.basis2,e.basis2,L),(0,l.m)((0,h.mJ)(i.plane),(0,h.mJ)(e.plane),L),(0,l.m)(i.origin,e.origin,t),(0,h.T5)(i.plane,i.plane,i.origin),i},rotate:function(e,t,i,n){return e!==n&&_(e,n),(0,o.d)(U,t,i),(0,l.m)(n.basis1,e.basis1,U),(0,l.m)(n.basis2,e.basis2,U),m(n),n},normal:H,UP:z})},11873:(e,t,i)=>{function n(){return[1,0,0,0,1,0,0,0,1]}function r(e,t){return new Float64Array(e,t,9)}i.d(t,{a:()=>r,c:()=>n});Object.freeze({__proto__:null,create:n,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,i,n,r,s,o,a,l){return[e,t,i,n,r,s,o,a,l]},createView:r})},81949:(e,t,i)=>{function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function s(e,t,i,n,r,s,o,a,l,c,u,d,h,f,g,p){return[e,t,i,n,r,s,o,a,l,c,u,d,h,f,g,p]}function o(e,t){return new Float64Array(e,t,16)}i.d(t,{I:()=>a,a:()=>o,b:()=>r,c:()=>n,f:()=>s});const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:n,clone:r,fromValues:s,createView:o,IDENTITY:a})},98131:(e,t,i)=>{function n(){return[0,0,0,1]}function r(e){return[e[0],e[1],e[2],e[3]]}function s(e,t){return new Float64Array(e,t,4)}i.d(t,{I:()=>o,a:()=>n,b:()=>r,c:()=>s});const o=[0,0,0,1];Object.freeze({__proto__:null,create:n,clone:r,fromValues:function(e,t,i,n){return[e,t,i,n]},createView:s,IDENTITY:o})},23470:(e,t,i)=>{i.d(t,{a:()=>y,b:()=>v,c:()=>b,g:()=>w,i:()=>S,w:()=>_});i(93169);var n=i(32718),r=i(16889),s=i(92026),o=i(14226),a=i(11186),l=i(71353),c=i(90045),u=i(67077),d=i(14320),h=i(40885),f=i(40927),g=i(11185);const p=n.Z.getLogger("esri.geometry.support.sphere");function b(){return(0,u.c)()}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b();return(0,c.c)(t,e)}function _(e){return e}function y(e){e[0]=e[1]=e[2]=e[3]=0}function m(e){return Array.isArray(e)?e[3]:e}function w(e){return Array.isArray(e)?e:H}function I(e,t,i){if((0,s.Wi)(t))return!1;const{origin:n,direction:r}=t,o=M;o[0]=n[0]-e[0],o[1]=n[1]-e[1],o[2]=n[2]-e[2];const a=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],l=2*(r[0]*o[0]+r[1]*o[1]+r[2]*o[2]),c=l*l-4*a*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-e[3]*e[3]);if(c<0)return!1;const u=Math.sqrt(c);let d=(-l-u)/(2*a);const h=(-l+u)/(2*a);return(d<0||h<d&&h>0)&&(d=h),!(d<0)&&(i&&(i[0]=n[0]+r[0]*d,i[1]=n[1]+r[1]*d,i[2]=n[2]+r[2]*d),!0)}const M=(0,l.c)();function S(e,t){return I(e,t,null)}function k(e,t,i){const n=g.WM.get(),r=g.MP.get();(0,a.c)(n,t.origin,t.direction);const s=m(e);(0,a.c)(i,n,t.origin),(0,a.a)(i,i,1/(0,a.l)(i)*s);const l=P(e,t.origin),c=(0,f.EU)(t.origin,i);return(0,o.d)(r,c+l,n),(0,a.m)(i,i,r),i}function C(e,t,i){const n=(0,a.f)(g.WM.get(),t,w(e)),r=(0,a.a)(g.WM.get(),n,e[3]/(0,a.l)(n));return(0,a.b)(i,r,w(e))}function P(e,t){const i=(0,a.f)(g.WM.get(),t,w(e)),n=(0,a.l)(i),s=m(e),o=s+Math.abs(s-n);return(0,r.ZF)(s/o)}const O=(0,l.c)();function T(e,t,i,n){const s=(0,a.f)(O,t,w(e));switch(i){case d.R.X:{const e=(0,r.jE)(s,O)[2];return(0,a.s)(n,-Math.sin(e),Math.cos(e),0)}case d.R.Y:{const e=(0,r.jE)(s,O),t=e[1],i=e[2],o=Math.sin(t);return(0,a.s)(n,-o*Math.cos(i),-o*Math.sin(i),Math.cos(t))}case d.R.Z:return(0,a.n)(n,s);default:return}}function N(e,t){const i=(0,a.f)(E,t,w(e));return(0,a.l)(i)-e[3]}const H=(0,l.c)(),E=(0,l.c)();Object.freeze({__proto__:null,create:b,copy:v,fromCenterAndRadius:function(e,t){return(0,u.f)(e[0],e[1],e[2],t)},wrap:_,clear:y,fromRadius:function(e){return e},getRadius:m,getCenter:w,fromValues:function(e,t,i,n){return(0,u.f)(e,t,i,n)},elevate:function(e,t,i){return e!==i&&(0,a.g)(i,e),i[3]=e[3]+t,i},setExtent:function(e,t,i){return p.error("sphere.setExtent is not yet supported"),e===i?i:v(e,i)},intersectRay:I,intersectsRay:S,intersectRayClosestSilhouette:function(e,t,i){if(I(e,t,i))return i;const n=k(e,t,g.WM.get());return(0,a.b)(i,t.origin,(0,a.a)(g.WM.get(),t.direction,(0,a.i)(t.origin,n)/(0,a.l)(t.direction))),i},closestPointOnSilhouette:k,closestPoint:function(e,t,i){return I(e,t,i)?i:((0,h.JI)(t,w(e),i),C(e,i,i))},projectPoint:C,distanceToSilhouette:function(e,t){const i=(0,a.f)(g.WM.get(),t,w(e)),n=(0,a.p)(i),r=e[3]*e[3];return Math.sqrt(Math.abs(n-r))},angleToSilhouette:P,axisAt:T,altitudeAt:N,setAltitudeAt:function(e,t,i,n){const r=N(e,t),s=T(e,t,d.R.Z,E),o=(0,a.a)(E,s,i-r);return(0,a.b)(n,t,o)}})},21530:(e,t,i)=>{i.d(t,{x:()=>r});var n=i(70758);class r{constructor(e){this.allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,n.Y)((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*s);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,s));e++)this._items.push(this.allocator())}}const s=1024},46798:(e,t,i)=>{i.d(t,{q:()=>u});var n=i(63780),r=i(42537),s=i(32718),o=i(92026),a=i(66978),l=i(31009);const c=s.Z.getLogger("esri.core.workers.WorkerHandle");class u{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._mainMethod=t,this._listeners=[],this._promise=(0,l.bA)(e,{...n,schedule:i}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,n.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>c.error(`Failed to initialize ${e} worker: ${t}`)))}on(e,t){const i={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(i),this._connectListener(i),(0,r.kB)((()=>{i.removed=!0,(0,n.Od)(this._listeners,i),this._thread&&(0,o.pC)(i.threadHandle)&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,i){if(this._thread){const n=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:n,signal:i})}return this._promise?this._promise.then((()=>((0,a.k_)(i),this.invokeMethod(e,t,i)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},14320:(e,t,i)=>{var n;i.d(t,{R:()=>n}),function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(n||(n={}))},85981:(e,t,i)=>{i.d(t,{AR:()=>b,Gr:()=>p,JG:()=>c,Jk:()=>h,KU:()=>f,Ue:()=>l,al:()=>u,ct:()=>g,zk:()=>d});var n=i(16889),r=i(21530),s=i(11186),o=i(71353),a=i(11185);function l(e){return e?{origin:(0,o.a)(e.origin),vector:(0,o.a)(e.vector)}:{origin:(0,o.c)(),vector:(0,o.c)()}}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l();return u(e.origin,e.vector,t)}function u(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,s.g)(i.origin,e),(0,s.g)(i.vector,t),i}function d(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,s.g)(i.origin,e),(0,s.f)(i.vector,t,e),i}function h(e,t){const i=(0,s.f)(a.WM.get(),t,e.origin),r=(0,s.d)(e.vector,i),o=(0,s.d)(e.vector,e.vector),l=(0,n.uZ)(r/o,0,1),c=(0,s.f)(a.WM.get(),(0,s.a)(a.WM.get(),e.vector,l),i);return(0,s.d)(c,c)}function f(e,t,i){return(0,s.b)(i,e.origin,(0,s.a)(i,e.vector,t))}function g(e,t,i,r,o){const{vector:l,origin:c}=e,u=(0,s.f)(a.WM.get(),t,c),d=(0,s.d)(l,u)/(0,s.p)(l);return(0,s.a)(o,l,(0,n.uZ)(d,i,r)),(0,s.b)(o,o,e.origin)}function p(e,t){if(v(e,function(e,t){const i=y.get();return i.origin=e,i.vector=t,i}(t.origin,t.direction),!1,_)){const{tA:t,pB:i,distance2:n}=_;if(t>=0&&t<=1)return n;if(t<0)return(0,s.h)(e.origin,i);if(t>1)return(0,s.h)((0,s.b)(a.WM.get(),e.origin,e.vector),i)}return null}function b(e,t,i){return!!v(e,t,!0,_)&&((0,s.g)(i,_.pA),!0)}function v(e,t,i,r){const o=1e-6,l=e.origin,c=(0,s.b)(a.WM.get(),l,e.vector),u=t.origin,d=(0,s.b)(a.WM.get(),u,t.vector),h=a.WM.get(),f=a.WM.get();if(h[0]=l[0]-u[0],h[1]=l[1]-u[1],h[2]=l[2]-u[2],f[0]=d[0]-u[0],f[1]=d[1]-u[1],f[2]=d[2]-u[2],Math.abs(f[0])<o&&Math.abs(f[1])<o&&Math.abs(f[2])<o)return!1;const g=a.WM.get();if(g[0]=c[0]-l[0],g[1]=c[1]-l[1],g[2]=c[2]-l[2],Math.abs(g[0])<o&&Math.abs(g[1])<o&&Math.abs(g[2])<o)return!1;const p=h[0]*f[0]+h[1]*f[1]+h[2]*f[2],b=f[0]*g[0]+f[1]*g[1]+f[2]*g[2],v=h[0]*g[0]+h[1]*g[1]+h[2]*g[2],_=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],y=(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*_-b*b;if(Math.abs(y)<o)return!1;let m=(p*b-v*_)/y,w=(p+b*m)/_;i&&(m=(0,n.uZ)(m,0,1),w=(0,n.uZ)(w,0,1));const I=a.WM.get(),M=a.WM.get();return I[0]=l[0]+m*g[0],I[1]=l[1]+m*g[1],I[2]=l[2]+m*g[2],M[0]=u[0]+w*f[0],M[1]=u[1]+w*f[1],M[2]=u[2]+w*f[2],r.tA=m,r.tB=w,r.pA=I,r.pB=M,r.distance2=(0,s.h)(I,M),!0}const _={tA:0,tB:0,pA:(0,o.c)(),pB:(0,o.c)(),distance2:0},y=new r.x((()=>({origin:null,vector:null})))},55652:(e,t,i)=>{i.d(t,{$I:()=>g,Ac:()=>O,BR:()=>k,Er:()=>T,JG:()=>u,T5:()=>w,Ue:()=>l,Yq:()=>h,al:()=>d,dZ:()=>P,fn:()=>S,jH:()=>H,mJ:()=>W,my:()=>M,nF:()=>N,re:()=>c,rx:()=>C,tk:()=>I,zk:()=>f});var n=i(16889),r=i(92026),s=i(11186),o=i(71353),a=(i(23470),i(11185));function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A;return[e[0],e[1],e[2],e[3]]}function c(e,t,i,n){return d(e,t,i,n,a.o6.get())}function u(e,t){return d(t[0],t[1],t[2],t[3],e)}function d(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l();return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r}function h(e,t,i){const n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=-(i[0]*e[0]+i[1]*e[1]+i[2]*e[2]),i}function f(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l();const r=i[0]-t[0],s=i[1]-t[1],o=i[2]-t[2],a=e[0]-t[0],c=e[1]-t[1],u=e[2]-t[2],d=s*u-o*c,h=o*a-r*u,f=r*c-s*a,g=d*d+h*h+f*f,p=Math.abs(g-1)>1e-5&&g>1e-12?1/Math.sqrt(g):1;n[0]=d*p,n[1]=h*p,n[2]=f*p,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2])}function g(e,t,i,n,r){if(e.count<3)return!1;e.getVec(i,b);let o=n,a=!1;for(;o<e.count-1&&!a;)e.getVec(o,v),o++,a=!(0,s.k)(b,v);if(!a)return!1;for(o=Math.max(o,r),a=!1;o<e.count&&!a;)e.getVec(o,_),o++,(0,s.f)(y,b,v),(0,s.n)(y,y),(0,s.f)(m,v,_),(0,s.n)(m,m),a=!(0,s.k)(b,_)&&!(0,s.k)(v,_)&&Math.abs((0,s.d)(y,m))<p;return a?(f(b,v,_,t),!0):(0!==i||1!==n||2!==r)&&g(e,t,0,1,2)}const p=.99619469809,b=(0,o.c)(),v=(0,o.c)(),_=(0,o.c)(),y=(0,o.c)(),m=(0,o.c)();function w(e,t,i){return t!==e&&u(e,t),e[3]=-(0,s.d)(e,i),e}function I(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function M(e,t,i,n){return(0,s.c)(_,t,e),h(i,_,n)}function S(e,t,i,n){return E(e,t,(0,s.f)(a.WM.get(),i,t),z,n)}function k(e,t,i){return!!(0,r.pC)(t)&&E(e,t.origin,t.direction,x,i)}function C(e,t,i){return E(e,t.origin,t.vector,F.NONE,i)}function P(e,t,i){return E(e,t.origin,t.vector,F.CLAMP,i)}function O(e,t){return H(e,t)>=0}function T(e,t){const i=(0,s.d)(e,t.ray.direction),n=-H(e,t.ray.origin);if(i>-1e-6&&i<1e-6)return n>0;const r=n/i;return i>0?r<t.c1&&(t.c1=r):r>t.c0&&(t.c0=r),t.c0<=t.c1}function N(e,t,i){const n=(0,s.a)(a.WM.get(),e,-e[3]),r=function(e,t,i){const n=(0,s.a)(a.WM.get(),e,(0,s.d)(e,t));return(0,s.f)(i,t,n),i}(e,(0,s.f)(a.WM.get(),t,n),a.WM.get());return(0,s.b)(i,r,n),i}function H(e,t){return(0,s.d)(e,t)+e[3]}function E(e,t,i,r,o){const a=(0,s.d)(e,i);if(0===a)return!1;let l=-((0,s.d)(e,t)+e[3])/a;return r&F.CLAMP&&(l=(0,n.uZ)(l,0,1)),!(!(r&F.INFINITE_MIN)&&l<0||!(r&F.INFINITE_MAX)&&l>1)&&((0,s.b)(o,t,(0,s.a)(o,i,l)),!0)}function W(e){return e}const A=[0,0,1,0];var F,R;(R=F||(F={}))[R.NONE=0]="NONE",R[R.CLAMP=1]="CLAMP",R[R.INFINITE_MIN=4]="INFINITE_MIN",R[R.INFINITE_MAX=8]="INFINITE_MAX";const z=F.INFINITE_MIN|F.INFINITE_MAX,x=F.INFINITE_MAX},40885:(e,t,i)=>{i.d(t,{JG:()=>c,JI:()=>f,Jk:()=>h,Ue:()=>a,re:()=>l,zk:()=>u});i(63780);var n=i(21530),r=i(11186),s=i(71353),o=i(11185);function a(e){return e?{origin:(0,s.a)(e.origin),direction:(0,s.a)(e.direction)}:{origin:(0,s.c)(),direction:(0,s.c)()}}function l(e,t){const i=g.get();return i.origin=e,i.direction=t,i}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a();return d(e.origin,e.direction,t)}function u(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();return(0,r.g)(i.origin,e),(0,r.f)(i.direction,t,e),i}function d(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();return(0,r.g)(i.origin,e),(0,r.g)(i.direction,t),i}function h(e,t){const i=(0,r.c)(o.WM.get(),(0,r.n)(o.WM.get(),e.direction),(0,r.f)(o.WM.get(),t,e.origin));return(0,r.d)(i,i)}function f(e,t,i){const n=(0,r.d)(e.direction,(0,r.f)(i,t,e.origin));return(0,r.b)(i,e.origin,(0,r.a)(i,e.direction,n)),i}const g=new n.x((function(){return{origin:null,direction:null}}))},40927:(e,t,i)=>{i.d(t,{EU:()=>l,SR:()=>a,cp:()=>c,nF:()=>o});var n=i(16889),r=i(11186),s=i(71353);function o(e,t,i){const n=(0,r.d)(e,t)/(0,r.d)(e,e);return(0,r.a)(i,e,n)}function a(e,t){return(0,r.d)(e,t)/(0,r.l)(e)}function l(e,t){const i=(0,r.d)(e,t)/((0,r.l)(e)*(0,r.l)(t));return-(0,n.ZF)(i)}function c(e,t,i){(0,r.n)(u,e),(0,r.n)(d,t);const s=(0,r.d)(u,d),o=(0,n.ZF)(s),a=(0,r.c)(u,u,d);return(0,r.d)(a,i)<0?2*Math.PI-o:o}const u=(0,s.c)(),d=(0,s.c)()},11185:(e,t,i)=>{i.d(t,{MP:()=>b,vD:()=>v,qW:()=>f,WM:()=>g,o6:()=>p});var n=i(59896),r=i(70758),s=i(11873),o=i(81949),a=i(98131),l=i(6394),c=i(71353),u=i(67077);class d{constructor(e,t,i){this.itemByteSize=e,this.itemCreate=t,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(i/this.itemByteSize)}get(){0===this._itemsPtr&&(0,r.Y)((()=>this._reset()));const e=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=e;){const e=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize);for(let t=0;t<this._itemsPerBuffer;++t)this._items.push(this.itemCreate(e,t*this.itemByteSize));this._buffers.push(e)}return this._items[this._itemsPtr++]}_reset(){const e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new d(16,l.c,e)}static createVec3f64(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new d(24,c.b,e)}static createVec4f64(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new d(32,u.a,e)}static createMat3f64(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new d(72,s.a,e)}static createMat4f64(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new d(128,o.a,e)}static createQuatf64(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new d(32,a.c,e)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}const h=4*n.Y8.KILOBYTES,f=d.createVec2f64(),g=d.createVec3f64(),p=d.createVec4f64(),b=(d.createMat3f64(),d.createMat4f64()),v=d.createQuatf64()},84134:(e,t,i)=>{i.r(t),i.d(t,{FeatureServiceSnappingSource:()=>q});var n=i(27366),r=i(85015),s=i(41691),o=i(42537),a=i(92026),l=i(94172),c=i(49861),u=(i(63780),i(93169),i(25243),i(69912)),d=i(11186),h=i(67077),f=i(82218);function g(e,t){return(0,f.h)(t.extent,p),(0,f.g)(p,(0,d.s)(b,e.x,e.y,0))}const p=(0,f.c)(),b=(0,h.c)();var v=i(69787);let _=class extends((0,s.p)(r.Z)){constructor(e){super(e),this.pointOfInterest=null}get tiles(){const e=this.tilesCoveringView,t=(0,a.pC)(this.pointOfInterest)?this.pointOfInterest:this.view.center;return e.sort(((e,i)=>g(t,e)-g(t,i))),e}_scaleEnabled(){return(0,v.rs)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}get tilesCoveringView(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||(0,a.Wi)(this.tileInfo))return[];if(!this._scaleEnabled)return[];const{spans:e,lodInfo:t}=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),{level:i}=t,n=[];for(const{row:r,colFrom:s,colTo:o}of e)for(let e=s;e<=o;e++){const s={id:null,level:i,row:r,col:t.normalizeCol(e)};this.tileInfo.updateTileInfo(s),n.push(s)}return n}get tileInfo(){var e,t;return null!=(e=null==(t=this.view.featuresTilingScheme)?void 0:t.tileInfo)?e:null}get tileSize(){return(0,a.pC)(this.tileInfo)?this.tileInfo.size[0]:256}initialize(){this.handles.add(this.watch("view.state.viewpoint",(()=>this.notifyChange("tilesCoveringView")),!0))}};(0,n._)([(0,c.Cb)({readOnly:!0})],_.prototype,"tiles",null),(0,n._)([(0,c.Cb)({readOnly:!0})],_.prototype,"_scaleEnabled",null),(0,n._)([(0,c.Cb)({readOnly:!0})],_.prototype,"tilesCoveringView",null),(0,n._)([(0,c.Cb)({readOnly:!0})],_.prototype,"tileInfo",null),(0,n._)([(0,c.Cb)({readOnly:!0})],_.prototype,"tileSize",null),(0,n._)([(0,c.Cb)({constructOnly:!0})],_.prototype,"view",void 0),(0,n._)([(0,c.Cb)({constructOnly:!0})],_.prototype,"layer",void 0),(0,n._)([(0,c.Cb)()],_.prototype,"pointOfInterest",void 0),_=(0,n._)([(0,u.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],_);var y,m=i(8537),w=i(65156);!function(e){e[e.INVISIBLE=0]="INVISIBLE",e[e.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",e[e.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"}(y||(y={}));let I=class extends s.r{constructor(e){super(e),this.pointOfInterest=null}get tiles(){const e=this.tilesCoveringView,t=this.effectivePointOfInterest;if((0,a.pC)(t)){const i=e.map((e=>g(t,e)));for(let n=1;n<i.length;n++)if(i[n-1]>i[n])return e.sort(((e,i)=>g(t,e)-g(t,i))),e.slice()}return e}get tilesCoveringView(){var e,t;return this._filterTiles(null==(e=this.view.featureTiles)||null==(t=e.tiles)?void 0:t.toArray()).map(M)}get tileInfo(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tilingScheme.toTileInfo())?e:null}get tileSize(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tileSize)?e:256}get effectivePointOfInterest(){var e;const t=this.pointOfInterest;return(0,a.pC)(t)?t:null==(e=this.view.pointsOfInterest)?void 0:e.focus.location}initialize(){this.handles.add((0,m.S1)(this.view,"featureTiles",(e=>{this.handles.remove(k),e&&this.handles.add(e.addClient(),k)})))}_filterTiles(e){return(0,a.Wi)(e)?[]:e.filter((e=>Math.abs(e.measures.screenRect[3]-e.measures.screenRect[1])>S&&e.measures.visibility===y.VISIBLE_ON_SURFACE))}};function M(e){let{lij:[t,i,n],extent:r}=e;return{id:`${t}/${i}/${n}`,level:t,row:i,col:n,extent:r}}(0,n._)([(0,c.Cb)({readOnly:!0})],I.prototype,"tiles",null),(0,n._)([(0,c.Cb)({readOnly:!0})],I.prototype,"tilesCoveringView",null),(0,n._)([(0,c.Cb)({readOnly:!0})],I.prototype,"tileInfo",null),(0,n._)([(0,c.Cb)({readOnly:!0})],I.prototype,"tileSize",null),(0,n._)([(0,c.Cb)({constructOnly:!0})],I.prototype,"view",void 0),(0,n._)([(0,c.Cb)()],I.prototype,"pointOfInterest",void 0),(0,n._)([(0,c.Cb)()],I.prototype,"effectivePointOfInterest",null),I=(0,n._)([(0,u.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],I);const S=50,k="feature-tiles";var C=i(69117),P=i(100),O=i(80885),T=i(51995),N=i(52639),H=i(16889),E=i(62554),W=i(61459),A=i(58009),F=i(87037);const R=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]];let z=class extends r.Z{constructor(e){super(e),this.updating=!1,this.enablePolygons=!0,this.enableLabels=!0,this._polygons=new Map,this._labels=new Map,this._enabled=!0}initialize(){this._symbols=R.map((e=>new W.Z({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}}))),this.update()}destroy(){this._enabled=!1,this.clear()}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this.update())}update(){if(!this._enabled)return void this.clear();const e=this.getTiles(),t=new Array,i=new Set((this._labels.size,this._labels.keys()));e.forEach(((n,r)=>{const s=n.lij.toString();i.delete(s);const o=n.lij[0],l=n.geometry;if(this.enablePolygons&&!this._polygons.has(s)){const e=new N.Z({geometry:l,symbol:this._symbols[o%this._symbols.length]});this._polygons.set(s,e),t.push(e)}if(this.enableLabels){const i=(e=>{if((0,a.pC)(e.label))return e.label;let t=e.lij.toString();return(0,a.pC)(e.loadPriority)&&(t+=` (${e.loadPriority})`),t})(n),o=r/(e.length-1),c=(0,H.t7)(0,200,o),u=(0,H.t7)(20,6,o)/.75,d=(0,a.pC)(n.loadPriority)&&n.loadPriority>=e.length,h=new T.Z([c,d?0:c,d?0:c]),f="3d"===this.view.type?()=>new E.Z({verticalOffset:{screenLength:40/.75},callout:{type:"line",color:"white",border:{color:"black"}},symbolLayers:[new F.Z({text:i,halo:{color:"white",size:1/.75},material:{color:h},size:u})]}):()=>new A.Z({text:i,haloColor:"white",haloSize:1/.75,color:h,size:u});if(this._labels.has(s)){const e=this._labels.get(s),t=f();((0,a.Wi)(e.symbol)||JSON.stringify(t)!==JSON.stringify(e.symbol))&&(e.symbol=t)}else{const e=new N.Z({geometry:l.extent.center,symbol:f()});this._labels.set(s,e),t.push(e)}}}));const n=new Array;i.forEach((e=>{this._polygons.has(e)&&(n.push(this._polygons.get(e)),this._polygons.delete(e)),this._labels.has(e)&&(n.push(this._labels.get(e)),this._labels.delete(e))})),this.view.graphics.removeMany(n),this.view.graphics.addMany(t)}clear(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}};(0,n._)([(0,c.Cb)({constructOnly:!0})],z.prototype,"view",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],z.prototype,"updating",void 0),(0,n._)([(0,c.Cb)()],z.prototype,"enabled",null),z=(0,n._)([(0,u.j)("esri.views.support.TileTreeDebugger")],z);let x=class extends z{constructor(e){super(e),this.handles=new P.Z}initialize(){const e=setInterval((()=>this._fetchDebugInfo()),2e3);this.handles.add((0,o.kB)((()=>clearInterval(e))))}destroy(){this.handles.destroy()}getTiles(){if(!this.debugInfo)return[];const e=new Map,t=new Map;this.debugInfo.storedTiles.forEach((t=>{e.set(t.data.id,t.featureCount)})),this.debugInfo.pendingTiles.forEach((i=>{e.set(i.data.id,i.featureCount),t.set(i.data.id,i.state)}));const i=i=>{var n;const r=t.get(i),s=null!=(n=e.get(i))?n:"?";return r?`${r}:${s}\n${i}`:`store:${s}\n${i}`},n=new Map;return this.debugInfo.storedTiles.forEach((e=>{n.set(e.data.id,e.data)})),this.debugInfo.pendingTiles.forEach((e=>{n.set(e.data.id,e.data)})),Array.from(n.values()).map((e=>({lij:[e.level,e.row,e.col],geometry:O.Z.fromExtent((0,w.HH)(e.extent,this.view.spatialReference)),label:i(e.id)})))}_fetchDebugInfo(){this.handle.getDebugInfo(null).then((e=>{this.debugInfo=e,this.update()}))}};(0,n._)([(0,c.Cb)({constructOnly:!0})],x.prototype,"handle",void 0),x=(0,n._)([(0,u.j)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],x);var V=i(66978),Z=i(46798),j=i(27823);let B=class extends s.r{constructor(e){super(e),this.availability=0,this.workerHandleUpdating=!0,this.editId=0}get updating(){return this.updatingHandles.updating||this.workerHandleUpdating}destroy(){this.workerHandle.destroy()}initialize(){this.workerHandle=new L(this.schedule),this.handles.add([this.workerHandle.on("notify-updating",(e=>{let{updating:t}=e;return this.workerHandleUpdating=t})),this.workerHandle.on("notify-availability",(e=>{let{availability:t}=e;return this._set("availability",t)}))])}async setup(e,t){const i=this._serviceInfoFromLayer(e.layer);if((0,a.Wi)(i))return;const n={configuration:this._convertConfiguration(e.configuration),serviceInfo:i,spatialReference:e.spatialReference.toJSON()};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("setup",n,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}async configure(e,t){const i=this._convertConfiguration(e);await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("configure",i,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}async refresh(e){await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("refresh",{},e)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},e))}async fetchCandidates(e,t){const i={distance:e.distance,point:e.coordinateHelper.vectorToPoint(e.point).toJSON(),types:e.types,filter:(0,a.pC)(e.filter)?e.filter.createQuery().toJSON():null};return this.workerHandle.invoke(i,t)}async updateTiles(e,t){const i={tiles:e.tiles,tileInfo:(0,a.pC)(e.tileInfo)?e.tileInfo.toJSON():null,tileSize:e.tileSize};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("updateTiles",i,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}async applyEdits(e,t){var i,n,r,s,o,a;const l=this.editId++,c={id:l};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("beginApplyEdits",c,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t));const u=await this.updatingHandles.addPromise((0,V.Hl)(e.result,t)),d={id:l,edits:{addedFeatures:null!=(i=null==(n=u.addedFeatures)?void 0:n.map((e=>{let{objectId:t}=e;return t})))?i:[],deletedFeatures:null!=(r=null==(s=u.deletedFeatures)?void 0:s.map((e=>{let{objectId:t,globalId:i}=e;return{objectId:t,globalId:i}})))?r:[],updatedFeatures:null!=(o=null==(a=u.updatedFeatures)?void 0:a.map((e=>{let{objectId:t}=e;return t})))?o:[]}};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("endApplyEdits",d,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}getDebugInfo(e){return this.workerHandle.invokeMethod("getDebugInfo",{},e)}_convertConfiguration(e){return{filter:(0,a.pC)(e.filter)?e.filter.toJSON():null,customParameters:e.customParameters}}_serviceInfoFromLayer(e){var t;return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl.path,fields:e.fields.map((e=>e.toJSON())),geometryType:j.Mk.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:null==(t=e.timeInfo)?void 0:t.toJSON()}}};(0,n._)([(0,c.Cb)({constructOnly:!0})],B.prototype,"schedule",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],B.prototype,"updating",null),(0,n._)([(0,c.Cb)({readOnly:!0})],B.prototype,"availability",void 0),(0,n._)([(0,c.Cb)()],B.prototype,"workerHandleUpdating",void 0),B=(0,n._)([(0,u.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],B);class L extends Z.q{constructor(e){super("FeatureServiceSnappingSourceWorker","fetchCandidates",e,{strategy:"dedicated"})}getTransferList(){return[]}}var U=i(7882),J=i(59068),D=i(22824);let Y=class extends r.Z{constructor(e){super(e),this.pointOfInterest=null}get tiles(){return[{id:"0/0/0",level:0,row:0,col:0,extent:(0,w.al)(-1e8,-1e8,1e8,1e8)}]}get tileInfo(){return new D.Z({origin:new U.Z({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new J.Z({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}get tileSize(){return this.tileInfo.size[0]}};(0,n._)([(0,c.Cb)({readOnly:!0})],Y.prototype,"tiles",null),(0,n._)([(0,c.Cb)({readOnly:!0})],Y.prototype,"tileInfo",null),(0,n._)([(0,c.Cb)({readOnly:!0})],Y.prototype,"tileSize",null),(0,n._)([(0,c.Cb)({constructOnly:!0})],Y.prototype,"layer",void 0),(0,n._)([(0,c.Cb)()],Y.prototype,"pointOfInterest",void 0),Y=(0,n._)([(0,u.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],Y);var X=i(32609);let q=class extends((0,s.p)(r.Z)){constructor(e){super(e)}get updateTilesParameters(){return{tiles:this.tilesOfInterest.tiles,tileInfo:this.tilesOfInterest.tileInfo,tileSize:this.tilesOfInterest.tileSize}}get updating(){return this.workerHandle.updating||this.updatingHandles.updating}get configuration(){return{filter:this.layer.createQuery(),customParameters:this.layer.customParameters}}get availability(){return this.workerHandle.availability}get layer(){return this.layerSource.layer}initialize(){const e=this.view;if((0,a.pC)(e))switch(e.type){case"2d":this.tilesOfInterest=new _({view:e,layer:this.layer}),this.workerHandle=new B;break;case"3d":{const t=e.resourceController;this.tilesOfInterest=new I({view:e}),this.workerHandle=new B({schedule:e=>t.schedule(e)});break}}else this.tilesOfInterest=new Y({layer:this.layer}),this.workerHandle=new B;this.handles.add([(0,o.ed)(this.workerHandle)]),this.workerHandle.setup({layer:this.layer,spatialReference:this.spatialReference,configuration:this.configuration},null),this.updatingHandles.add((()=>this.updateTilesParameters),(()=>this.workerHandle.updateTiles(this.updateTilesParameters,null)),l.nn),this.handles.add([(0,l.YP)((()=>this.configuration),(e=>this.workerHandle.configure(e,null)),l.Z_)]),(0,a.pC)(e)&&this.handles.add((0,l.YP)((()=>X.Z.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES),(t=>{t&&!this.debug?(this.debug=new x({view:e,handle:this.workerHandle}),this.handles.add((0,o.ed)(this.debug),"debug")):!t&&this.debug&&this.handles.remove("debug")}),l.nn)),this.handles.add(this.layerSource.layer.on("apply-edits",(e=>{this.workerHandle.applyEdits(e,null)})))}refresh(){this.workerHandle.refresh(null)}async fetchCandidates(e,t){return this.tilesOfInterest.pointOfInterest=e.coordinateHelper.vectorToPoint(e.point),(await this.workerHandle.fetchCandidates({...e,filter:null},t)).candidates.map((t=>(0,C.X)(t,e.coordinateHelper)))}getDebugInfo(e){return this.workerHandle.getDebugInfo(e)}};(0,n._)([(0,c.Cb)({constructOnly:!0})],q.prototype,"spatialReference",void 0),(0,n._)([(0,c.Cb)({constructOnly:!0})],q.prototype,"layerSource",void 0),(0,n._)([(0,c.Cb)({constructOnly:!0})],q.prototype,"view",void 0),(0,n._)([(0,c.Cb)()],q.prototype,"tilesOfInterest",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],q.prototype,"updateTilesParameters",null),(0,n._)([(0,c.Cb)({readOnly:!0})],q.prototype,"updating",null),(0,n._)([(0,c.Cb)({readOnly:!0})],q.prototype,"configuration",null),(0,n._)([(0,c.Cb)({readOnly:!0})],q.prototype,"availability",null),q=(0,n._)([(0,u.j)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],q)},69117:(e,t,i)=>{i.d(t,{X:()=>l});var n=i(95905),r=i(95122),s=i(75691),o=i(61309);class a extends s.a{constructor(e){super({...e,constraint:new r.Hk(e.coordinateHelper,e.targetPoint)})}get hints(){return[new o.n(this.targetPoint)]}}function l(e,t){switch(e.type){case"edge":return new n.L({coordinateHelper:t,edgeStart:t.pointToVector(e.start),edgeEnd:t.pointToVector(e.end),targetPoint:t.pointToVector(e.target),objectId:e.objectId});case"vertex":return new a({coordinateHelper:t,targetPoint:t.pointToVector(e.target),objectId:e.objectId})}}},61309:(e,t,i)=>{i.d(t,{n:()=>s});var n=i(64674),r=i(55054);class s extends r.r{constructor(e){super(),this.point=e}equals(e){return e instanceof s&&(0,n.Xv)(this.point,e.point)}}}}]);
//# sourceMappingURL=4134.f2c30fc7.chunk.js.map