{"version":3,"file":"static/js/7775.b18f4d87.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js","../node_modules/@arcgis/core/layers/support/TilemapCache.js","../node_modules/@arcgis/core/layers/support/Tilemap.js","../node_modules/@arcgis/core/layers/support/serviceTileInfoProperty.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{serviceTileInfoProperty as i}from\"../support/serviceTileInfoProperty.js\";import{TilemapCache as p}from\"../support/TilemapCache.js\";import a from\"../../geometry/SpatialReference.js\";const s=s=>{let l=class extends s{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf(\"Tilemap\")>-1?new p({layer:this}):null}};return e([r({json:{read:{source:\"copyrightText\"}}})],l.prototype,\"copyright\",void 0),e([r()],l.prototype,\"minScale\",void 0),e([o(\"service\",\"minScale\")],l.prototype,\"readMinScale\",null),e([r()],l.prototype,\"maxScale\",void 0),e([o(\"service\",\"maxScale\")],l.prototype,\"readMaxScale\",null),e([r({type:a})],l.prototype,\"spatialReference\",void 0),e([r({readOnly:!0})],l.prototype,\"supportsBlankTile\",null),e([r(i)],l.prototype,\"tileInfo\",void 0),e([r()],l.prototype,\"tilemapCache\",void 0),e([o(\"service\",\"tilemapCache\",[\"capabilities\"])],l.prototype,\"readTilemapCache\",null),e([r()],l.prototype,\"version\",void 0),l=e([t(\"esri.layers.mixins.ArcGISCachedService\")],l),l};export{s as ArcGISCachedService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import i from\"../../core/Accessor.js\";import r from\"../../core/Error.js\";import{HandleOwnerMixin as l}from\"../../core/HandleOwner.js\";import s from\"../../core/Logger.js\";import a from\"../../core/LRUCache.js\";import o from\"../../core/PooledArray.js\";import{onAbort as n,isAbortError as c,isAborted as h,createAbortError as p}from\"../../core/promiseUtils.js\";import{waitTicks as m}from\"../../core/scheduling.js\";import{objectToQuery as u}from\"../../core/urlUtils.js\";import{init as f}from\"../../core/watchUtils.js\";import{property as v}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{cast as y}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as b}from\"../../core/accessorSupport/decorators/subclass.js\";import{tilemapDefinitionId as d,Tilemap as _}from\"./Tilemap.js\";var g;const w=s.getLogger(\"esri.layers.support.TilemapCache\");let T=g=class extends(l(i)){constructor(e){super(e),this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=t,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new a(this.cacheByteSize),this.handles.add([this.watch([\"layer.parsedUrl\",\"layer.tileServers?\",\"layer.apiKey?\",\"layer.customParameters?\"],(()=>this._initializeTilemapDefinition())),f(this,\"layer.tileInfo.lods\",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition()}castLevels(e){return e<=2?(w.error(\"Minimum levels for Tilemap is 3, but got \",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,l){if(!this._availableLevels[e])return Promise.reject(new r(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const s=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,i,s);if(a)return Promise.resolve(a);const o=l&&l.signal;return l={...l,signal:null},new Promise(((e,t)=>{n(o,(()=>t(p())));const i=d(s);let r=this._pendingTilemapRequests[i];if(!r){r=_.fromDefinition(s,l).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=r,r.then(e,e)}r.then(e,t)}))}getAvailability(e,t,i){if(!this._availableLevels[e])return\"unavailable\";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):\"unknown\"}fetchAvailability(e,t,i,l){return this._availableLevels[e]?this.fetchTilemap(e,t,i,l).catch((e=>e)).then((l=>{if(l instanceof _){const s=l.getAvailability(t,i);return\"unavailable\"===s?Promise.reject(new r(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):s}if(c(l))throw l;return\"unknown\"})):Promise.reject(new r(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,r,l){r.level=e,r.row=t,r.col=i;const s=this.layer.tileInfo;s.updateTileInfo(r);const a=this.fetchAvailability(e,t,i,l).catch((e=>{if(c(e))throw e;if(s.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r);throw e}));return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,l,a),a}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,l,s){if(!this._prefetchingEnabled)return;const a=`prefetch-${e}`;if(this.handles.has(a))return;const o=new AbortController;s.then((()=>o.abort()),(()=>o.abort()));let n=!1;const c={remove(){n||(n=!0,o.abort())}};if(this.handles.add(c,a),await m(10,o.signal).catch((()=>{})),n||(n=!0,this.handles.remove(a)),h(o))return;const p={id:e,level:t,row:i,col:r},u={...l,signal:o.signal},f=this.layer.tileInfo;for(let h=0;g._prefetches.length<g._maxPrefetch&&f.upsampleTile(p);++h){const e=this.fetchAvailability(p.level,p.row,p.col,u);g._prefetches.push(e);const t=()=>{g._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){var e;if(!this.layer.parsedUrl)return;const{parsedUrl:t,apiKey:i,customParameters:r}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:t.path,query:u({...t.query,...r,token:null!=i?i:null==(e=t.query)?void 0:e.token}),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const l=d(r);return this._tilemapCache.get(l)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0))}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,r)=>!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}};T._maxPrefetch=4,T._prefetches=new o({initialSize:g._maxPrefetch}),e([v({constructOnly:!0,type:Number})],T.prototype,\"levels\",void 0),e([y(\"levels\")],T.prototype,\"castLevels\",null),e([v({readOnly:!0,type:Number})],T.prototype,\"size\",null),e([v({constructOnly:!0,type:Number})],T.prototype,\"cacheByteSize\",void 0),e([v({constructOnly:!0})],T.prototype,\"layer\",void 0),e([v({constructOnly:!0})],T.prototype,\"request\",void 0),T=g=e([b(\"esri.layers.support.TilemapCache\")],T);export{T as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import{constant as i}from\"../../core/arrayUtils.js\";import e from\"../../core/Error.js\";import{clone as a}from\"../../core/lang.js\";class l{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability=\"unknown\",this.byteSize=40}getAvailability(t,i){if(\"unknown\"!==this._allAvailability)return this._allAvailability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%8,l=e>>3,o=this._tileAvailabilityBitSet;return l<0||l>o.length?\"unknown\":o[l]&1<<a?\"available\":\"unavailable\"}_updateFromData(t){const i=this.location.width,e=this.location.height;let a=!0,l=!0;const o=Math.ceil(i*e/8),n=new Uint8Array(o);let r=0;for(let s=0;s<t.length;s++){const i=s%8;t[s]?(l=!1,n[r]|=1<<i):a=!1,7===i&&++r}l?this._allAvailability=\"unavailable\":a?this._allAvailability=\"available\":(this._allAvailability=\"unknown\",this._tileAvailabilityBitSet=n,this.byteSize+=n.length)}static fromDefinition(a,o){const r=a.service.request||t,{row:s,col:h,width:c,height:m}=a,d={query:{f:\"json\"}};return o=o?{...d,...o}:d,r(n(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:s,left:h,width:c,height:m},valid:!0,data:i(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new e(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:s,left:h,width:c,height:m}});return l.fromJSON(t)}))}static fromJSON(t){l.validateJSON(t);const i=new l;return i.location=Object.freeze(a(t.location)),i._updateFromData(t.data),Object.freeze(i)}static validateJSON(t){if(!t||!t.location)throw new e(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new e(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new e(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new e(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new e(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function o(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n(t){let i;if(\"vector-tile\"===t.service.type)i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;else{const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}const e=t.service.query;return e&&(i=`${i}?${e}`),i}export{l as Tilemap,l as default,o as tilemapDefinitionId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport e from\"./TileInfo.js\";const r={type:e,json:{origins:{service:{read:{source:[\"tileInfo\",\"minScale\",\"maxScale\",\"minLOD\",\"maxLOD\"],reader:n}}}}};function n(r,n,l,o){if(!r)return null;const{minScale:i,maxScale:t,minLOD:m,maxLOD:s}=n;if(null!=m&&null!=s)return o&&o.ignoreMinMaxLOD?e.fromJSON(r):e.fromJSON({...r,lods:r.lods.filter((({level:e})=>null!=e&&e>=m&&e<=s))});if(0!==i&&0!==t){const n=e=>Math.round(1e4*e)/1e4,l=i?n(i):1/0,o=t?n(t):-1/0;return e.fromJSON({...r,lods:r.lods.filter((e=>{const r=n(e.scale);return r<=l&&r>=o}))})}return e.fromJSON(r)}export{n as readServiceTileInfo,r as serviceTileInfoProperty};\n"],"names":["s","l","arguments","copyright","minScale","maxScale","spatialReference","tileInfo","tilemapCache","e","r","minLOD","maxLOD","this","version","capabilities","indexOf","p","layer","json","read","source","prototype","o","type","a","readOnly","i","t","g","location","left","top","width","height","_allAvailability","byteSize","_tileAvailabilityBitSet","length","Math","ceil","n","Uint8Array","service","request","row","h","col","c","m","d","query","f","url","level","tileServers","then","data","catch","details","httpStatus","valid","response","definition","fromJSON","validateJSON","Object","freeze","_updateFromData","Array","isArray","w","T","_pendingTilemapRequests","_availableLevels","levels","cacheByteSize","_prefetchingEnabled","_tilemapCache","handles","add","watch","_initializeTilemapDefinition","_initializeAvailableLevels","error","Promise","reject","_tmpTilemapDefinition","_tilemapFromCache","resolve","signal","_","put","getAvailability","fetchTilemap","updateTileInfo","fetchAvailability","upsampleTile","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","id","has","AbortController","abort","remove","u","_prefetches","push","removeUnordered","_maxPrefetch","parsedUrl","apiKey","customParameters","clear","path","token","size","get","forEach","prefetchingEnabled","hasTilemap","initialSize","v","constructOnly","Number","y","b","origins","reader","ignoreMinMaxLOD","lods","filter","round","scale"],"sourceRoot":""}