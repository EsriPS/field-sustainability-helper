"use strict";(self.webpackChunkfield_sustainability_helper=self.webpackChunkfield_sustainability_helper||[]).push([[2490,2463,2170],{92463:function(e,t,n){n.r(t),n.d(t,{hydratedAdapter:function(){return u}});var r=n(53866),i=n(77577),a=n(7882),o=n(80885),s=n(29909),u={convertToGEGeometry:function(e,t){if(null==t)return null;var n="cache"in t?t.cache._geVersion:void 0;return null==n&&(n=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=n)),n},exportPoint:function(e,t,n){var r=e.hasZ(t),i=e.hasM(t),o=new a.Z({x:e.getPointX(t),y:e.getPointY(t),spatialReference:n});return r&&(o.z=e.getPointZ(t)),i&&(o.m=e.getPointM(t)),o.cache._geVersion=t,o},exportPolygon:function(e,t,n){var r=new o.Z({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:n});return r.cache._geVersion=t,r},exportPolyline:function(e,t,n){var r=new s.Z({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:n});return r.cache._geVersion=t,r},exportMultipoint:function(e,t,n){var r=new i.Z({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:n});return r.cache._geVersion=t,r},exportExtent:function(e,t,n){var i=e.hasZ(t),a=e.hasM(t),o=new r.Z({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:n});if(i){var s=e.getZExtent(t);o.zmin=s.vmin,o.zmax=s.vmax}if(a){var u=e.getMExtent(t);o.mmin=u.vmin,o.mmax=u.vmax}return o.cache._geVersion=t,o}}},2170:function(e,t,n){n.r(t),n.d(t,{buffer:function(){return T},clip:function(){return s},contains:function(){return c},convexHull:function(){return w},crosses:function(){return l},cut:function(){return u},densify:function(){return D},difference:function(){return k},disjoint:function(){return y},distance:function(){return p},equals:function(){return h},extendedSpatialReferenceInfo:function(){return o},flipHorizontal:function(){return A},flipVertical:function(){return G},generalize:function(){return P},geodesicArea:function(){return F},geodesicBuffer:function(){return V},geodesicDensify:function(){return W},geodesicLength:function(){return L},intersect:function(){return b},intersects:function(){return d},isSimple:function(){return x},nearestCoordinate:function(){return Z},nearestVertex:function(){return E},nearestVertices:function(){return O},offset:function(){return M},overlaps:function(){return m},planarArea:function(){return z},planarLength:function(){return H},relate:function(){return g},rotate:function(){return I},simplify:function(){return _},symmetricDifference:function(){return C},touches:function(){return f},union:function(){return S},within:function(){return v}});var r=n(99058),i=n(92463);function a(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function o(e){return r.G.extendedSpatialReferenceInfo(e)}function s(e,t){return r.G.clip(i.hydratedAdapter,a(e),e,t)}function u(e,t){return r.G.cut(i.hydratedAdapter,a(e),e,t)}function c(e,t){return r.G.contains(i.hydratedAdapter,a(e),e,t)}function l(e,t){return r.G.crosses(i.hydratedAdapter,a(e),e,t)}function p(e,t,n){return r.G.distance(i.hydratedAdapter,a(e),e,t,n)}function h(e,t){return r.G.equals(i.hydratedAdapter,a(e),e,t)}function d(e,t){return r.G.intersects(i.hydratedAdapter,a(e),e,t)}function f(e,t){return r.G.touches(i.hydratedAdapter,a(e),e,t)}function v(e,t){return r.G.within(i.hydratedAdapter,a(e),e,t)}function y(e,t){return r.G.disjoint(i.hydratedAdapter,a(e),e,t)}function m(e,t){return r.G.overlaps(i.hydratedAdapter,a(e),e,t)}function g(e,t,n){return r.G.relate(i.hydratedAdapter,a(e),e,t,n)}function x(e){return r.G.isSimple(i.hydratedAdapter,a(e),e)}function _(e){return r.G.simplify(i.hydratedAdapter,a(e),e)}function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.G.convexHull(i.hydratedAdapter,a(e),e,t)}function k(e,t){return r.G.difference(i.hydratedAdapter,a(e),e,t)}function C(e,t){return r.G.symmetricDifference(i.hydratedAdapter,a(e),e,t)}function b(e,t){return r.G.intersect(i.hydratedAdapter,a(e),e,t)}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r.G.union(i.hydratedAdapter,a(e),e,t)}function M(e,t,n,o,s,u){return r.G.offset(i.hydratedAdapter,a(e),e,t,n,o,s,u)}function T(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r.G.buffer(i.hydratedAdapter,a(e),e,t,n,o)}function V(e,t,n,o,s,u){return r.G.geodesicBuffer(i.hydratedAdapter,a(e),e,t,n,o,s,u)}function Z(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r.G.nearestCoordinate(i.hydratedAdapter,a(e),e,t,n)}function E(e,t){return r.G.nearestVertex(i.hydratedAdapter,a(e),e,t)}function O(e,t,n,o){return r.G.nearestVertices(i.hydratedAdapter,a(e),e,t,n,o)}function R(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent.center:null}function I(e,t,n){var i;if(null==e)throw new Error("Illegal Argument Exception");var a=e.spatialReference;if(null==(n=null!=(i=n)?i:R(e)))throw new Error("Illegal Argument Exception");var o=e.constructor.fromJSON(r.G.rotate(e,t,n));return o.spatialReference=a,o}function A(e,t){var n;if(null==e)throw new Error("Illegal Argument Exception");var i=e.spatialReference;if(null==(t=null!=(n=t)?n:R(e)))throw new Error("Illegal Argument Exception");var a=e.constructor.fromJSON(r.G.flipHorizontal(e,t));return a.spatialReference=i,a}function G(e,t){var n;if(null==e)throw new Error("Illegal Argument Exception");var i=e.spatialReference;if(null==(t=null!=(n=t)?n:R(e)))throw new Error("Illegal Argument Exception");var a=e.constructor.fromJSON(r.G.flipVertical(e,t));return a.spatialReference=i,a}function P(e,t,n,o){return r.G.generalize(i.hydratedAdapter,a(e),e,t,n,o)}function D(e,t,n){return r.G.densify(i.hydratedAdapter,a(e),e,t,n)}function W(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r.G.geodesicDensify(i.hydratedAdapter,a(e),e,t,n,o)}function z(e,t){return r.G.planarArea(i.hydratedAdapter,a(e),e,t)}function H(e,t){return r.G.planarLength(i.hydratedAdapter,a(e),e,t)}function F(e,t,n){return r.G.geodesicArea(i.hydratedAdapter,a(e),e,t,n)}function L(e,t,n){return r.G.geodesicLength(i.hydratedAdapter,a(e),e,t,n)}},77566:function(e,t,n){n.d(t,{T:function(){return j},I:function(){return K}});var r=n(1413),i=n(15671),a=n(43144),o=n(60136),s=n(29388),u=n(27366),c=n(52639),l=(n(93169),n(91505)),p=n(41691),h=n(42537),d=n(92026),f=n(49861),v=n(63780),y=(n(25243),n(69912)),m=n(93655),g=(n(59486),n(84652)),x=n(68860),_=n(1587),w=n(2170),k=n(69662),C=n(92975),b=n(22018),S=n(89494),M=n(48976),T=n(98131),V=n(11186),Z=n(71353),E=n(7882);function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,d.pC)(n)?[e,t,n]:[e,t]}function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,d.pC)(n)?{x:e,y:t,z:n}:{x:e,y:t}}var I=function(){function e(t){(0,i.Z)(this,e),this.spatialReference=t}return(0,a.Z)(e,[{key:"mapToLocalMultiple",value:function(e){var t=this;return(0,d.lV)(e.map((function(e){return t.mapToLocal(e)})))}},{key:"doUnnormalization",get:function(){return!1}}]),e}(),A=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,i.Z)(this,n),(a=t.call(this,r)).defaultZ=o,a.transform=(0,S.c)(),a.transformInv=(0,S.c)(),a.transform=(0,S.a)(e),(0,b.a)(a.transformInv,a.transform),a}return(0,a.Z)(n,[{key:"makeMapPoint",value:function(e,t){return O(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){return R(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}},{key:"localToMap",value:function(e){return O(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this.defaultZ)}}]),n}(I),G=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var a;(0,i.Z)(this,n),(a=t.call(this,e.spatialReference)).view=e,a.defaultZ=null,a.pWS=(0,Z.c)(),a.tangentFrameUpWS=(0,Z.c)(),a.tangentFrameRightWS=(0,Z.c)(),a.tangentFrameForwardWS=(0,Z.c)(),a.localFrameRightWS=(0,Z.c)(),a.localFrameUpWS=(0,Z.c)(),a.worldToLocalTransform=(0,T.a)(),a.localToWorldTransform=(0,T.a)(),a.scale=1,a.scale=e.resolution,a.referenceMapPoint=r,a.defaultZ=r.hasZ?r.z:null;var o=e.state.camera.viewRight;a.view.renderCoordsHelper.toRenderCoords(a.referenceMapPoint,a.pWS),a.view.renderCoordsHelper.worldBasisAtPosition(a.pWS,0,a.tangentFrameRightWS),a.view.renderCoordsHelper.worldBasisAtPosition(a.pWS,1,a.tangentFrameUpWS),a.view.renderCoordsHelper.worldBasisAtPosition(a.pWS,2,a.tangentFrameForwardWS);var s=(0,Z.c)();return(0,V.a)(s,a.tangentFrameForwardWS,(0,V.d)(o,a.tangentFrameForwardWS)),(0,V.f)(a.localFrameRightWS,o,s),(0,V.n)(a.localFrameRightWS,a.localFrameRightWS),(0,V.c)(a.localFrameUpWS,a.tangentFrameForwardWS,a.localFrameRightWS),(0,M.r)(a.worldToLocalTransform,a.localFrameRightWS,a.tangentFrameRightWS),(0,M.i)(a.localToWorldTransform,a.worldToLocalTransform),a}return(0,a.Z)(n,[{key:"doUnnormalization",get:function(){return"global"===this.view.viewingMode}},{key:"makeMapPoint",value:function(e,t){return O(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){var t=(0,Z.c)();this.view.renderCoordsHelper.toRenderCoords(new E.Z({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,V.q)(t,t,this.worldToLocalTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return(0,d.pC)(n)?R(n.x/this.scale,n.y/this.scale):null}},{key:"localToMap",value:function(e){var t=(0,Z.c)();this.view.renderCoordsHelper.toRenderCoords(new E.Z({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,V.q)(t,t,this.localToWorldTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return(0,d.pC)(n)?O(n.x,n.y,this.defaultZ):null}}]),n}(I);function P(e,t){if("2d"===e.type)return new A(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){var n=t.length>2?new E.Z({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new E.Z({x:t[0],y:t[1],spatialReference:e.spatialReference});return new G(e,n)}return null}var D=n(77577),W=n(29909),z=n(80885);function H(e,t){var n=new E.Z({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(n.z=e[2]),n}function F(e,t){return new D.Z({points:e,spatialReference:t})}function L(e,t,n){var r=new W.Z({paths:e,spatialReference:t});return n&&(0,k.nc)(r),r}function U(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(0,g.d9)(e);i.forEach((function(e){var t=e[0],n=e[e.length-1];(0,v.fS)(t,n)&&1!==e.length||e.push(e[0])}));var a=new z.Z({rings:i,spatialReference:t});return a.rings.forEach((function(e){(0,k.bu)(e,!1,!1)||e.reverse()})),n&&(0,k.nc)(a),r&&a.isSelfIntersecting&&(0,C.JY)(t)&&(a=(0,w.simplify)(a)),a}function q(e,t,n){var r=t.mapToLocalMultiple(e),i=[],a={x:r[0].x,y:r[0].y},o=r[1].x,s=r[1].y,u=Math.round(o-a.x),c=Math.round(s-a.y),l=Math.max(Math.abs(u),Math.abs(c));if(n){var p={x:a.x+l,y:a.y+l},h={x:a.x-l,y:a.y-l};i.push(R(p.x,h.y),R(h.x,h.y),R(h.x,p.y),R(p.x,p.y))}else{var f={x:u>0?a.x+l:a.x-l,y:c>0?a.y+l:a.y-l};i.push(R(a.x,a.y),R(f.x,a.y),R(f.x,f.y),R(a.x,f.y))}return U([(0,d.lV)(i.map((function(e){return t.localToMap(e)})))],t.spatialReference,t.doUnnormalization,!0)}function N(e,t,n){var r=t.mapToLocalMultiple(e);if(1===r.length){var i=48,a=r[0];r=[R(a.x-i,a.y+i),R(a.x+i,a.y-i),R(a.x+i,a.y-i),R(a.x-i,a.y+i)]}var o=[],s={x:r[0].x,y:r[0].y},u={x:r[1].x,y:r[1].y};if(n){var c=Math.round(u.x-s.x),l=Math.round(u.y-s.y);o.push(R(s.x-c,s.y-l),R(u.x,s.y-l),R(u.x,u.y),R(s.x-c,u.y))}else o.push(R(s.x,s.y),R(u.x,s.y),R(u.x,u.y),R(s.x,u.y));return U([(0,d.lV)(o.map((function(e){return t.localToMap(e)})))],t.spatialReference,t.doUnnormalization,!0)}function X(e,t,n,r){var i=t.mapToLocalMultiple(e),a=null,o=null;if(n)a=i[0],o=i[1];else{var s=i[0],u=i[1],c=Math.round(u.x-s.x),l=Math.round(u.y-s.y),p=Math.max(Math.abs(c),Math.abs(l));a=R(c>0?s.x+p/2:s.x-p/2,l>0?s.y+p/2:s.y-p/2),o=R(Math.abs(c)>Math.abs(l)?a.x-p/2:a.x,Math.abs(c)>Math.abs(l)?a.y:a.y-p/2)}var h=t.localToMap(a),f=t.localToMap(o);if((0,d.Wi)(h)||(0,d.Wi)(f))return null;t.doUnnormalization&&(0,k.Sq)([[h,f]],t.spatialReference);var v=H(h,t.spatialReference),y=H(f,t.spatialReference),m=(0,x.c9)(t.spatialReference),g=0;if((0,C.JY)(t.spatialReference))g=m*(0,w.distance)(v,y,null);else{var b=a.x-o.x,S=a.y-o.y;g=m*Math.sqrt(b*b+S*S)*(r||1)}var M=new _.Z({center:v,radius:g,radiusUnit:"meters",spatialReference:t.spatialReference});return U(M.rings,M.spatialReference,!1)}function Y(e,t,n){for(var r=t.mapToLocalMultiple(e),i=r[0],a=r[1],o=Math.round(a.x-i.x),s=Math.round(a.y-i.y),u=R(n?i.x:i.x+o/2,n?i.y:i.y+s/2),c=n?o:o/2,l=n?s:s/2,p=[],h=2*Math.PI/60,f=0;f<60;f++){var v=Math.cos(f*h),y=Math.sin(f*h),m=R(c*v+u.x,l*y+u.y);p.push(m)}return p.push(p[0]),U([(0,d.lV)(p.map((function(e){return t.localToMap(e)})))],t.spatialReference,t.doUnnormalization,!1)}var B=n(29919),j=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._graphic=null,r.defaultZ=0,r.geometryType=null,r.hasZ=!0,r.mode=null,r.snappingManager=null,r.snapToScene=!1,r}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.internalGraphicsLayer=new m.Z({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",(function(t){return e.onVertexAdd(t)})),this.drawOperation.on("vertex-remove",(function(t){return e.onVertexRemove(t)})),this.drawOperation.on("vertex-update",(function(t){return e.onVertexUpdate(t)})),this.drawOperation.on("cursor-update",(function(t){return e.onCursorUpdate(t)})),this.drawOperation.on("complete",(function(t){return e.onComplete(t)}))]),this.complete()}},{key:"destroy",value:function(){this.drawOperation=(0,d.SC)(this.drawOperation),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=(0,d.SC)(this.internalGraphicsLayer),this._set("view",null)}},{key:"canRedo",get:function(){return this.drawOperation.canRedo}},{key:"canUndo",get:function(){return this.drawOperation.canUndo}},{key:"centered",set:function(e){this._set("centered",e),this._updateGraphic()}},{key:"enabled",set:function(e){this.drawOperation.interactive=e,this._set("enabled",e)}},{key:"forceUniformSize",set:function(e){this._set("forceUniformSize",e),this._updateGraphic()}},{key:"graphic",get:function(){return this._graphic}},{key:"graphicSymbol",set:function(e){this._set("graphicSymbol",e),(0,d.pC)(this._graphic)&&(this._graphic.symbol=e)}},{key:"updating",get:function(){var e,t;return null!=(e=null==(t=this.drawOperation)?void 0:t.updating)&&e}},{key:"completeCreateOperation",value:function(){this.drawOperation.complete()}},{key:"onInputEvent",value:function(e){this.drawOperation.onInputEvent(e)}},{key:"redo",value:function(){this.drawOperation.redo()}},{key:"reset",value:function(){}},{key:"undo",value:function(){this.drawOperation.undo()}},{key:"_createGraphic",value:function(e){var t=this;this._graphic=new c.Z({geometry:e,symbol:this.graphicSymbol}),this.internalGraphicsLayer.add(this._graphic),this.handles.add(this.initializeGraphic(this._graphic)),this.notifyChange("graphic"),this.handles.add((0,h.kB)((function(){(0,d.pC)(t._graphic)&&(t.internalGraphicsLayer.remove(t._graphic),t._graphic=(0,d.SC)(t._graphic))})),J)}},{key:"_destroyAllVisualisations",value:function(){this.handles.remove(Q.outline),this.handles.remove(Q.regularVertices),this.handles.remove(Q.activeVertex),this.handles.remove(J)}},{key:"_getCreateOperationGeometry",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{operationComplete:!1};if(null==this.drawOperation||0===this.drawOperation.numVertices)return null;var t=this.drawOperation.stagedVertex,n=this.drawOperation.committedVertices,r=n.slice();(0,d.pC)(t)&&r.push(this.drawOperation.coordinateHelper.pointToArray(t));var i=(0,d.pC)(t)?this.drawOperation.coordinateHelper.pointToArray(t):n.splice(-1)[0],a={regularVertices:null,activeVertex:null,full:null,outline:null},o=r.length,s=this.drawOperation.spatialReference,u="3d"===this.view.type&&"global"===this.view.viewingMode;switch(this.geometryType){case"point":a.regularVertices=n,a.activeVertex=i,a.full=this.drawOperation.coordinateHelper.arrayToPoint(r[0]);break;case"multipoint":a.regularVertices=n,a.activeVertex=i,o>0&&(a.full=F(r,s));break;case"polyline":a.regularVertices=n,a.activeVertex=i,o>0&&(a.full=L([r],s,u));break;case"polygon":a.regularVertices=n,a.activeVertex=i,o>0&&(a.full=U([r],s,u,!0));break;case"circle":if(o>0){var c=P(this.view,r[0]);if(1===o&&e.operationComplete){var l=r[0],p=c.makeMapPoint(l[0]+$*this.view.resolution,l[1]);a.full=X([l,p],c,!0)}else 2===o&&(a.full=this.forceUniformSize?X(r,c,this.centered):Y(r,c,this.centered))}break;case"rectangle":if(o>0){var h=P(this.view,r[0]);if(1===o&&e.operationComplete){var f=r[0],v=h.makeMapPoint(f[0]+$*this.view.resolution,f[1]);a.full=q([f,v],h,!0)}else 2===o&&(a.full=this.forceUniformSize?q(r,h,this.centered):N(r,h,this.centered))}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":case"polygon":o>1&&(a.outline=L([r],s,u));break;case"circle":case"rectangle":(0,d.pC)(a.full)&&"polygon"===a.full.type&&(a.outline=U(a.full.rings,s,u))}return a}},{key:"initializeGraphic",value:function(e){return null}},{key:"onComplete",value:function(e){this._updateGraphic();var t=null;if(this.drawOperation.isCompleted){var n=this._getCreateOperationGeometry({operationComplete:!0});(0,d.pC)(n)&&(t=new c.Z((0,r.Z)({geometry:n.full,symbol:this.graphicSymbol,sourceLayer:this.internalGraphicsLayer},this.graphicProperties)))}this.emit("complete",(0,r.Z)({graphic:t},e))}},{key:"onCursorUpdate",value:function(e){this._updateGraphic(),this.emit("cursor-update",e)}},{key:"onDeactivate",value:function(){this.drawOperation.isCompleted||this.drawOperation.cancel()}},{key:"onVertexAdd",value:function(e){this._updateGraphic(),this.emit("vertex-add",e)}},{key:"onVertexRemove",value:function(e){this._updateGraphic(),this.emit("vertex-remove",e)}},{key:"onVertexUpdate",value:function(e){this._updateGraphic(),this.emit("vertex-update",e)}},{key:"_updateGraphic",value:function(){var e=this._getCreateOperationGeometry();(0,d.Wi)(e)?this._destroyAllVisualisations():((0,d.pC)(e.outline)?this.handles.add(this.onOutlineChanged(e.outline),Q.outline):this.handles.remove(Q.outline),(0,d.pC)(e.regularVertices)?this.handles.add(this.onRegularVerticesChanged(e.regularVertices),Q.regularVertices):this.handles.remove(Q.regularVertices),(0,d.pC)(e.activeVertex)?this.handles.add(this.onActiveVertexChanged(e.activeVertex),Q.activeVertex):this.handles.remove(Q.activeVertex),(0,d.pC)(e.full)?(0,d.Wi)(this._graphic)?this._createGraphic(e.full):this._graphic.geometry=e.full:this.handles.remove(J))}}]),n}((0,p.p)(l.Z.EventedMixin(B.m)));(0,u._)([(0,f.Cb)({value:!0})],j.prototype,"centered",null),(0,u._)([(0,f.Cb)({nonNullable:!0})],j.prototype,"defaultZ",void 0),(0,u._)([(0,f.Cb)()],j.prototype,"drawOperation",void 0),(0,u._)([(0,f.Cb)({value:!0})],j.prototype,"enabled",null),(0,u._)([(0,f.Cb)({value:!0})],j.prototype,"forceUniformSize",null),(0,u._)([(0,f.Cb)({constructOnly:!0})],j.prototype,"geometryType",void 0),(0,u._)([(0,f.Cb)()],j.prototype,"graphic",null),(0,u._)([(0,f.Cb)({constructOnly:!0})],j.prototype,"graphicProperties",void 0),(0,u._)([(0,f.Cb)()],j.prototype,"graphicSymbol",null),(0,u._)([(0,f.Cb)({constructOnly:!0})],j.prototype,"hasZ",void 0),(0,u._)([(0,f.Cb)({constructOnly:!0})],j.prototype,"mode",void 0),(0,u._)([(0,f.Cb)()],j.prototype,"snappingManager",void 0),(0,u._)([(0,f.Cb)()],j.prototype,"snapToScene",void 0),(0,u._)([(0,f.Cb)({readOnly:!0})],j.prototype,"type",void 0),(0,u._)([(0,f.Cb)({readOnly:!0})],j.prototype,"updating",null),(0,u._)([(0,f.Cb)({constructOnly:!0,nonNullable:!0})],j.prototype,"view",void 0),j=(0,u._)([(0,y.j)("esri.views.draw.DrawGraphicTool")],j);var J="create-operation-graphic",Q={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function K(e){switch(e){case"point":case"polyline":case"polygon":case"multipoint":return e;case"circle":case"rectangle":return"segment";default:return null}}var $=48},42046:function(e,t,n){n.d(t,{w:function(){return Z}});var r=n(15861),i=n(1413),a=n(15671),o=n(43144),s=n(60136),u=n(29388),c=n(87757),l=n(27366),p=n(91505),h=n(41691),d=n(84652),f=n(92026),v=n(66978),y=n(17842),m=n(49861),g=(n(25243),n(69912)),x=n(70178),_=function(){function e(t){var n=t.grabbableForEvent;(0,a.Z)(this,e),this.events=new p.Z,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=n}return(0,o.Z)(e,[{key:"intersectionDistance",value:function(e,t){return 0}},{key:"attach",value:function(){}},{key:"detach",value:function(){}}]),e}(),w="click",k=n(14813),C=n(74229),b=n(84954),S=n(87268),M=n(34019),T=n(80151),V=n(99912),Z=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e))._createOperationCompleted=!1,r._pointerDownStates=new Set,r._snappingPipeline=new T.n,r._snappingTask=null,r._stagedVertex=null,r.snapToSceneEnabled=null,(0,f.Wi)(e.elevationInfo)&&(r.elevationInfo={mode:e.hasZ?"absolute-height":"on-the-ground",offset:0}),r}return(0,o.Z)(n,[{key:"initialize",value:function(){var e,t,n=this;this.coordinateHelper=(0,k.Y6)(this.hasZ,this.hasM,this.view.spatialReference);var r="3d"===this.view.type?null==(e=this.view)||null==(t=e.resourceController)?void 0:t.scheduler:null;this._frameTask=r?r.registerTask(V.T8.SNAPPING):V.sq;var a="viewingMode"in this.view.state?this.view.state.viewingMode:2,o="segment"===this.geometryType||"multipoint"===this.geometryType?"polyline":this.geometryType;this._editGeometryOperations=new S.c(new b.XE(o,this.coordinateHelper,a)),this._activeComponent=new b.wA(this.spatialReference,a),this._editGeometryOperations.data.components.push(this._activeComponent),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(function(e){var t=e.vertices.map((function(e){return{componentIndex:0,vertexIndex:e.index,coordinates:n.coordinateHelper.vectorToArray(e.pos)}})),r=t.map((function(e){return e.coordinates}));switch(e.type){case"vertex-add":n.emit(e.type,(0,i.Z)((0,i.Z)({},e),{},{added:r,vertices:t}));break;case"vertex-update":n.emit(e.type,(0,i.Z)((0,i.Z)({},e),{},{updated:r,vertices:t}));break;case"vertex-remove":n.emit(e.type,(0,i.Z)((0,i.Z)({},e),{},{removed:r,vertices:t}))}}))),this._manipulator=new _({grabbableForEvent:function(e){return"click"!==n.drawingMode||"touch"===e.pointerType&&n._snappingEnabled&&1===n._pointerDownStates.size}}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==this.geometryType,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(function(e){return n._onImmediateClick(e)})),this._manipulator.events.on("immediate-double-click",(function(e){return n._onImmediateDoubleClick(e)}))])}},{key:"destroy",value:function(){this._editGeometryOperations=(0,f.SC)(this._editGeometryOperations),this._frameTask=(0,f.hw)(this._frameTask)}},{key:"_snappingEnabled",get:function(){return(0,f.pC)(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}},{key:"canRedo",get:function(){return this._editGeometryOperations.canRedo}},{key:"canUndo",get:function(){return this._editGeometryOperations.canUndo}},{key:"committedVertices",get:function(){var e=this;return this._activeComponent.vertices.map((function(t){return e.coordinateHelper.vectorToArray(t.pos)}))}},{key:"drawingMode",set:function(e){this._set("drawingMode",null!=e?e:w)}},{key:"hasStagedVertex",get:function(){return(0,f.pC)(this._stagedVertex)}},{key:"interactive",get:function(){return this._manipulator.interactive},set:function(e){this._manipulator.interactive=e}},{key:"isCompleted",get:function(){return this._createOperationCompleted}},{key:"numCommittedVertices",get:function(){return this._activeComponent.vertices.length}},{key:"numVertices",get:function(){return(0,f.pC)(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}},{key:"spatialReference",get:function(){return this.view.spatialReference}},{key:"stagedVertex",get:function(){return this._stagedVertex},set:function(e){if((0,f.Wi)(e))this.discardStagedVertex();else if(!(0,f.pC)(this._stagedVertex)||!(0,x.k)(this._stagedVertex,e)){if((0,f.Wi)(this._stagedVertex))this._stagedVertex=(0,d.d9)(e);else{if((0,x.k)(this._stagedVertex,e))return;this._stagedVertex.x=e.x,this._stagedVertex.y=e.y,this._stagedVertex.z=e.z,this._stagedVertex.m=e.m,this._stagedVertex.hasZ=e.hasZ,this._stagedVertex.hasM=e.hasM,this._stagedVertex.spatialReference=e.spatialReference}this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(e)}],operation:"apply",type:"vertex-update"})}}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"vertices",get:function(){var e=this.committedVertices;return(0,f.pC)(this._stagedVertex)&&e.push(this.coordinateHelper.pointToArray(this._stagedVertex)),e}},{key:"cancel",value:function(){this.complete({aborted:!0})}},{key:"commitStagedVertex",value:function(){if(this._snappingTask=(0,f.IM)(this._snappingTask),(0,f.pC)(this._stagedVertex)){var e=this._stagedVertex;this._stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e))}}},{key:"complete",value:function(e){var t=e&&e.aborted||!1;(0,f.IM)(this._snappingTask),(0,f.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.discardStagedVertex();var n="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!n,(this.isCompleted||t)&&this.emit("complete",{vertices:this.vertices.map((function(e,t){return{componentIndex:0,vertexIndex:t,coordinates:e}})),aborted:t,type:"complete"})}},{key:"discardStagedVertex",value:function(){this._stagedVertex=null}},{key:"onInputEvent",value:function(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}},{key:"redo",value:function(){this._editGeometryOperations.redo()}},{key:"undo",value:function(){(0,f.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}},{key:"_closeOnClickVertexIndex",value:function(e){var t=this._activeComponent;if("polygon"===this.geometryType&&t.vertices.length>2){if(this._vertexWithinPointerDistance(t.vertices[0].pos,e))return 0;if(this._vertexWithinPointerDistance(t.vertices[t.vertices.length-1].pos,e))return t.vertices.length-1}return null}},{key:"_createManipulatorDragPipeline",value:function(e){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}},{key:"_createManipulatorDragPipelineClick",value:function(e){var t=this;return(0,C.Xd)(e,(function(e,n,r,i){var a="touch"===i&&t._snappingEnabled;!t.isCompleted&&a&&(n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(t.stagedVertex=e.mapStart,("segment"===t.geometryType||a&&0===t.numVertices)&&t.commitStagedVertex()),e})).next(t._snappingPipeline.createSnapDragEventPipelineStep({predicate:function(){return a},cancel:r,snappingManager:t.snappingManager,snappingContext:new M.N({editGeometryOperations:t._editGeometryOperations,elevationInfo:t.elevationInfo,pointer:i,visualizer:t.snappingVisualizer}),updatingHandles:t.updatingHandles}),t._snappingPipeline.next).next((function(e){return a&&(t.stagedVertex=e.mapEnd,"end"===e.action&&t.commitStagedVertex()),e})).next((function(e){return"end"===e.action&&("segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()),e})),r.next((function(){a&&(0,f.pC)(t.snappingManager)&&t.snappingManager.doneSnapping()})))}))}},{key:"_createManipulatorDragPipelineFreehand",value:function(e){var t=this;return(0,C.Xd)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&((0,f.Wi)(t.stagedVertex)&&(t.stagedVertex=e.mapStart),"segment"===t.geometryType&&t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t.stagedVertex=e.mapEnd,"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":t.complete()}return e}))}))}},{key:"_createManipulatorDragPipelineHybrid",value:function(e){var t=this;return(0,C.Xd)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&((0,f.Wi)(t.stagedVertex)&&(t.stagedVertex=e.mapStart),t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t.stagedVertex=e.mapEnd,"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":"segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()}return e}))}))}},{key:"_getDrawSurface",value:function(){if((0,f.Wi)(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ)return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;var e=this.defaultZ,t=!1;(0,f.pC)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(t=!0),(0,f.pC)(this.snapToSceneEnabled)&&(t=this.snapToSceneEnabled),(0,f.pC)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(t=!1);var n=this._activeComponent.vertices.length;return("segment"===this.geometryType||"polygon"===this.geometryType)&&n>0&&(e=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),t=!1),t?this.drawSurface:(this.elevationDrawSurface.defaultZ=e,this.elevationDrawSurface)}},{key:"_mapToScreen",value:function(e){return this._getDrawSurface().mapToScreen(e)}},{key:"_onHold",value:function(e){(0,f.IM)(this._snappingTask),"click"===this.drawingMode&&"touch"===e.pointerType&&this._snappingEnabled&&(this.stagedVertex=e.mapPoint),e.stopPropagation()}},{key:"_onImmediateClick",value:function(e){if(!("mouse"===e.pointerType&&2===e.button||this._manipulator.dragging)){var t=this._activeComponent,n=this._closeOnClickVertexIndex(e.screenPoint);if((0,f.pC)(n))return e.stopPropagation(),this.discardStagedVertex(),void this.complete();var r=this._screenToMap(e.screenPoint);if((0,f.pC)(r))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&(this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),this.complete());break;case"click":case"hybrid":this._snappingTask=(0,f.IM)(this._snappingTask),this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),("point"===this.geometryType||"segment"===this.geometryType&&2===t.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===t.vertices.length)&&this.complete()}e.stopPropagation()}}},{key:"_onImmediateDoubleClick",value:function(e){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),e.stopPropagation())}},{key:"_onPointerMove",value:function(e){var t=this;if((0,f.IM)(this._snappingTask),!(this._manipulator.dragging||this._pointerDownStates.has(e.pointerId)||this._manipulator.grabbing)&&this._manipulator.interactive){var n=(0,y.vW)(e.x,e.y),i=this._closeOnClickVertexIndex(n);if((0,f.pC)(i)){this.discardStagedVertex();var a={componentIndex:0,vertexIndex:i,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[i].pos)};this.emit("cursor-update",{updated:null,vertices:[a],operation:"apply",type:"vertex-update"})}else{var o=this._screenToMap(n);if(this._manipulator.cursor=(0,f.pC)(o)?"crosshair":null,(0,f.pC)(o))if((0,f.pC)(this.snappingManager)){var s=this.snappingManager,u=new M.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e.pointerType,visualizer:this.snappingVisualizer});this.stagedVertex=s.update(o,u),this._snappingTask=(0,v.vr)(function(){var e=(0,r.Z)(c.mark((function e(n){var r;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._frameTask.schedule((function(){return s.snap(o,u,n)}),n);case 2:if(r=e.sent,e.t0=r.valid,!e.t0){e.next=7;break}return e.next=7,t._frameTask.schedule((function(){t.stagedVertex=r.apply()}),n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.updatingHandles.addPromise(this._snappingTask.promise)}else this.stagedVertex=o}e.stopPropagation()}}},{key:"_screenToMap",value:function(e){return this._getDrawSurface().screenToMap(e)}},{key:"_screenToMapDragEventStep",value:function(){var e=this,t=null;return function(n){if("start"===n.action&&(t=e._screenToMap(n.screenStart)),(0,f.Wi)(t))return null;var r=e._screenToMap(n.screenEnd);return(0,f.pC)(r)?(0,i.Z)((0,i.Z)({},n),{},{mapStart:t,mapEnd:r}):null}}},{key:"_vertexWithinPointerDistance",value:function(e,t){var n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return!!(0,f.pC)(n)&&function(e,t,n){var r=e.x-t.x,i=e.y-t.y;return r*r+i*i<=n}(n,t,25)}}]),n}(p.Z.EventedMixin(h.r));(0,l._)([(0,m.Cb)()],Z.prototype,"defaultZ",void 0),(0,l._)([(0,m.Cb)({value:w})],Z.prototype,"drawingMode",null),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"elevationDrawSurface",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"elevationInfo",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"geometryType",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"hasM",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"hasZ",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"manipulators",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"drawSurface",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"snappingManager",void 0),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"snappingVisualizer",void 0),(0,l._)([(0,m.Cb)()],Z.prototype,"snapToSceneEnabled",void 0),(0,l._)([(0,m.Cb)({readOnly:!0})],Z.prototype,"updating",null),(0,l._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"view",void 0),Z=(0,l._)([(0,g.j)("esri.views.draw.DrawOperation")],Z)},54016:function(e,t,n){n.d(t,{aL:function(){return c},hP:function(){return p},iW:function(){return l}});var r=n(15671),i=n(43144),a=n(92026),o=n(17842),s=n(65618),u=n(74509),c=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,r.Z)(this,e),this.elevationInfo=t,this.defaultZ=n,this.view=i,this.excludeGraphics=a}return(0,i.Z)(e,[{key:"screenToMap",value:function(e){if((0,a.pC)(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(e.x,e.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);var t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(e.x,e.y),this.elevationInfo,0,this.excludeGraphics);return(0,a.pC)(t)&&(t.z=void 0),t}},{key:"mapToScreen",value:function(e){var t=(0,s.Tx)(e.x,e.y,(0,u.vQ)(this.view,e,this.elevationInfo),e.spatialReference);return this.view.toScreen(t)}}]),e}(),l=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,r.Z)(this,e),this.view=t,this.elevationInfo=n,this.exclude=i}return(0,i.Z)(e,[{key:"screenToMap",value:function(e){var t=this.view.toMap(e,{exclude:this.exclude});return(0,a.pC)(t)&&(t.z=(0,u.Ou)(t,this.view,this.elevationInfo)),t}},{key:"mapToScreen",value:function(e){var t=e;return(0,a.pC)(this.elevationInfo)&&(t=(0,s.Tx)(e.x,e.y,(0,u.vQ)(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}}]),e}(),p=(0,i.Z)((function e(t){(0,r.Z)(this,e),this.view=t,this.screenToMap=function(e){return t.toMap(e)},this.mapToScreen=function(e){return t.toScreen(e)}}))},29919:function(e,t,n){n.d(t,{m:function(){return x}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),s=n(27366),u=n(85015),c=n(32718),l=n(92026),p=n(66978),h=n(49861),d=(n(63780),n(93169),n(25243),n(69912)),f=n(24043),v=n(37762),y=n(40110),m=function(){function e(){(0,r.Z)(this,e),this._isToolEditable=!0,this._manipulators=new y.Z,this._nextManipulatorId=0,this._resourceContexts={manipulator3D:{}},this._attached=!1}return(0,i.Z)(e,[{key:"isToolEditable",set:function(e){this._isToolEditable=e}},{key:"length",get:function(){return this._manipulators.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.addMany([e],t)[0]}},{key:"addMany",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e){var r=t._nextManipulatorId++,i={id:r,manipulator:e,visibilityPredicate:n,attached:!1};return t._manipulators.add(i),t._attached&&t._updateManipulatorAttachment(i),r}))}},{key:"remove",value:function(e){if("number"==typeof e){for(var t=e,n=0;n<this._manipulators.length;n++)if(this._manipulators.getItemAt(n).id===t){var r=this._manipulators.splice(n,1)[0];return this._detachManipulator(r),r.id}return null}for(var i=e,a=0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).manipulator===i){var o=this._manipulators.splice(a,1)[0];return this._detachManipulator(o),o.id}return null}},{key:"removeAll",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._manipulators.removeAll()}},{key:"attach",value:function(){var e=this;this._manipulators.forEach((function(t){e._updateManipulatorAttachment(t)})),this._attached=!0}},{key:"detach",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._attached=!1}},{key:"destroy",value:function(){this._manipulators.forEach((function(e){var t=e.manipulator;t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}},{key:"on",value:function(e,t){return this._manipulators.on(e,(function(e){t(e)}))}},{key:"forEach",value:function(e){var t,n=(0,v.Z)(this._manipulators.items);try{for(n.s();!(t=n.n()).done;){e(t.value)}}catch(r){n.e(r)}finally{n.f()}}},{key:"some",value:function(e){return this._manipulators.items.some(e)}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){return e.push(t.manipulator)})),e}},{key:"intersect",value:function(e,t){var n=null,r=Number.MAX_VALUE;return this._manipulators.forEach((function(i){var a=i.id,o=i.manipulator;if(i.attached&&o.interactive){var s=o.intersectionDistance(e,t);(0,l.pC)(s)&&s<r&&(r=s,n={id:a,manipulator:o})}})),n}},{key:"findById",value:function(e){if((0,l.Wi)(e))return null;var t,n=(0,v.Z)(this._manipulators.items);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e===r.id)return r.manipulator}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"_updateManipulatorAttachment",value:function(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}},{key:"_attachManipulator",value:function(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}},{key:"_detachManipulator",value:function(e){if(e.attached){var t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}}},{key:"_isManipulatorItemVisible",value:function(e){return 2===e.visibilityPredicate||(this._isToolEditable?0===e.visibilityPredicate:1===e.visibilityPredicate)}}]),e}(),g=c.Z.getLogger("esri.views.interactive.InteractiveToolBase"),x=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).toolState="pending",i.completed=!1,i.manipulators=new m,i.updating=!1,i.automaticManipulatorSelection=!0,i._editableFlags=new Map([[1,!0],[0,!0]]),i._creationStartedResolver=(0,p.hh)(),i._creationFinishedResolver=(0,p.hh)(),i}return(0,i.Z)(n,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"visible",set:function(e){this._set("visible",e),e||this.active&&(this.view.activeTool=null),this.attached&&(e?this._show():this._hide())}},{key:"editable",get:function(){return this.getEditableFlag(0)},set:function(e){this.setEditableFlag(0,e)}},{key:"attached",get:function(){return this._get("attached")}},{key:"created",get:function(){return"created"===this.toolState}},{key:"cursor",get:function(){return null}},{key:"attach",value:function(){this.attached?g.warn("Tool is already attached. Ignoring attach request."):(this.manipulators.attach(),this.onAttach(),this.visible&&this.onShow(),this._set("attached",!0))}},{key:"detach",value:function(){this.attached?(this.visible&&this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1)):g.error("Tool isn't currently attached. Ignoring detach request.")}},{key:"activate",value:function(){(0,l.Wi)(this.view)?g.error("Can't activate tool if view is not defined."):this.active?g.warn("Tool is already active, ignoring activation request."):((0,f.t)(this.view)&&this.view.focus(),this.onActivate())}},{key:"deactivate",value:function(){this.active?this.onDeactivate():g.warn("Tool is not active, ignoring deactivation request.")}},{key:"handleInputEvent",value:function(e){this.attached?this.onInputEvent(e):g.warn("handleInputEvent() called on detached tool")}},{key:"handleInputEventAfter",value:function(e){this.attached?this.onInputEventAfter(e):g.warn("handleInputEventAfter() called on detached tool")}},{key:"destroy",value:function(){this.manipulators.destroy(),this._set("view",null),this._set("completed",!1)}},{key:"setEditableFlag",value:function(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),0===e&&this.notifyChange("editable"),this.onEditableChange()}},{key:"getEditableFlag",value:function(e){return this._editableFlags.get(e)}},{key:"whenCreationStarted",value:function(){return this._creationStartedResolver.promise}},{key:"whenCreated",value:function(){return this._creationFinishedResolver.promise}},{key:"rejectCreation",value:function(e){"pending"!==this.toolState&&"creating"!==this.toolState||this._creationStartedResolver.resolve(this),this._creationFinishedResolver.reject(e)}},{key:"onActivate",value:function(){}},{key:"onDeactivate",value:function(){}},{key:"onAttach",value:function(){}},{key:"onDetach",value:function(){}},{key:"onShow",value:function(){}},{key:"onHide",value:function(){}},{key:"onEditableChange",value:function(){}},{key:"onInputEvent",value:function(e){}},{key:"onInputEventAfter",value:function(e){}},{key:"internallyEditable",get:function(){return this.getEditableFlag(0)&&this.getEditableFlag(1)}},{key:"startToolCreation",value:function(){if("pending"===this.toolState)return this._creationStartedResolver.resolve(this),void(this.toolState="creating");throw new Error("Unexpected tool state ".concat(this.toolState))}},{key:"finishToolCreation",value:function(){switch(this.toolState){case"pending":this.startToolCreation();case"creating":this.created||this._creationFinishedResolver.resolve(this),this.toolState="created";break;case"created":break;default:throw new Error("Unexpected tool state ".concat(this.toolState))}}},{key:"complete",value:function(){this.finishToolCreation(),this._set("completed",!0)}},{key:"_show",value:function(){this._updateManipulatorAttachment(),this.onShow()}},{key:"_hide",value:function(){this._updateManipulatorAttachment(),this.onHide()}},{key:"_updateManipulatorAttachment",value:function(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()}}]),n}(u.Z);(0,s._)([(0,h.Cb)()],x.prototype,"toolState",void 0),(0,s._)([(0,h.Cb)({constructOnly:!0})],x.prototype,"view",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],x.prototype,"active",null),(0,s._)([(0,h.Cb)({value:!0})],x.prototype,"visible",null),(0,s._)([(0,h.Cb)({value:!0})],x.prototype,"editable",null),(0,s._)([(0,h.Cb)({value:!1,readOnly:!0})],x.prototype,"attached",null),(0,s._)([(0,h.Cb)({readOnly:!0})],x.prototype,"created",null),(0,s._)([(0,h.Cb)({readOnly:!0})],x.prototype,"completed",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],x.prototype,"manipulators",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],x.prototype,"updating",void 0),(0,s._)([(0,h.Cb)()],x.prototype,"cursor",null),(0,s._)([(0,h.Cb)()],x.prototype,"automaticManipulatorSelection",void 0),x=(0,s._)([(0,d.j)("esri.views.interactive.InteractiveToolBase")],x)},74229:function(e,t,n){n.d(t,{hM:function(){return S},AN:function(){return k},zh:function(){return C},M2:function(){return v},Xd:function(){return f},kY:function(){return b},a9:function(){return y},oq:function(){return g},bD:function(){return _},QY:function(){return w}});var r=n(15671),i=n(43144),a=n(1413),o=n(37762),s=n(84652),u=n(16889),c=n(92026),l=n(17842),p=n(71353),h=n(60176),d=n(20008);function f(e,t){return e.events.on("drag",function(e,t){var n=null,r=null;return function(i){if("cancel"!==i.action){var a={action:i.action,screenStart:i.start,screenEnd:i.screenPoint};"start"===i.action&&(0,c.Wi)(n)&&(n=new S,r=new S,t(e,n,r,i.pointerType,a)),(0,c.pC)(n)&&n.execute(a),"end"===i.action&&(0,c.pC)(n)&&(n=null,r=null)}else(0,c.pC)(r)&&(r.execute({action:"cancel"}),n=null,r=null)}}(e,t))}function v(e,t){var n=[e.x,e.y,e.z],r=t,i=[Math.cos(r),Math.sin(r)],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]);if(0===a)return null;i[0]/=a,i[1]/=a;var o=function(e){var t=(e.x-n[0])*i[0]+(e.y-n[1])*i[1];e.x=n[0]+t*i[0],e.y=n[1]+t*i[1]};return function(e){return o(e.mapStart),o(e.mapEnd),e}}function y(e,t){var n=null;return function(r){if("start"===r.action&&(n=function(e,t,n){var r=e.geometry;if((0,c.Wi)(r))return null;if("mesh"===r.type)return function(e,t,n,r){if((0,c.pC)(t.transform))return function(e,t,n,r){var i=m(n.getOriginPoint(t.spatialReference),r),a=t.spatialReference;return(0,c.Wi)(i)?null:{move:function(t,r,o){var s=(0,d.pB)(i.clone(),t,r,o);if(s.spatialReference.equals(a))n.origin=(0,p.f)(s.x,s.y,s.z);else{var u=(0,h.iV)(s,a);(0,c.pC)(u)&&(n.origin=(0,p.f)(u.x,u.y,u.z))}e.notifyGeometryChanged()}}}(e,t,t.transform,n);if(!t.spatialReference.equals(n))return null;var i=0,a=0,o=0;return{move:function(n,s,u){var c=n-i,l=s-a,p=u-o;if(c||l||p){var h=t.origin.clone().offset(c,l,p);t.centerAt(h,{geographic:1===r}),e.notifyGeometryChanged(),i=n,a=s,o=u}}}}(e,r,t,n);var i=m(r,t),a=r.spatialReference;return(0,c.Wi)(i)?null:{move:function(t,n,r){var o=(0,d.pB)(i.clone(),t,n,r);o.spatialReference.equals(a)?e.geometry=o:e.geometry=(0,h.iV)(o,a)}}}(e,r.mapStart.spatialReference,t)),(0,c.Wi)(n))return null;var i=r.mapEnd.x-r.mapStart.x,o=r.mapEnd.y-r.mapStart.y,s=r.mapEnd.z-r.mapStart.z;return n.move(i,o,s),(0,a.Z)((0,a.Z)({},r),{},{translationX:i,translationY:o,translationZ:s})}}function m(e,t){return(0,c.Wi)(e)?null:e.spatialReference.equals(t)?e.clone():(0,h.iV)(e,t)}function g(e,t){var n=e.map((function(e){return(0,c.Wg)(y(e,t))})).filter((function(e){return(0,c.pC)(e)}));return function(e){var t=e.mapEnd.x-e.mapStart.x,r=e.mapEnd.y-e.mapStart.y,i=e.mapEnd.z-e.mapStart.z;return n.forEach((function(t){return t(e)})),(0,a.Z)((0,a.Z)({},e),{},{translationX:t,translationY:r,translationZ:i})}}function x(e,t){var n,r=new Map,i=(0,o.Z)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.set(a,(0,s.d9)(e[a]))}}catch(u){i.e(u)}finally{i.f()}return function(t){return r.forEach((function(t,n){e[n]=t})),t}}function _(e){return(0,c.pC)(e.geometry)&&"mesh"===e.geometry.type?function(e,t){var n=(0,c.pC)(t.transform)?t.transform.clone():null,r=t.vertexAttributes.clonePositional();return function(i){return t.transform=n,t.vertexAttributes=r,e.notifyGeometryChanged(),i}}(e,e.geometry):x(e,["geometry"])}function w(e){var t=e.map((function(e){return(0,c.Wg)(_(e))})).filter((function(e){return(0,c.pC)(e)}));return function(e){return t.forEach((function(t){return t(e)})),e}}function k(){var e=0,t=0,n=0;return function(r){"start"===r.action&&(e=r.mapStart.x,t=r.mapStart.y,n=r.mapStart.z);var i=r.mapEnd.x-e,o=r.mapEnd.y-t,s=r.mapEnd.z-n;return e=r.mapEnd.x,t=r.mapEnd.y,n=r.mapEnd.z,(0,a.Z)((0,a.Z)({},r),{},{mapDeltaX:i,mapDeltaY:o,mapDeltaZ:s,mapDeltaSpatialReference:r.mapStart.spatialReference})}}function C(){var e=0,t=0;return function(n){"start"===n.action&&(e=n.screenStart.x,t=n.screenStart.y);var r=n.screenEnd.x-e,i=n.screenEnd.y-t;return e=n.screenEnd.x,t=n.screenEnd.y,(0,a.Z)((0,a.Z)({},n),{},{screenDeltaX:r,screenDeltaY:i})}}function b(e,t){var n=null,r=0,i=0;return function(a){if("start"===a.action&&((n=e.toScreen(t)).x<0||n.x>e.width||n.y<0||n.y>e.height?n=null:(r=a.screenStart.x-n.x,i=a.screenStart.y-n.y)),null==n)return null;var o=(0,u.uZ)(a.screenEnd.x-r,0,e.width),s=(0,u.uZ)(a.screenEnd.y-i,0,e.height),c=(0,l.vW)(o,s);return a.screenStart=n,a.screenEnd=c,a}}var S=function(){function e(){(0,r.Z)(this,e),this.execute=function(){}}return(0,i.Z)(e,[{key:"next",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return(0,c.pC)(t)&&(this.execute=function(e){var r=t(e);(0,c.pC)(r)&&n.execute(r)}),n}}]),e}()},80151:function(e,t,n){n.d(t,{n:function(){return f}});var r=n(15861),i=n(1413),a=n(15671),o=n(43144),s=n(87757),u=n(92026),c=n(66978),l=n(70178),p=n(74229),h=n(34019),d=n(99912),f=function(){function e(){(0,a.Z)(this,e),this.next=new p.hM}return(0,o.Z)(e,[{key:"createSnapDragEventPipelineStep",value:function(e){var t=this,n=e.predicate,a=void 0===n?function(){return!0}:n,o=e.cancel,f=e.snappingManager,v=e.snappingContext,y=e.updatingHandles;if((0,u.Wi)(f))return function(e){return e};var m=null,g=null,x=function(){m=(0,u.IM)(m),f.doneSnapping(),(0,u.pC)(g)&&g.frameTask.remove(),g=null};return o.next((function(e){return x(),e})),this.next=new p.hM,function(e){if(!a(e))return e;if(m=(0,u.IM)(m),"start"===e.action){var n="3d"===f.view.type?f.view.resourceController.scheduler.registerTask(d.T8.SNAPPING):d.sq;g={context:new h.N({editGeometryOperations:v.editGeometryOperations,elevationInfo:v.elevationInfo,pointer:v.pointer,vertexHandle:(0,u.pC)(e.info)?e.info.handle:null,excludeFeature:v.excludeFeature,visualizer:v.visualizer}),originalPos:(0,u.pC)(e.snapOrigin)?v.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,frameTask:n}}if((0,u.pC)(g)){var o=g.context.coordinateHelper.vectorToDehydratedPoint(g.context.coordinateHelper.arrayToVector([g.originalPos.x,g.originalPos.y,g.originalPos.z]));o.x+=e.mapEnd.x-e.mapStart.x,o.y+=e.mapEnd.y-e.mapStart.y;var p=e.mapStart.x-g.originalPos.x,_=e.mapStart.y-g.originalPos.y,w=(0,i.Z)((0,i.Z)({},e),{},{action:"udpate"}),k=g.context,C=f.update(o,g.context);if(e.mapEnd.x=C.x+p,e.mapEnd.y=C.y+_,"end"!==e.action){var b=g.frameTask;m=(0,c.vr)(function(){var e=(0,r.Z)(s.mark((function e(n){var r,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.schedule((function(){return f.snap(o,k,n)}),n);case 2:if(!(r=e.sent).valid){e.next=8;break}return e.next=6,b.schedule((function(){return r.apply()}),n);case 6:i=e.sent,(0,l.k)(i,C)||(w.mapEnd.x=i.x+p,w.mapEnd.y=i.y+_,t.next.execute(w));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y.addPromise(m.promise)}}return"end"===e.action&&x(),e}}}]),e}()}}]);
//# sourceMappingURL=2490.a011ac0c.chunk.js.map