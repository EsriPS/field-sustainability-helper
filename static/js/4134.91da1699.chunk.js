"use strict";(self.webpackChunkfield_sustainability_helper=self.webpackChunkfield_sustainability_helper||[]).push([[4134],{82218:function(e,t,n){n.d(t,{a:function(){return k},c:function(){return w},g:function(){return E},h:function(){return S},u:function(){return M}});var r=n(37762),i=n(43144),o=n(15671),a=(n(93169),n(32718)),u=n(16889),s=n(21530),c=n(14226),l=n(81949),f=n(11186),d=n(71353),h=n(14320),v=n(85981),g=n(55652),p=n(40885),y=n(40927),b=n(11185),_=a.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane"),m=(0,i.Z)((function e(){(0,o.Z)(this,e),this.plane=(0,g.Ue)(),this.origin=(0,d.c)(),this.basis1=(0,d.c)(),this.basis2=(0,d.c)()}));function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return{plane:(0,g.Ue)(e.plane),origin:(0,d.a)(e.origin),basis1:(0,d.a)(e.basis1),basis2:(0,d.a)(e.basis2)}}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w();return I(e.origin,e.basis1,e.basis2,t)}function I(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w();return(0,f.g)(r.origin,e),(0,f.g)(r.basis1,t),(0,f.g)(r.basis2,n),M(r),z(r,"fromValues()"),r}function M(e){(0,g.my)(e.basis2,e.basis1,e.origin,e.plane)}function Z(e,t,n){e!==n&&k(e,n);var r=(0,f.a)(b.WM.get(),A(e),t);return(0,f.b)(n.origin,n.origin,r),n.plane[3]-=t,n}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w(),n=(e[2]-e[0])/2,r=(e[3]-e[1])/2;return(0,f.s)(t.origin,e[0]+n,e[1]+r,0),(0,f.s)(t.basis1,n,0,0),(0,f.s)(t.basis2,0,r,0),(0,g.al)(0,0,1,0,t.plane),t}function C(e,t,n){return!!(0,g.BR)(e.plane,t,n)&&x(e,n)}function P(e,t,n){var i=B.get();V(e,t,i,B.get());var o,a=Number.POSITIVE_INFINITY,s=(0,r.Z)(D);try{for(s.s();!(o=s.n()).done;){var c=R(e,o.value,L.get()),l=b.WM.get();if((0,g.rx)(i,c,l)){var d=(0,f.r)(b.WM.get(),t.origin,l),h=Math.abs((0,u.ZF)((0,f.d)(t.direction,d)));h<a&&(a=h,(0,f.g)(n,l))}}}catch(v){s.e(v)}finally{s.f()}return a===Number.POSITIVE_INFINITY?O(e,t,n):n}function O(e,t,n){if(C(e,t,n))return n;var i=B.get(),o=B.get();V(e,t,i,o);var a,u=Number.POSITIVE_INFINITY,s=(0,r.Z)(D);try{for(s.s();!(a=s.n()).done;){var c=R(e,a.value,L.get()),l=b.WM.get();if((0,g.dZ)(i,c,l)){var d=(0,p.Jk)(t,l);if(!(0,g.Ac)(o,l))continue;d<u&&(u=d,(0,f.g)(n,l))}}}catch(h){s.e(h)}finally{s.f()}return H(e,t.origin)<u&&T(e,t.origin,n),n}function T(e,t,n){var r=(0,g.nF)(e.plane,t,b.WM.get()),i=(0,v.ct)(F(e,e.basis1),r,-1,1,b.WM.get()),o=(0,v.ct)(F(e,e.basis2),r,-1,1,b.WM.get());return(0,f.f)(n,(0,f.b)(b.WM.get(),i,o),e.origin),n}function N(e,t,n){var r=e.origin,i=e.basis1,o=e.basis2,a=(0,f.f)(b.WM.get(),t,r),u=(0,y.SR)(i,a),s=(0,y.SR)(o,a),c=(0,y.SR)(A(e),a);return(0,f.s)(n,u,s,c)}function H(e,t){var n=N(e,t,b.WM.get()),r=e.basis1,i=e.basis2,o=(0,f.l)(r),a=(0,f.l)(i),u=Math.max(Math.abs(n[0])-o,0),s=Math.max(Math.abs(n[1])-a,0),c=n[2];return u*u+s*s+c*c}function E(e,t){return Math.sqrt(H(e,t))}function W(e,t){var n=-e.plane[3];return(0,y.SR)(A(e),t)-n}function A(e){return(0,g.mJ)(e.plane)}function x(e,t){var n=(0,f.f)(b.WM.get(),t,e.origin),r=(0,f.p)(e.basis1),i=(0,f.p)(e.basis2),o=(0,f.d)(e.basis1,n),a=(0,f.d)(e.basis2,n);return-o-r<0&&o-r<0&&-a-i<0&&a-i<0}function F(e,t){var n=L.get();return(0,f.g)(n.origin,e.origin),(0,f.g)(n.vector,t),n}function R(e,t,n){var r=e.basis1,i=e.basis2,o=e.origin,a=(0,f.a)(b.WM.get(),r,t.origin[0]),u=(0,f.a)(b.WM.get(),i,t.origin[1]);(0,f.b)(n.origin,a,u),(0,f.b)(n.origin,n.origin,o);var s=(0,f.a)(b.WM.get(),r,t.direction[0]),c=(0,f.a)(b.WM.get(),i,t.direction[1]);return(0,f.a)(n.vector,(0,f.b)(s,s,c),2),n}function z(e,t){Math.abs((0,f.d)(e.basis1,e.basis2)/((0,f.l)(e.basis1)*(0,f.l)(e.basis2)))>1e-6&&_.warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,f.d)(e.basis1,A(e)))>1e-6&&_.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,f.d)(A(e),e.origin)-e.plane[3])>1e-6&&_.warn(t,"Plane offset is not consistent with plane origin")}function V(e,t,n,r){var i=A(e);(0,g.my)(i,t.direction,t.origin,n),(0,g.my)((0,g.mJ)(n),i,t.origin,r)}var j={plane:(0,g.Ue)(),origin:(0,d.f)(0,0,0),basis1:(0,d.f)(1,0,0),basis2:(0,d.f)(0,1,0)},B=new s.x(g.Ue),L=new s.x(v.Ue),U=(0,d.c)(),J=new s.x((function(){return{origin:null,basis1:null,basis2:null,plane:null}})),D=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Y=(0,l.c)(),X=(0,l.c)();Object.freeze({__proto__:null,BoundedPlaneClass:m,create:w,wrap:function(e,t,n){var r=J.get();return r.origin=e,r.basis1=t,r.basis2=n,r.plane=(0,g.re)(0,0,0,0),M(r),r},copy:k,copyWithoutVerify:function(e,t){(0,f.g)(t.origin,e.origin),(0,f.g)(t.basis1,e.basis1),(0,f.g)(t.basis2,e.basis2),(0,g.JG)(t.plane,e.plane)},fromValues:I,updateUnboundedPlane:M,elevate:Z,setExtent:function(e,t,n){return S(t,n),Z(n,W(e,e.origin),n),n},fromAABoundingRect:S,intersectRay:C,intersectRayClosestSilhouette:function(e,t,n){if(C(e,t,n))return n;var r=P(e,t,b.WM.get());return(0,f.b)(n,t.origin,(0,f.a)(b.WM.get(),t.direction,(0,f.i)(t.origin,r)/(0,f.l)(t.direction))),n},closestPointOnSilhouette:P,closestPoint:O,projectPoint:T,projectPointLocal:N,distance2:H,distance:E,distanceToSilhouette:function(e,t){var n,i=Number.NEGATIVE_INFINITY,o=(0,r.Z)(D);try{for(o.s();!(n=o.n()).done;){var a=R(e,n.value,L.get()),u=(0,v.Jk)(a,t);u>i&&(i=u)}}catch(s){o.e(s)}finally{o.f()}return Math.sqrt(i)},extrusionContainsPoint:function(e,t){return(0,g.Ac)(e.plane,t)&&x(e,t)},axisAt:function(e,t,n,r){return function(e,t,n){switch(t){case h.R.X:(0,f.g)(n,e.basis1),(0,f.n)(n,n);break;case h.R.Y:(0,f.g)(n,e.basis2),(0,f.n)(n,n);break;case h.R.Z:(0,f.g)(n,A(e))}return n}(e,n,r)},altitudeAt:W,setAltitudeAt:function(e,t,n,r){var i=W(e,t),o=(0,f.a)(U,A(e),n-i);return(0,f.b)(r,t,o),r},equals:function(e,t){return(0,f.k)(e.basis1,t.basis1)&&(0,f.k)(e.basis2,t.basis2)&&(0,f.k)(e.origin,t.origin)},transform:function(e,t,n){return e!==n&&k(e,n),(0,c.a)(Y,t),(0,c.t)(Y,Y),(0,f.m)(n.basis1,e.basis1,Y),(0,f.m)(n.basis2,e.basis2,Y),(0,f.m)((0,g.mJ)(n.plane),(0,g.mJ)(e.plane),Y),(0,f.m)(n.origin,e.origin,t),(0,g.T5)(n.plane,n.plane,n.origin),n},rotate:function(e,t,n,r){return e!==r&&k(e,r),(0,c.d)(X,t,n),(0,f.m)(r.basis1,e.basis1,X),(0,f.m)(r.basis2,e.basis2,X),M(r),r},normal:A,UP:j})},11873:function(e,t,n){function r(){return[1,0,0,0,1,0,0,0,1]}function i(e,t){return new Float64Array(e,t,9)}n.d(t,{a:function(){return i},c:function(){return r}});Object.freeze({__proto__:null,create:r,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,n,r,i,o,a,u,s){return[e,t,n,r,i,o,a,u,s]},createView:i})},81949:function(e,t,n){function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function o(e,t,n,r,i,o,a,u,s,c,l,f,d,h,v,g){return[e,t,n,r,i,o,a,u,s,c,l,f,d,h,v,g]}function a(e,t){return new Float64Array(e,t,16)}n.d(t,{I:function(){return u},a:function(){return a},b:function(){return i},c:function(){return r},f:function(){return o}});var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:r,clone:i,fromValues:o,createView:a,IDENTITY:u})},98131:function(e,t,n){function r(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function o(e,t){return new Float64Array(e,t,4)}n.d(t,{I:function(){return a},a:function(){return r},b:function(){return i},c:function(){return o}});var a=[0,0,0,1];Object.freeze({__proto__:null,create:r,clone:i,fromValues:function(e,t,n,r){return[e,t,n,r]},createView:o,IDENTITY:a})},23470:function(e,t,n){n.d(t,{a:function(){return _},b:function(){return y},c:function(){return p},g:function(){return w},i:function(){return M},w:function(){return b}});n(93169);var r=n(32718),i=n(16889),o=n(92026),a=n(14226),u=n(11186),s=n(71353),c=n(90045),l=n(67077),f=n(14320),d=n(40885),h=n(40927),v=n(11185),g=r.Z.getLogger("esri.geometry.support.sphere");function p(){return(0,l.c)()}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p();return(0,c.c)(t,e)}function b(e){return e}function _(e){e[0]=e[1]=e[2]=e[3]=0}function m(e){return Array.isArray(e)?e[3]:e}function w(e){return Array.isArray(e)?e:N}function k(e,t,n){if((0,o.Wi)(t))return!1;var r=t.origin,i=t.direction,a=I;a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2];var u=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],s=2*(i[0]*a[0]+i[1]*a[1]+i[2]*a[2]),c=s*s-4*u*(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]-e[3]*e[3]);if(c<0)return!1;var l=Math.sqrt(c),f=(-s-l)/(2*u),d=(-s+l)/(2*u);return(f<0||d<f&&d>0)&&(f=d),!(f<0)&&(n&&(n[0]=r[0]+i[0]*f,n[1]=r[1]+i[1]*f,n[2]=r[2]+i[2]*f),!0)}var I=(0,s.c)();function M(e,t){return k(e,t,null)}function Z(e,t,n){var r=v.WM.get(),i=v.MP.get();(0,u.c)(r,t.origin,t.direction);var o=m(e);(0,u.c)(n,r,t.origin),(0,u.a)(n,n,1/(0,u.l)(n)*o);var s=C(e,t.origin),c=(0,h.EU)(t.origin,n);return(0,a.d)(i,c+s,r),(0,u.m)(n,n,i),n}function S(e,t,n){var r=(0,u.f)(v.WM.get(),t,w(e)),i=(0,u.a)(v.WM.get(),r,e[3]/(0,u.l)(r));return(0,u.b)(n,i,w(e))}function C(e,t){var n=(0,u.f)(v.WM.get(),t,w(e)),r=(0,u.l)(n),o=m(e),a=o+Math.abs(o-r);return(0,i.ZF)(o/a)}var P=(0,s.c)();function O(e,t,n,r){var o=(0,u.f)(P,t,w(e));switch(n){case f.R.X:var a=(0,i.jE)(o,P)[2];return(0,u.s)(r,-Math.sin(a),Math.cos(a),0);case f.R.Y:var s=(0,i.jE)(o,P),c=s[1],l=s[2],d=Math.sin(c);return(0,u.s)(r,-d*Math.cos(l),-d*Math.sin(l),Math.cos(c));case f.R.Z:return(0,u.n)(r,o);default:return}}function T(e,t){var n=(0,u.f)(H,t,w(e));return(0,u.l)(n)-e[3]}var N=(0,s.c)(),H=(0,s.c)();Object.freeze({__proto__:null,create:p,copy:y,fromCenterAndRadius:function(e,t){return(0,l.f)(e[0],e[1],e[2],t)},wrap:b,clear:_,fromRadius:function(e){return e},getRadius:m,getCenter:w,fromValues:function(e,t,n,r){return(0,l.f)(e,t,n,r)},elevate:function(e,t,n){return e!==n&&(0,u.g)(n,e),n[3]=e[3]+t,n},setExtent:function(e,t,n){return g.error("sphere.setExtent is not yet supported"),e===n?n:y(e,n)},intersectRay:k,intersectsRay:M,intersectRayClosestSilhouette:function(e,t,n){if(k(e,t,n))return n;var r=Z(e,t,v.WM.get());return(0,u.b)(n,t.origin,(0,u.a)(v.WM.get(),t.direction,(0,u.i)(t.origin,r)/(0,u.l)(t.direction))),n},closestPointOnSilhouette:Z,closestPoint:function(e,t,n){return k(e,t,n)?n:((0,d.JI)(t,w(e),n),S(e,n,n))},projectPoint:S,distanceToSilhouette:function(e,t){var n=(0,u.f)(v.WM.get(),t,w(e)),r=(0,u.p)(n),i=e[3]*e[3];return Math.sqrt(Math.abs(r-i))},angleToSilhouette:C,axisAt:O,altitudeAt:T,setAltitudeAt:function(e,t,n,r){var i=T(e,t),o=O(e,t,f.R.Z,H),a=(0,u.a)(H,o,n-i);return(0,u.b)(r,t,a)}})},21530:function(e,t,n){n.d(t,{x:function(){return a}});var r=n(15671),i=n(43144),o=n(70758),a=function(){function e(t){(0,r.Z)(this,e),this.allocator=t,this._items=[],this._itemsPtr=0,this._grow()}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;return 0===this._itemsPtr&&(0,o.Y)((function(){return e._reset()})),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}},{key:"_reset",value:function(){var e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*u);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}},{key:"_grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this._items.length,u));e++)this._items.push(this.allocator())}}]),e}(),u=1024},46798:function(e,t,n){n.d(t,{q:function(){return v}});var r=n(37762),i=n(1413),o=n(15671),a=n(43144),u=n(63780),s=n(42537),c=n(32718),l=n(92026),f=n(66978),d=n(31009),h=c.Z.getLogger("esri.core.workers.WorkerHandle"),v=function(){function e(t,n,a){var u=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,o.Z)(this,e),this._mainMethod=n,this._listeners=[],this._promise=(0,d.bA)(t,(0,i.Z)((0,i.Z)({},s),{},{schedule:a})).then((function(e){if(void 0===u._thread){u._thread=e,u._promise=null,s.hasInitialize&&u.broadcast({},"initialize");var t,n=(0,r.Z)(u._listeners);try{for(n.s();!(t=n.n()).done;){var i=t.value;u._connectListener(i)}}catch(o){n.e(o)}finally{n.f()}}else e.close()})),this._promise.catch((function(e){return h.error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return(0,a.Z)(e,[{key:"on",value:function(e,t){var n=this,r={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(r),this._connectListener(r),(0,s.kB)((function(){r.removed=!0,(0,u.Od)(n._listeners,r),n._thread&&(0,l.pC)(r.threadHandle)&&r.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,n){var r=this;if(this._thread){var i=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:i,signal:n})}return this._promise?this._promise.then((function(){return(0,f.k_)(n),r.invokeMethod(e,t,n)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var n=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return n.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}()},14320:function(e,t,n){var r;n.d(t,{R:function(){return r}}),function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(r||(r={}))},85981:function(e,t,n){n.d(t,{AR:function(){return p},Gr:function(){return g},JG:function(){return c},Jk:function(){return d},KU:function(){return h},Ue:function(){return s},al:function(){return l},ct:function(){return v},zk:function(){return f}});var r=n(16889),i=n(21530),o=n(11186),a=n(71353),u=n(11185);function s(e){return e?{origin:(0,a.a)(e.origin),vector:(0,a.a)(e.vector)}:{origin:(0,a.c)(),vector:(0,a.c)()}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s();return l(e.origin,e.vector,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return(0,o.g)(n.origin,e),(0,o.g)(n.vector,t),n}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return(0,o.g)(n.origin,e),(0,o.f)(n.vector,t,e),n}function d(e,t){var n=(0,o.f)(u.WM.get(),t,e.origin),i=(0,o.d)(e.vector,n),a=(0,o.d)(e.vector,e.vector),s=(0,r.uZ)(i/a,0,1),c=(0,o.f)(u.WM.get(),(0,o.a)(u.WM.get(),e.vector,s),n);return(0,o.d)(c,c)}function h(e,t,n){return(0,o.b)(n,e.origin,(0,o.a)(n,e.vector,t))}function v(e,t,n,i,a){var s=e.vector,c=e.origin,l=(0,o.f)(u.WM.get(),t,c),f=(0,o.d)(s,l)/(0,o.p)(s);return(0,o.a)(a,s,(0,r.uZ)(f,n,i)),(0,o.b)(a,a,e.origin)}function g(e,t){if(y(e,function(e,t){var n=_.get();return n.origin=e,n.vector=t,n}(t.origin,t.direction),!1,b)){var n=b.tA,r=b.pB,i=b.distance2;if(n>=0&&n<=1)return i;if(n<0)return(0,o.h)(e.origin,r);if(n>1)return(0,o.h)((0,o.b)(u.WM.get(),e.origin,e.vector),r)}return null}function p(e,t,n){return!!y(e,t,!0,b)&&((0,o.g)(n,b.pA),!0)}function y(e,t,n,i){var a=1e-6,s=e.origin,c=(0,o.b)(u.WM.get(),s,e.vector),l=t.origin,f=(0,o.b)(u.WM.get(),l,t.vector),d=u.WM.get(),h=u.WM.get();if(d[0]=s[0]-l[0],d[1]=s[1]-l[1],d[2]=s[2]-l[2],h[0]=f[0]-l[0],h[1]=f[1]-l[1],h[2]=f[2]-l[2],Math.abs(h[0])<a&&Math.abs(h[1])<a&&Math.abs(h[2])<a)return!1;var v=u.WM.get();if(v[0]=c[0]-s[0],v[1]=c[1]-s[1],v[2]=c[2]-s[2],Math.abs(v[0])<a&&Math.abs(v[1])<a&&Math.abs(v[2])<a)return!1;var g=d[0]*h[0]+d[1]*h[1]+d[2]*h[2],p=h[0]*v[0]+h[1]*v[1]+h[2]*v[2],y=d[0]*v[0]+d[1]*v[1]+d[2]*v[2],b=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],_=(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])*b-p*p;if(Math.abs(_)<a)return!1;var m=(g*p-y*b)/_,w=(g+p*m)/b;n&&(m=(0,r.uZ)(m,0,1),w=(0,r.uZ)(w,0,1));var k=u.WM.get(),I=u.WM.get();return k[0]=s[0]+m*v[0],k[1]=s[1]+m*v[1],k[2]=s[2]+m*v[2],I[0]=l[0]+w*h[0],I[1]=l[1]+w*h[1],I[2]=l[2]+w*h[2],i.tA=m,i.tB=w,i.pA=k,i.pB=I,i.distance2=(0,o.h)(k,I),!0}var b={tA:0,tB:0,pA:(0,a.c)(),pB:(0,a.c)(),distance2:0},_=new i.x((function(){return{origin:null,vector:null}}))},55652:function(e,t,n){n.d(t,{$I:function(){return v},Ac:function(){return P},BR:function(){return Z},Er:function(){return O},JG:function(){return l},T5:function(){return w},Ue:function(){return s},Yq:function(){return d},al:function(){return f},dZ:function(){return C},fn:function(){return M},jH:function(){return N},mJ:function(){return E},my:function(){return I},nF:function(){return T},re:function(){return c},rx:function(){return S},tk:function(){return k},zk:function(){return h}});var r=n(16889),i=n(92026),o=n(11186),a=n(71353),u=(n(23470),n(11185));function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;return[e[0],e[1],e[2],e[3]]}function c(e,t,n,r){return f(e,t,n,r,u.o6.get())}function l(e,t){return f(t[0],t[1],t[2],t[3],e)}function f(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s();return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function d(e,t,n){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s(),i=n[0]-t[0],o=n[1]-t[1],a=n[2]-t[2],u=e[0]-t[0],c=e[1]-t[1],l=e[2]-t[2],f=o*l-a*c,d=a*u-i*l,h=i*c-o*u,v=f*f+d*d+h*h,g=Math.abs(v-1)>1e-5&&v>1e-12?1/Math.sqrt(v):1;r[0]=f*g,r[1]=d*g,r[2]=h*g,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2])}function v(e,t,n,r,i){if(e.count<3)return!1;e.getVec(n,p);for(var a=r,u=!1;a<e.count-1&&!u;)e.getVec(a,y),a++,u=!(0,o.k)(p,y);if(!u)return!1;for(a=Math.max(a,i),u=!1;a<e.count&&!u;)e.getVec(a,b),a++,(0,o.f)(_,p,y),(0,o.n)(_,_),(0,o.f)(m,y,b),(0,o.n)(m,m),u=!(0,o.k)(p,b)&&!(0,o.k)(y,b)&&Math.abs((0,o.d)(_,m))<g;return u?(h(p,y,b,t),!0):(0!==n||1!==r||2!==i)&&v(e,t,0,1,2)}var g=.99619469809,p=(0,a.c)(),y=(0,a.c)(),b=(0,a.c)(),_=(0,a.c)(),m=(0,a.c)();function w(e,t,n){return t!==e&&l(e,t),e[3]=-(0,o.d)(e,n),e}function k(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function I(e,t,n,r){return(0,o.c)(b,t,e),d(n,b,r)}function M(e,t,n,r){return H(e,t,(0,o.f)(u.WM.get(),n,t),F,r)}function Z(e,t,n){return!!(0,i.pC)(t)&&H(e,t.origin,t.direction,R,n)}function S(e,t,n){return H(e,t.origin,t.vector,W.NONE,n)}function C(e,t,n){return H(e,t.origin,t.vector,W.CLAMP,n)}function P(e,t){return N(e,t)>=0}function O(e,t){var n=(0,o.d)(e,t.ray.direction),r=-N(e,t.ray.origin);if(n>-1e-6&&n<1e-6)return r>0;var i=r/n;return n>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function T(e,t,n){var r=(0,o.a)(u.WM.get(),e,-e[3]),i=function(e,t,n){var r=(0,o.a)(u.WM.get(),e,(0,o.d)(e,t));return(0,o.f)(n,t,r),n}(e,(0,o.f)(u.WM.get(),t,r),u.WM.get());return(0,o.b)(n,i,r),n}function N(e,t){return(0,o.d)(e,t)+e[3]}function H(e,t,n,i,a){var u=(0,o.d)(e,n);if(0===u)return!1;var s=-((0,o.d)(e,t)+e[3])/u;return i&W.CLAMP&&(s=(0,r.uZ)(s,0,1)),!(!(i&W.INFINITE_MIN)&&s<0||!(i&W.INFINITE_MAX)&&s>1)&&((0,o.b)(a,t,(0,o.a)(a,n,s)),!0)}function E(e){return e}var W,A,x=[0,0,1,0];(A=W||(W={}))[A.NONE=0]="NONE",A[A.CLAMP=1]="CLAMP",A[A.INFINITE_MIN=4]="INFINITE_MIN",A[A.INFINITE_MAX=8]="INFINITE_MAX";var F=W.INFINITE_MIN|W.INFINITE_MAX,R=W.INFINITE_MAX},40885:function(e,t,n){n.d(t,{JG:function(){return c},JI:function(){return h},Jk:function(){return d},Ue:function(){return u},re:function(){return s},zk:function(){return l}});n(63780);var r=n(21530),i=n(11186),o=n(71353),a=n(11185);function u(e){return e?{origin:(0,o.a)(e.origin),direction:(0,o.a)(e.direction)}:{origin:(0,o.c)(),direction:(0,o.c)()}}function s(e,t){var n=v.get();return n.origin=e,n.direction=t,n}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u();return f(e.origin,e.direction,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u();return(0,i.g)(n.origin,e),(0,i.f)(n.direction,t,e),n}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u();return(0,i.g)(n.origin,e),(0,i.g)(n.direction,t),n}function d(e,t){var n=(0,i.c)(a.WM.get(),(0,i.n)(a.WM.get(),e.direction),(0,i.f)(a.WM.get(),t,e.origin));return(0,i.d)(n,n)}function h(e,t,n){var r=(0,i.d)(e.direction,(0,i.f)(n,t,e.origin));return(0,i.b)(n,e.origin,(0,i.a)(n,e.direction,r)),n}var v=new r.x((function(){return{origin:null,direction:null}}))},40927:function(e,t,n){n.d(t,{EU:function(){return s},SR:function(){return u},cp:function(){return c},nF:function(){return a}});var r=n(16889),i=n(11186),o=n(71353);function a(e,t,n){var r=(0,i.d)(e,t)/(0,i.d)(e,e);return(0,i.a)(n,e,r)}function u(e,t){return(0,i.d)(e,t)/(0,i.l)(e)}function s(e,t){var n=(0,i.d)(e,t)/((0,i.l)(e)*(0,i.l)(t));return-(0,r.ZF)(n)}function c(e,t,n){(0,i.n)(l,e),(0,i.n)(f,t);var o=(0,i.d)(l,f),a=(0,r.ZF)(o),u=(0,i.c)(l,l,f);return(0,i.d)(u,n)<0?2*Math.PI-a:a}var l=(0,o.c)(),f=(0,o.c)()},11185:function(e,t,n){n.d(t,{MP:function(){return b},vD:function(){return _},qW:function(){return g},WM:function(){return p},o6:function(){return y}});var r=n(15671),i=n(43144),o=n(59896),a=n(70758),u=n(11873),s=n(81949),c=n(98131),l=n(6394),f=n(71353),d=n(67077),h=function(){function e(t,n,i){(0,r.Z)(this,e),this.itemByteSize=t,this.itemCreate=n,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(i/this.itemByteSize)}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;0===this._itemsPtr&&(0,a.Y)((function(){return e._reset()}));for(var t=Math.floor(this._itemsPtr/this._itemsPerBuffer);this._buffers.length<=t;){for(var n=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize),r=0;r<this._itemsPerBuffer;++r)this._items.push(this.itemCreate(n,r*this.itemByteSize));this._buffers.push(n)}return this._items[this._itemsPtr++]}},{key:"_reset",value:function(){for(var e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}},{key:"test",get:function(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(16,l.c,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(24,f.b,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(32,d.a,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(72,u.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(128,s.a,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(32,c.c,t)}}]),e}(),v=4*o.Y8.KILOBYTES,g=h.createVec2f64(),p=h.createVec3f64(),y=h.createVec4f64(),b=(h.createMat3f64(),h.createMat4f64()),_=h.createQuatf64()},84134:function(e,t,n){n.r(t),n.d(t,{FeatureServiceSnappingSource:function(){return ie}});var r=n(74165),i=n(1413),o=n(15861),a=n(15671),u=n(43144),s=n(60136),c=n(54062),l=n(27366),f=n(85015),d=n(41691),h=n(42537),v=n(92026),g=n(94172),p=n(49861),y=(n(63780),n(93169),n(25243),n(69912)),b=n(37762),_=n(11186),m=n(67077),w=n(82218);function k(e,t){return(0,w.h)(t.extent,I),(0,w.g)(I,(0,_.s)(M,e.x,e.y,0))}var I=(0,w.c)(),M=(0,m.c)(),Z=n(69787),S=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).pointOfInterest=null,r}return(0,u.Z)(n,[{key:"tiles",get:function(){var e=this.tilesCoveringView,t=(0,v.pC)(this.pointOfInterest)?this.pointOfInterest:this.view.center;return e.sort((function(e,n){return k(t,e)-k(t,n)})),e}},{key:"_scaleEnabled",value:function(){return(0,Z.rs)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}},{key:"tilesCoveringView",get:function(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||(0,v.Wi)(this.tileInfo))return[];if(!this._scaleEnabled)return[];var e,t=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),n=t.spans,r=t.lodInfo,i=r.level,o=[],a=(0,b.Z)(n);try{for(a.s();!(e=a.n()).done;)for(var u=e.value,s=u.row,c=u.colFrom,l=u.colTo,f=c;f<=l;f++){var d={id:null,level:i,row:s,col:r.normalizeCol(f)};this.tileInfo.updateTileInfo(d),o.push(d)}}catch(h){a.e(h)}finally{a.f()}return o}},{key:"tileInfo",get:function(){var e,t;return null!=(e=null==(t=this.view.featuresTilingScheme)?void 0:t.tileInfo)?e:null}},{key:"tileSize",get:function(){return(0,v.pC)(this.tileInfo)?this.tileInfo.size[0]:256}},{key:"initialize",value:function(){var e=this;this.handles.add(this.watch("view.state.viewpoint",(function(){return e.notifyChange("tilesCoveringView")}),!0))}}]),n}((0,d.p)(f.Z));(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tiles",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"_scaleEnabled",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tilesCoveringView",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tileInfo",null),(0,l._)([(0,p.Cb)({readOnly:!0})],S.prototype,"tileSize",null),(0,l._)([(0,p.Cb)({constructOnly:!0})],S.prototype,"view",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],S.prototype,"layer",void 0),(0,l._)([(0,p.Cb)()],S.prototype,"pointOfInterest",void 0),S=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],S);var C,P=n(29439),O=n(8537),T=n(65156);!function(e){e[e.INVISIBLE=0]="INVISIBLE",e[e.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",e[e.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"}(C||(C={}));var N=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).pointOfInterest=null,r}return(0,u.Z)(n,[{key:"tiles",get:function(){var e=this.tilesCoveringView,t=this.effectivePointOfInterest;if((0,v.pC)(t))for(var n=e.map((function(e){return k(t,e)})),r=1;r<n.length;r++)if(n[r-1]>n[r])return e.sort((function(e,n){return k(t,e)-k(t,n)})),e.slice();return e}},{key:"tilesCoveringView",get:function(){var e,t;return this._filterTiles(null==(e=this.view.featureTiles)||null==(t=e.tiles)?void 0:t.toArray()).map(H)}},{key:"tileInfo",get:function(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tilingScheme.toTileInfo())?e:null}},{key:"tileSize",get:function(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tileSize)?e:256}},{key:"effectivePointOfInterest",get:function(){var e,t=this.pointOfInterest;return(0,v.pC)(t)?t:null==(e=this.view.pointsOfInterest)?void 0:e.focus.location}},{key:"initialize",value:function(){var e=this;this.handles.add((0,O.S1)(this.view,"featureTiles",(function(t){e.handles.remove(W),t&&e.handles.add(t.addClient(),W)})))}},{key:"_filterTiles",value:function(e){return(0,v.Wi)(e)?[]:e.filter((function(e){return Math.abs(e.measures.screenRect[3]-e.measures.screenRect[1])>E&&e.measures.visibility===C.VISIBLE_ON_SURFACE}))}}]),n}(d.r);function H(e){var t=(0,P.Z)(e.lij,3),n=t[0],r=t[1],i=t[2],o=e.extent;return{id:"".concat(n,"/").concat(r,"/").concat(i),level:n,row:r,col:i,extent:o}}(0,l._)([(0,p.Cb)({readOnly:!0})],N.prototype,"tiles",null),(0,l._)([(0,p.Cb)({readOnly:!0})],N.prototype,"tilesCoveringView",null),(0,l._)([(0,p.Cb)({readOnly:!0})],N.prototype,"tileInfo",null),(0,l._)([(0,p.Cb)({readOnly:!0})],N.prototype,"tileSize",null),(0,l._)([(0,p.Cb)({constructOnly:!0})],N.prototype,"view",void 0),(0,l._)([(0,p.Cb)()],N.prototype,"pointOfInterest",void 0),(0,l._)([(0,p.Cb)()],N.prototype,"effectivePointOfInterest",null),N=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],N);var E=50,W="feature-tiles",A=n(69117),x=n(100),F=n(80885),R=n(51995),z=n(52639),V=n(16889),j=n(62554),B=n(61459),L=n(58009),U=n(87037),J=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]],D=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).updating=!1,r.enablePolygons=!0,r.enableLabels=!0,r._polygons=new Map,r._labels=new Map,r._enabled=!0,r}return(0,u.Z)(n,[{key:"initialize",value:function(){this._symbols=J.map((function(e){return new B.Z({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}})})),this.update()}},{key:"destroy",value:function(){this._enabled=!1,this.clear()}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this.update())}},{key:"update",value:function(){var e=this;if(this._enabled){var t=this.getTiles(),n=new Array,r=new Set((this._labels.size,this._labels.keys()));t.forEach((function(i,o){var a=i.lij.toString();r.delete(a);var u=i.lij[0],s=i.geometry;if(e.enablePolygons&&!e._polygons.has(a)){var c=new z.Z({geometry:s,symbol:e._symbols[u%e._symbols.length]});e._polygons.set(a,c),n.push(c)}if(e.enableLabels){var l=function(e){if((0,v.pC)(e.label))return e.label;var t=e.lij.toString();return(0,v.pC)(e.loadPriority)&&(t+=" (".concat(e.loadPriority,")")),t}(i),f=o/(t.length-1),d=(0,V.t7)(0,200,f),h=(0,V.t7)(20,6,f)/.75,g=(0,v.pC)(i.loadPriority)&&i.loadPriority>=t.length,p=new R.Z([d,g?0:d,g?0:d]),y="3d"===e.view.type?function(){return new j.Z({verticalOffset:{screenLength:40/.75},callout:{type:"line",color:"white",border:{color:"black"}},symbolLayers:[new U.Z({text:l,halo:{color:"white",size:1/.75},material:{color:p},size:h})]})}:function(){return new L.Z({text:l,haloColor:"white",haloSize:1/.75,color:p,size:h})};if(e._labels.has(a)){var b=e._labels.get(a),_=y();((0,v.Wi)(b.symbol)||JSON.stringify(_)!==JSON.stringify(b.symbol))&&(b.symbol=_)}else{var m=new z.Z({geometry:s.extent.center,symbol:y()});e._labels.set(a,m),n.push(m)}}}));var i=new Array;r.forEach((function(t){e._polygons.has(t)&&(i.push(e._polygons.get(t)),e._polygons.delete(t)),e._labels.has(t)&&(i.push(e._labels.get(t)),e._labels.delete(t))})),this.view.graphics.removeMany(i),this.view.graphics.addMany(n)}else this.clear()}},{key:"clear",value:function(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}}]),n}(f.Z);(0,l._)([(0,p.Cb)({constructOnly:!0})],D.prototype,"view",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],D.prototype,"updating",void 0),(0,l._)([(0,p.Cb)()],D.prototype,"enabled",null);var Y=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).handles=new x.Z,r}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this,t=setInterval((function(){return e._fetchDebugInfo()}),2e3);this.handles.add((0,h.kB)((function(){return clearInterval(t)})))}},{key:"destroy",value:function(){this.handles.destroy()}},{key:"getTiles",value:function(){var e=this;if(!this.debugInfo)return[];var t=new Map,n=new Map;this.debugInfo.storedTiles.forEach((function(e){t.set(e.data.id,e.featureCount)})),this.debugInfo.pendingTiles.forEach((function(e){t.set(e.data.id,e.featureCount),n.set(e.data.id,e.state)}));var r=function(e){var r,i=n.get(e),o=null!=(r=t.get(e))?r:"?";return i?"".concat(i,":").concat(o,"\n").concat(e):"store:".concat(o,"\n").concat(e)},i=new Map;return this.debugInfo.storedTiles.forEach((function(e){i.set(e.data.id,e.data)})),this.debugInfo.pendingTiles.forEach((function(e){i.set(e.data.id,e.data)})),Array.from(i.values()).map((function(t){return{lij:[t.level,t.row,t.col],geometry:F.Z.fromExtent((0,T.HH)(t.extent,e.view.spatialReference)),label:r(t.id)}}))}},{key:"_fetchDebugInfo",value:function(){var e=this;this.handle.getDebugInfo(null).then((function(t){e.debugInfo=t,e.update()}))}}]),n}(D=(0,l._)([(0,y.j)("esri.views.support.TileTreeDebugger")],D));(0,l._)([(0,p.Cb)({constructOnly:!0})],Y.prototype,"handle",void 0),Y=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],Y);var X=n(66978),q=n(46798),G=n(27823),Q=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).availability=0,r.workerHandleUpdating=!0,r.editId=0,r}return(0,u.Z)(n,[{key:"updating",get:function(){return this.updatingHandles.updating||this.workerHandleUpdating}},{key:"destroy",value:function(){this.workerHandle.destroy()}},{key:"initialize",value:function(){var e=this;this.workerHandle=new K(this.schedule),this.handles.add([this.workerHandle.on("notify-updating",(function(t){var n=t.updating;return e.workerHandleUpdating=n})),this.workerHandle.on("notify-availability",(function(t){var n=t.availability;return e._set("availability",n)}))])}},{key:"setup",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._serviceInfoFromLayer(t.layer),!(0,v.Wi)(i)){e.next=3;break}return e.abrupt("return");case 3:return o={configuration:this._convertConfiguration(t.configuration),serviceInfo:i,spatialReference:t.spatialReference.toJSON()},e.next=6,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("setup",o,n));case 6:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._convertConfiguration(t),e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("configure",i,n));case 3:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("refresh",{},t));case 2:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={distance:t.distance,point:t.coordinateHelper.vectorToPoint(t.point).toJSON(),types:t.types,filter:(0,v.pC)(t.filter)?t.filter.createQuery().toJSON():null},e.abrupt("return",this.workerHandle.invoke(i,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTiles",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={tiles:t.tiles,tileInfo:(0,v.pC)(t.tileInfo)?t.tileInfo.toJSON():null,tileSize:t.tileSize},e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("updateTiles",i,n));case 3:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o,a,u,s,c,l,f,d,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.editId++,f={id:l},e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("beginApplyEdits",f,n));case 3:return this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n)),e.next=6,this.updatingHandles.addPromise((0,X.Hl)(t.result,n));case 6:return d=e.sent,h={id:l,edits:{addedFeatures:null!=(i=null==(o=d.addedFeatures)?void 0:o.map((function(e){return e.objectId})))?i:[],deletedFeatures:null!=(a=null==(u=d.deletedFeatures)?void 0:u.map((function(e){return{objectId:e.objectId,globalId:e.globalId}})))?a:[],updatedFeatures:null!=(s=null==(c=d.updatedFeatures)?void 0:c.map((function(e){return e.objectId})))?s:[]}},e.next=10,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("endApplyEdits",h,n));case 10:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(e){return this.workerHandle.invokeMethod("getDebugInfo",{},e)}},{key:"_convertConfiguration",value:function(e){return{filter:(0,v.pC)(e.filter)?e.filter.toJSON():null,customParameters:e.customParameters}}},{key:"_serviceInfoFromLayer",value:function(e){var t;return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl.path,fields:e.fields.map((function(e){return e.toJSON()})),geometryType:G.Mk.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:null==(t=e.timeInfo)?void 0:t.toJSON()}}}]),n}(d.r);(0,l._)([(0,p.Cb)({constructOnly:!0})],Q.prototype,"schedule",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],Q.prototype,"updating",null),(0,l._)([(0,p.Cb)({readOnly:!0})],Q.prototype,"availability",void 0),(0,l._)([(0,p.Cb)()],Q.prototype,"workerHandleUpdating",void 0),Q=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],Q);var K=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){return(0,a.Z)(this,n),t.call(this,"FeatureServiceSnappingSourceWorker","fetchCandidates",e,{strategy:"dedicated"})}return(0,u.Z)(n,[{key:"getTransferList",value:function(){return[]}}]),n}(q.q),$=n(7882),ee=n(59068),te=n(22824),ne=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).pointOfInterest=null,r}return(0,u.Z)(n,[{key:"tiles",get:function(){return[{id:"0/0/0",level:0,row:0,col:0,extent:(0,T.al)(-1e8,-1e8,1e8,1e8)}]}},{key:"tileInfo",get:function(){return new te.Z({origin:new $.Z({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new ee.Z({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}},{key:"tileSize",get:function(){return this.tileInfo.size[0]}}]),n}(f.Z);(0,l._)([(0,p.Cb)({readOnly:!0})],ne.prototype,"tiles",null),(0,l._)([(0,p.Cb)({readOnly:!0})],ne.prototype,"tileInfo",null),(0,l._)([(0,p.Cb)({readOnly:!0})],ne.prototype,"tileSize",null),(0,l._)([(0,p.Cb)({constructOnly:!0})],ne.prototype,"layer",void 0),(0,l._)([(0,p.Cb)()],ne.prototype,"pointOfInterest",void 0),ne=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],ne);var re=n(32609),ie=function(e){(0,s.Z)(n,e);var t=(0,c.Z)(n);function n(e){return(0,a.Z)(this,n),t.call(this,e)}return(0,u.Z)(n,[{key:"updateTilesParameters",get:function(){return{tiles:this.tilesOfInterest.tiles,tileInfo:this.tilesOfInterest.tileInfo,tileSize:this.tilesOfInterest.tileSize}}},{key:"updating",get:function(){return this.workerHandle.updating||this.updatingHandles.updating}},{key:"configuration",get:function(){return{filter:this.layer.createQuery(),customParameters:this.layer.customParameters}}},{key:"availability",get:function(){return this.workerHandle.availability}},{key:"layer",get:function(){return this.layerSource.layer}},{key:"initialize",value:function(){var e=this,t=this.view;if((0,v.pC)(t))switch(t.type){case"2d":this.tilesOfInterest=new S({view:t,layer:this.layer}),this.workerHandle=new Q;break;case"3d":var n=t.resourceController;this.tilesOfInterest=new N({view:t}),this.workerHandle=new Q({schedule:function(e){return n.schedule(e)}})}else this.tilesOfInterest=new ne({layer:this.layer}),this.workerHandle=new Q;this.handles.add([(0,h.ed)(this.workerHandle)]),this.workerHandle.setup({layer:this.layer,spatialReference:this.spatialReference,configuration:this.configuration},null),this.updatingHandles.add((function(){return e.updateTilesParameters}),(function(){return e.workerHandle.updateTiles(e.updateTilesParameters,null)}),g.nn),this.handles.add([(0,g.YP)((function(){return e.configuration}),(function(t){return e.workerHandle.configure(t,null)}),g.Z_)]),(0,v.pC)(t)&&this.handles.add((0,g.YP)((function(){return re.Z.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES}),(function(n){n&&!e.debug?(e.debug=new Y({view:t,handle:e.workerHandle}),e.handles.add((0,h.ed)(e.debug),"debug")):!n&&e.debug&&e.handles.remove("debug")}),g.nn)),this.handles.add(this.layerSource.layer.on("apply-edits",(function(t){e.workerHandle.applyEdits(t,null)})))}},{key:"refresh",value:function(){this.workerHandle.refresh(null)}},{key:"fetchCandidates",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tilesOfInterest.pointOfInterest=t.coordinateHelper.vectorToPoint(t.point),e.next=3,this.workerHandle.fetchCandidates((0,i.Z)((0,i.Z)({},t),{},{filter:null}),n);case 3:return e.abrupt("return",e.sent.candidates.map((function(e){return(0,A.X)(e,t.coordinateHelper)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(e){return this.workerHandle.getDebugInfo(e)}}]),n}((0,d.p)(f.Z));(0,l._)([(0,p.Cb)({constructOnly:!0})],ie.prototype,"spatialReference",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],ie.prototype,"layerSource",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],ie.prototype,"view",void 0),(0,l._)([(0,p.Cb)()],ie.prototype,"tilesOfInterest",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],ie.prototype,"updateTilesParameters",null),(0,l._)([(0,p.Cb)({readOnly:!0})],ie.prototype,"updating",null),(0,l._)([(0,p.Cb)({readOnly:!0})],ie.prototype,"configuration",null),(0,l._)([(0,p.Cb)({readOnly:!0})],ie.prototype,"availability",null),ie=(0,l._)([(0,y.j)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],ie)},69117:function(e,t,n){n.d(t,{X:function(){return h}});var r=n(95905),i=n(1413),o=n(15671),a=n(43144),u=n(60136),s=n(54062),c=n(95122),l=n(75691),f=n(61309),d=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,(0,i.Z)((0,i.Z)({},e),{},{constraint:new c.Hk(e.coordinateHelper,e.targetPoint)}))}return(0,a.Z)(n,[{key:"hints",get:function(){return[new f.n(this.targetPoint)]}}]),n}(l.a);function h(e,t){switch(e.type){case"edge":return new r.L({coordinateHelper:t,edgeStart:t.pointToVector(e.start),edgeEnd:t.pointToVector(e.end),targetPoint:t.pointToVector(e.target),objectId:e.objectId});case"vertex":return new d({coordinateHelper:t,targetPoint:t.pointToVector(e.target),objectId:e.objectId})}}},61309:function(e,t,n){n.d(t,{n:function(){return s}});var r=n(15671),i=n(43144),o=n(60136),a=n(54062),u=n(64674),s=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this)).point=e,i}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,u.Xv)(this.point,e.point)}}]),n}(n(55054).r)}}]);
//# sourceMappingURL=4134.91da1699.chunk.js.map